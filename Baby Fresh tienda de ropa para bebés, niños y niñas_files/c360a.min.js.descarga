// Bundle time - 2025-05-12T17:09:39Z - SalesforceInteractions
// SDK - npm/@salesforce/interactions/2.0/target/dist/scripts/interactions-bundle.min.js
/*
 regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE  js-cookie v3.0.5 | MIT */
'use strict';var SalesforceInteractions=function(e){function ma(b,a){(null==a||a>b.length)&&(a=b.length);for(var c=0,d=Array(a);c<a;c++)d[c]=b[c];return d}function lc(b,a,c){a=K(a);a=ab()?Reflect.construct(a,c||[],K(b).constructor):a.apply(b,c);if(!a||"object"!=typeof a&&"function"!=typeof a){if(void 0!==a)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}else b=a;return b}
function L(b,a){if(!(b instanceof a))throw new TypeError("Cannot call a class as a function");}function bb(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,cb(d.key),d)}}function M(b,a,c){return a&&bb(b.prototype,a),c&&bb(b,c),Object.defineProperty(b,"prototype",{writable:!1}),b}function na(b,a){var c="undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(!c){if(Array.isArray(b)||(c=oa(b))||
a&&b&&"number"==typeof b.length){c&&(b=c);var d=0;a=function(){};return{s:a,n:function(){return d>=b.length?{done:!0}:{done:!1,value:b[d++]}},e:function(a){throw a;},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var f,h=!0,l=!1;return{s:function(){c=c.call(b)},n:function(){var a=c.next();return h=a.done,a},e:function(a){l=!0;f=a},f:function(){try{h||null==c.return||c.return()}finally{if(l)throw f;
}}}}function X(b,a,c){return(a=cb(a))in b?Object.defineProperty(b,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):b[a]=c,b}function pa(){return pa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(b,a,c){var d;for(d=b;!{}.hasOwnProperty.call(d,a)&&null!==(d=K(d)););if(d)return d=Object.getOwnPropertyDescriptor(d,a),d.get?d.get.call(3>arguments.length?b:c):d.value},pa.apply(null,arguments)}function K(b){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||
Object.getPrototypeOf(a)},K(b)}function mc(b,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}});Object.defineProperty(b,"prototype",{writable:!1});a&&qa(b,a)}function ab(){try{var b=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(ab=function(){return!!b})()}function db(b,a){var c=Object.keys(b);if(Object.getOwnPropertySymbols){var d=
Object.getOwnPropertySymbols(b);a&&(d=d.filter(function(a){return Object.getOwnPropertyDescriptor(b,a).enumerable}));c.push.apply(c,d)}return c}function q(b){for(var a=1;a<arguments.length;a++){var c=null!=arguments[a]?arguments[a]:{};a%2?db(Object(c),!0).forEach(function(a){X(b,a,c[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(b,Object.getOwnPropertyDescriptors(c)):db(Object(c)).forEach(function(a){Object.defineProperty(b,a,Object.getOwnPropertyDescriptor(c,a))})}return b}function qa(b,
a){return qa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a},qa(b,a)}function Y(b,a){var c=Array.isArray(b)?b:void 0;if(!c)a:{var d=null==b?null:"undefined"!=typeof Symbol&&b[Symbol.iterator]||b["@@iterator"];if(null!=d){var f,h,l,e=[],p=!0,g=!1;try{if(h=(d=d.call(b)).next,0===a){if(Object(d)!==d){c=void 0;break a}p=!1}else for(;!(p=(f=h.call(d)).done)&&(e.push(f.value),e.length!==a);p=!0);}catch(nc){g=!0;var k=nc}finally{try{if(!p&&null!=d.return&&(l=d.return(),
Object(l)!==l)){c=void 0;break a}}finally{if(g)throw k;}}c=e}else c=void 0}if(!(b=c||oa(b,a)))throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return b}function fb(b,a,c,d){var f=pa(K(1&d?b.prototype:b),a,c);return 2&d?function(a){return f.apply(c,a)}:f}function gb(b){var a=Array.isArray(b)?ma(b):void 0;a||(a="undefined"!=typeof Symbol&&null!=b[Symbol.iterator]||null!=b["@@iterator"]?Array.from(b):
void 0);if(!(b=a||oa(b)))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return b}function cb(b){a:if("object"==typeof b&&b){var a=b[Symbol.toPrimitive];if(void 0!==a){b=a.call(b,"string");if("object"!=typeof b)break a;throw new TypeError("@@toPrimitive must return a primitive value.");}b=String(b)}return"symbol"==typeof b?b:b+""}function x(b){"@babel/helpers - typeof";return x="function"==
typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},x(b)}function oa(b,a){if(b){if("string"==typeof b)return ma(b,a);var c={}.toString.call(b).slice(8,-1);return"Object"===c&&b.constructor&&(c=b.constructor.name),"Map"===c||"Set"===c?Array.from(b):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?ma(b,a):void 0}}function hb(b){r.setLoggingLevel(b)}
function ib(){return r.getLoggingLevel()}function ra(b){var a,c,d,f=[],h=[c=1732584193,d=4023233417,~c,~d,3285377520],l=[],e=unescape(encodeURI(b))+"\u0080",p=e.length;for(l[b=--p/4+2|15]=8*p;~p;)l[p>>2]|=e.charCodeAt(p)<<8*~p--;for(a=p=0;a<b;a+=16){for(c=h;80>p;c=[c[4]+(f[p]=16>p?~~l[a+p]:2*e|0>e)+1518500249+[d&g|~d&k,e=341275144+(d^g^k),882459459+(d&g|d&k|g&k),e+1535694389][p++/5>>2]+((e=c[0])<<5|e>>>27),e,d<<30|d>>>2,g,k]){e=f[p-3]^f[p-8]^f[p-14]^f[p-16];d=c[1];var g=c[2];var k=c[3]}for(p=5;p;)h[--p]+=
c[p]}for(e="";40>p;)e+=(h[p>>3]>>4*(7-p++)&15).toString(16);return e}function Z(b){for(var a=1;a<arguments.length;a++){var c=arguments[a],d;for(d in c)b[d]=c[d]}return b}function sa(b,a){function c(c,f,h){if("undefined"!==typeof document){h=Z({},a,h);"number"===typeof h.expires&&(h.expires=new Date(Date.now()+864E5*h.expires));h.expires&&(h.expires=h.expires.toUTCString());c=encodeURIComponent(c).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var d="",e;for(e in h)h[e]&&
(d+="; "+e,!0!==h[e]&&(d+="="+h[e].split(";")[0]));return document.cookie=c+"="+b.write(f,c)+d}}return Object.create({set:c,get:function(a){if("undefined"!==typeof document&&(!arguments.length||a)){for(var c=document.cookie?document.cookie.split("; "):[],d={},l=0;l<c.length;l++){var e=c[l].split("="),g=e.slice(1).join("=");try{var k=decodeURIComponent(e[0]);d[k]=b.read(g,k);if(a===k)break}catch(eb){}}return a?d[a]:d}},remove:function(a,b){c(a,"",Z({},b,{expires:-1}))},withAttributes:function(a){return sa(this.converter,
Z({},this.attributes,a))},withConverter:function(a){return sa(Z({},this.converter,a),this.attributes)}},{attributes:{value:Object.freeze(a)},converter:{value:Object.freeze(b)}})}function jb(){var b=(window.navigator.userAgent||"")+(window.navigator.platform||"")+(new Date).getTime+JSON.stringify({})+Math.random();return aa(b).slice(0,16)}function ta(b){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:z;return a&&9===a.nodeType||a&&1===a.nodeType?oc.test(b)?a.getElementsByClassName(b.slice(1)):
pc.test(b)?a.getElementsByTagName(b):a.querySelectorAll(b):[]}function S(b){return b.replace(qc,function(a,b){return b.toUpperCase()})}function t(b,a,c){if(c)for(c=b.length;c--&&!1!==a.call(b[c],c,b[c]););else{c=0;for(var d=b.length;c<d&&!1!==a.call(b[c],c,b[c]);c++);}return b}function ua(b,a){var c=b&&(b.matches||b.webkitMatchesSelector||b.msMatchesSelector);return!!c&&c.call(b,a)}function va(b){return!!b&&b===b.window}function H(b){return"function"===typeof b}function u(b){return"string"===typeof b}
function kb(b){return!isNaN(parseFloat(b))&&isFinite(b)}function wa(b){return u(b)?function(a,c){return ua(c,b)}:H(b)?b:b instanceof ba?function(a,c){return b.is(c)}:b?function(a,c){return c===b}:function(){return!1}}function N(b,a){return a?b.filter(a):b}function ca(b){return u(b)?b.match(rc)||[]:[]}function B(b,a,c){for(var d=[],f=H(a),h=0,l=b.length;h<l;h++)if(f){var e=a(b[h]);e.length&&sc.apply(d,e)}else for(e=b[h][a];null!=e;)d.push(e),e=c?e[a]:null;return d}function A(b){return 1<b.length?xa.call(b,
function(a,b,d){return lb.call(d,a)===b}):b}function I(b,a,c){if(b&&1===b.nodeType&&a)return b=T.getComputedStyle(b,null),a?c?b.getPropertyValue(a)||void 0:b[a]:b}function O(b,a){return parseInt(I(b,a),10)||0}function mb(b){if(1<arguments.length&&void 0!==arguments[1]?arguments[1]:ya.test(b))return b;if(!za[b]){var a=S(b),c="".concat(a[0].toUpperCase()).concat(a.slice(1));a="".concat(a," ").concat(tc.join("".concat(c," "))).concat(c).split(" ");t(a,function(a,c){if(c in uc)return za[b]=c,!1})}return za[b]}
function nb(b,a){return(2<arguments.length&&void 0!==arguments[2]?arguments[2]:ya.test(b))||vc[b]||!kb(a)?a:"".concat(a,"px")}function ob(b,a){b=b.dataset[a]||b.dataset[S(a)];try{return JSON.parse(b)}catch(c){}return b}function pb(b,a){return O(b,"border".concat(a?"Left":"Top","Width"))+O(b,"padding".concat(a?"Left":"Top"))+O(b,"padding".concat(a?"Right":"Bottom"))+O(b,"border".concat(a?"Right":"Bottom","Width"))}function qb(b,a){return!a||!Aa.call(a,function(a){return 0>b.indexOf(a)})}function wc(b,
a,c,d,f){f.guid=f.guid||k.guid++;var h=b.___ce=b.___ce||{};h[a]=h[a]||[];h[a].push([c,d,f]);b.addEventListener(a,f)}function Ba(b){b=b.split(".");return[b[0],b.slice(1).sort()]}function da(b,a,c,d,f){var h=b.___ce=b.___ce||{};if(a)h[a]&&(h[a]=h[a].filter(function(l){var h=Y(l,3);l=h[0];var e=h[1];h=h[2];if(f&&h.guid!==f.guid||!qb(l,c)||d&&d!==e)return!0;b.removeEventListener(a,h)}));else for(a in h)da(b,a,c,d,f)}function rb(b){return b.multiple&&b.options?B(xa.call(b.options,function(a){return a.selected&&
!a.disabled&&!a.parentNode.disabled}),"value"):b.value||""}function sb(b){if(!u(b))return[];if(xc.test(b))return[J(RegExp.$1)];var a=yc.test(b)&&RegExp.$1;a=tb[a]||tb["*"];a.innerHTML=b;return k(a.childNodes).detach().get()}function zc(b,a){b=k(b);b.filter("script").add(b.find("script")).each(function(b,d){if(Ac.test(d.type)&&Ca.contains(d)){var c=J("script");c.text=d.textContent.replace(Bc,"");t(Cc,function(a,b){d[b]&&(c[b]=d[b])});a.head.insertBefore(c,null);a.head.removeChild(c)}})}function E(b,
a,c,d,f,h,l,e){t(b,function(b,h){t(k(h),function(b,h){t(k(a),function(a,b){var l=c?b:h;b=c?h:b;a=a?l.cloneNode(!0):l;f?b.insertBefore(a,d?b.firstElementChild:null):b.parentNode.insertBefore(a,d?b:b.nextElementSibling);zc(a,b.ownerDocument)},e)},l)},h);return a}function Dc(b){var a=b.pageTypeDefault;b=0<b.pageTypes.length;return!("undefined"===typeof a||null===a)||b}function ub(b,a,c){return"function"===typeof c?{bind:b,selector:a,callback:c}:null}function Ec(){Da=n.onFireException.on(function(b,a){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnException,
{detail:{error:b,context:a}}))});Ea=n.onEventSend.on(function(b){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnBeforeEventSend,{detail:{actionEvent:b},cancelable:!0}))&&document.dispatchEvent(new CustomEvent(e.CustomEvents.OnEventSend,{detail:{actionEvent:b}}))});Fa=n.onPageMatchStatusUpdated.on(function(b){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnPageMatchStatusUpdated,{detail:{matchStatus:b}}))});Ga=n.onInitSitemap.on(function(b){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnInitSitemap,
{detail:{sitemapConfig:b}}))})}function ea(b){Da&&Da();Ea&&Ea();Fa&&Fa();Ga&&Ga();document.dispatchEvent(new CustomEvent(e.CustomEvents.OnShutDown,{detail:{message:b}}));Ha="shutDown";return!1}var vb;(function(b){b[b.NONE=0]="NONE";b[b.ERROR=1]="ERROR";b[b.WARN=2]="WARN";b[b.INFO=3]="INFO";b[b.DEBUG=4]="DEBUG";b[b.TRACE=5]="TRACE"})(vb||(vb={}));var Ia=["error","warn","info","debug","trace"],r=new (function(){function b(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",c=1<arguments.length&&
void 0!==arguments[1]?arguments[1]:0;L(this,b);this.console=window.console;this.level=c;this.prefix=a;this.buildLogFunctions()}return M(b,[{key:"shouldLog",value:function(a){return a<=this.level}},{key:"setLoggingLevel",value:function(a){this.level="string"===typeof a?Ia.indexOf(a.toLowerCase())+1:a||0;this.buildLogFunctions()}},{key:"getLoggingLevel",value:function(){return this.level}},{key:"setPrefix",value:function(a){this.prefix=a;this.buildLogFunctions()}},{key:"getPrefix",value:function(){return this.prefix}},
{key:"buildLogFunctions",value:function(){var a=this;Ia.forEach(function(b,d){b=Ia[d];a[b]=a.shouldLog(d+1)?a.getLogFn(b):function(){}})}},{key:"getLogFn",value:function(a){return Function.prototype.bind.call(this.console.log,this.console,"[".concat(a.toUpperCase(),"]").concat(this.prefix?"("+this.prefix+")":"",":"))}}])}());(function(b){b.OnEventSend="interactions:onEventSend";b.OnBeforeEventSend="interactions:onBeforeEventSend";b.OnException="interactions:onException";b.OnPageMatchStatusUpdated=
"interactions:onPageMatchStatusUpdated";b.OnInit="interactions:onInit";b.OnInitSitemap="interactions:onInitSitemap";b.OnSettledSitemap="interactions:onSettledSitemap";b.OnShutDown="interactions:onShutDown";b.OnSetAnonymousId="interactions:onSetAnonymousId";b.OnResetAnonymousId="interactions:onResetAnonymousId";b.OnClearPersistedIdentities="interactions:onClearPersistedIdentities";b.OnClearCookie="interactions:onClearCookie";b.OnConsentRevoke="interactions:onConsentRevoke";b.OnConsentGrant="interactions:onConsentGrant";
b.OnBeforeInit="interactions:onBeforeInit"})(e.CustomEvents||(e.CustomEvents={}));var Ja={anonymousId:{ids:{},timeoutDays:730}},aa=ra.default?ra.default:ra,wb,P=window.location.hostname,xb=function(){return P},U=function(b){P=b;yb()},yb=function(){wb=aa("".concat(aa(P+"/").slice(0,4))).slice(0,4)},fa=function(){return"".concat("_sfid","_").concat(wb)},zb=!0,Ab="strict",ha=sa({read:function(b){'"'===b[0]&&(b=b.slice(1,-1));return b.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(b){return encodeURIComponent(b).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,
decodeURIComponent)}},{path:"/"});document.addEventListener(e.CustomEvents.OnClearCookie,function(b){var a=b.detail&&b.detail.options||{};a.domain&&U(b.detail.options.domain);Bb(q({domain:P},a))});var Ka=function(){var b=ha.get(fa());return b?JSON.parse(b):void 0},Bb=function(b){ha.remove(fa(),b)},Cb=function(b){Q.write(q(q({},Ka()),{},{consents:b}),Ja.anonymousId.timeoutDays)},Q={read:Ka,write:function(b,a){ha.set(fa(),JSON.stringify(b),{expires:a,domain:P,secure:zb,sameSite:Ab});ha.get(fa())||r.warn("Web SDK cookie (_sfid) could not be set. This is possibly due to a restricted top level domain. See https://publicsuffix.org/learn/ for more information.")},
remove:Bb},Fc=[/bot/i,/spider/i,/facebookexternalhit/i,/simplepie/i,/yahooseeker/i,/embedly/i,/quora link preview/i,/outbrain/i,/vkshare/i,/monit/i,/Pingability/i,/Monitoring/i,/WinHttpRequest/i,/Apache-HttpClient/i,/getprismatic.com/i,/python-requests/i,/Twurly/i,/yandex/i,/browserproxy/i,/crawler/i,/Qwantify/i,/Yahoo! Slurp/i,/pinterest/i,/Tumblr\/14.0.835.186/i,/Tumblr Agent 14.0/i],Gc=function(b){return Fc.some(function(a){return a.test(b)})},Hc=navigator.vendor&&-1<navigator.vendor.indexOf("Apple")&&
navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS"),C="";document.addEventListener(e.CustomEvents.OnResetAnonymousId,function(b){b=b.detail&&b.detail.options||{};b.domain&&U(b.domain);Q.remove(q({domain:P},b));Db()});document.addEventListener(e.CustomEvents.OnSetAnonymousId,function(b){b.detail&&b.detail.newAnonymousId&&(b=b.detail.newAnonymousId,Q.write(q(q({},Ka()),{},{anonymousId:b}),Ja.anonymousId.timeoutDays))});var Eb=function(){return C},
ia=function(b){var a=C;(C=b)?document.dispatchEvent(new CustomEvent(e.CustomEvents.OnSetAnonymousId,{detail:{previousAnonymousId:a,newAnonymousId:b}})):r.warn("Attempted to setAnonymousId but not parameter is undefined")},Db=function(){Fb()?(C=Q.read().anonymousId,ia(C),r.debug("Loaded anonymous identity record from cookie: ".concat(JSON.stringify(C)))):(ia(jb()),r.debug("Created new anonymous identity record. anonymousId: ".concat(C)));return C},Fb=function(){var b=Q.read();return!!(b&&"object"===
x(b)&&0<Object.keys(b).length)},z=document,T=window,Ca=z.documentElement,J=z.createElement.bind(z),Gb=J("div"),La=J("table"),Ic=J("tbody"),Hb=J("tr"),Ma=Array.isArray,F=Array.prototype,xa=F.filter,lb=F.indexOf,Jc=F.map,sc=F.push,Ib=F.slice,Aa=F.some,Kc=F.splice,Lc=/^#[\w-]*$/,oc=/^\.[\w-]*$/,Mc=/<.+>/,pc=/^\w+$/,ba=function(){function b(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:z;L(this,b);if(a){if(a instanceof ba)return a;var d=a;if(u(a)){if(d=c instanceof ba?c[0]:c,d=Lc.test(a)?
d.getElementById(a.slice(1)):Mc.test(a)?sb(a):ta(a,d),!d)return}else if(H(a))return this.ready(a);if(d.nodeType||d===T)d=[d];this.length=d.length;c=0;for(var f=this.length;c<f;c++)this[c]=d[c]}}return M(b,[{key:"init",value:function(a,c){return new b(a,c)}}])}(),g=ba.prototype,k=g.init;k.fn=k.prototype=g;g.length=0;g.splice=Kc;"function"===typeof Symbol&&(g[Symbol.iterator]=F[Symbol.iterator]);g.map=function(b){return k(Jc.call(this,function(a,c){return b.call(a,c,a)}))};g.slice=function(b,a){return k(Ib.call(this,
b,a))};var qc=/-([a-z])/g;k.camelCase=S;k.each=t;g.each=function(b){return t(this,b)};g.removeProp=function(b){return this.each(function(a,c){delete c[b]})};k.extend=function(b){for(var a=arguments.length,c=Array(1<a?a-1:0),d=1;d<a;d++)c[d-1]=arguments[d];a=arguments.length;for(c=2>a?0:1;c<a;c++)for(var f in arguments[c])b[f]=arguments[c][f];return b};g.extend=function(b){return k.extend(g,b)};k.guid=1;k.matches=ua;k.isWindow=va;k.isFunction=H;k.isString=u;k.isNumeric=kb;k.isArray=Ma;g.prop=function(b,
a){if(b){if(u(b))return 2>arguments.length?this[0]&&this[0][b]:this.each(function(c,f){f[b]=a});for(var c in b)this.prop(c,b[c]);return this}};g.get=function(b){return void 0===b?Ib.call(this):this[0>b?b+this.length:b]};g.eq=function(b){return k(this.get(b))};g.first=function(){return this.eq(0)};g.last=function(){return this.eq(-1)};g.filter=function(b){var a=wa(b);return k(xa.call(this,function(b,d){return a.call(b,d,b)}))};var rc=/\S+/g;g.hasClass=function(b){return!!b&&Aa.call(this,function(a){return a.classList.contains(b)})};
g.removeAttr=function(b){var a=ca(b);return this.each(function(b,d){t(a,function(a,b){d.removeAttribute(b)})})};g.attr=function(b,a){if(b){if(u(b)){if(2>arguments.length){if(!this[0])return;var c=this[0].getAttribute(b);return null===c?void 0:c}return void 0===a?this:null===a?this.removeAttr(b):this.each(function(c,f){f.setAttribute(b,a)})}for(c in b)this.attr(c,b[c]);return this}};g.toggleClass=function(b,a){var c=ca(b),d=void 0!==a;return this.each(function(b,h){t(c,function(b,c){d?a?h.classList.add(c):
h.classList.remove(c):h.classList.toggle(c)})})};g.addClass=function(b){return this.toggleClass(b,!0)};g.removeClass=function(b){return arguments.length?this.toggleClass(b,!1):this.attr("class","")};k.unique=A;g.add=function(b,a){return k(A(this.get().concat(k(b,a).get())))};var ya=/^--/,za={},uc=Gb.style,tc=["webkit","moz","ms"];k.prefixedProp=mb;var vc={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};
g.css=function(b,a){if(u(b)){var c=ya.test(b);b=mb(b,c);if(2>arguments.length)return this[0]&&I(this[0],b,c);if(!b)return this;a=nb(b,a,c);return this.each(function(d,h){h&&1===h.nodeType&&(c?h.style.setProperty(b,a):h.style[b]=a)})}for(var d in b)this.css(d,b[d]);return this};g.data=function(b,a){if(!b){if(!this[0])return;var c={},d;for(d in this[0].dataset)c[d]=ob(this[0],d);return c}if(u(b))return 2>arguments.length?this[0]&&ob(this[0],b):this.each(function(c,d){c=a;try{c=JSON.stringify(c)}catch(l){}d.dataset[S(b)]=
c});for(c in b)this.data(c,b[c]);return this};t([!0,!1],function(b,a){t(["Width","Height"],function(b,d){var c="".concat(a?"outer":"inner").concat(d);g[c]=function(f){if(this[0])return va(this[0])?T[c]:this[0]["".concat(a?"offset":"client").concat(d)]+(f&&a?O(this[0],"margin".concat(b?"Top":"Left"))+O(this[0],"margin".concat(b?"Bottom":"Right")):0)}})});t(["width","height"],function(b,a){g[a]=function(c){if(!this[0])return void 0===c?void 0:this;if(!arguments.length)return va(this[0])?this[0][S("outer-".concat(a))]:
this[0].getBoundingClientRect()[a]-pb(this[0],!b);var d=parseInt(c,10);return this.each(function(c,h){h&&1===h.nodeType&&(c=I(h,"boxSizing"),h.style[a]=nb(a,d+("border-box"===c?pb(h,!b):0)))})}});var Na={};g.toggle=function(b){return this.each(function(a,c){if(void 0===b?"none"===I(c,"display"):b){if(c.style.display=c.___cd||"","none"===I(c,"display")){a=c.style;c=c.tagName;if(Na[c])c=Na[c];else{var d=J(c);z.body.insertBefore(d,null);var f=I(d,"display");z.body.removeChild(d);c=Na[c]="none"!==f?f:
"block"}a.display=c}}else c.___cd=I(c,"display"),c.style.display="none"})};g.hide=function(){return this.toggle(!1)};g.show=function(){return this.toggle(!0)};var Oa={focus:"focusin",blur:"focusout"},Jb={mouseenter:"mouseover",mouseleave:"mouseout"},Nc=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;g.off=function(b,a,c){var d=this;if(void 0===b)this.each(function(a,b){da(b)});else if(u(b))H(a)&&(c=a,a=""),t(ca(b),function(b,f){b=Ba(Jb[f]||Oa[f]||f);b=Y(b,2);var l=b[0],h=b[1];d.each(function(b,
d){da(d,l,h,a,c)})});else for(var f in b)this.off(f,b[f]);return this};g.on=function(b,a,c,d){var f=this;if(!u(b)){for(var h in b)this.on(h,a,b[h]);return this}H(a)&&(c=a,a="");t(ca(b),function(b,h){b=Ba(Jb[h]||Oa[h]||h);b=Y(b,2);var l=b[0],e=b[1];f.each(function(b,f){var h=function(b){if(!b.namespace||qb(e,b.namespace.split("."))){var g=f;if(a){for(var k=b.target;!ua(k,a);){if(k===f)return;k=k.parentNode;if(!k)return}g=k;b.___cd=!0}b.___cd&&Object.defineProperty(b,"currentTarget",{configurable:!0,
get:function(){return g}});k=c.call(g,b,b.data);d&&da(f,l,e,a,h);!1===k&&(b.preventDefault(),b.stopPropagation())}};h.guid=c.guid=c.guid||k.guid++;wc(f,l,e,a,h)})});return this};g.one=function(b,a,c){return this.on(b,a,c,!0)};g.ready=function(b){"loading"!==z.readyState?b(k):z.addEventListener("DOMContentLoaded",function(){b(k)});return this};g.trigger=function(b,a){if(u(b)){var c=Ba(b),d=Y(c,2);c=d[0];d=d[1];var f=Nc.test(c)?"MouseEvents":"HTMLEvents";b=z.createEvent(f);b.initEvent(c,!0,!0);b.namespace=
d.join(".")}b.data=a;var h=b.type in Oa;return this.each(function(a,c){if(h&&H(c[b.type]))c[b.type]();else c.dispatchEvent(b)})};var Oc=/%20/g,Pc=/file|reset|submit|button|image/i,Qc=/radio|checkbox/i;g.serialize=function(){var b="";this.each(function(a,c){t(c.elements||[c],function(a,c){c.disabled||!c.name||"FIELDSET"===c.tagName||Pc.test(c.type)||Qc.test(c.type)&&!c.checked||(a=rb(c),void 0!==a&&(a=Ma(a)?a:[a],t(a,function(a,d){a=b;d="&".concat(encodeURIComponent(c.name),"=").concat(encodeURIComponent(d).replace(Oc,
"+"));b=a+d})))})});return b.slice(1)};g.val=function(b){return void 0===b?this[0]&&rb(this[0]):this.each(function(a,c){if("SELECT"===c.tagName){var d=Ma(b)?b:null===b?[]:[b];t(c.options,function(a,b){b.selected=0<=d.indexOf(b.value)})}else c.value=null===b?"":b})};g.clone=function(){return this.map(function(b,a){return a.cloneNode(!0)})};g.detach=function(){return this.each(function(b,a){a.parentNode&&a.parentNode.removeChild(a)})};var yc=/^\s*<(\w+)[^>]*>/,xc=/^\s*<(\w+)\s*\/?>(?:<\/\1>)?\s*$/,
tb={"*":Gb,tr:Ic,td:Hb,th:Hb,thead:La,tbody:La,tfoot:La};k.parseHTML=sb;g.empty=function(){return this.each(function(b,a){for(;a.firstChild;)a.removeChild(a.firstChild)})};g.html=function(b){return void 0===b?this[0]&&this[0].innerHTML:this.each(function(a,c){c.innerHTML=b})};g.remove=function(){return this.detach().off()};g.text=function(b){return void 0===b?this[0]?this[0].textContent:"":this.each(function(a,c){c.textContent=b})};g.unwrap=function(){this.parent().each(function(b,a){b=k(a);b.replaceWith(b.children())});
return this};g.offset=function(){var b=this[0];if(b)return b=b.getBoundingClientRect(),{top:b.top+T.pageYOffset-Ca.clientTop,left:b.left+T.pageXOffset-Ca.clientLeft}};g.offsetParent=function(){return k(this[0]&&this[0].offsetParent)};g.position=function(){var b=this[0];if(b)return{left:b.offsetLeft,top:b.offsetTop}};g.children=function(b){return N(k(A(B(this,function(a){return a.children}))),b)};g.contents=function(){return k(A(B(this,function(b){return"IFRAME"===b.tagName?[b.contentDocument]:b.childNodes})))};
g.find=function(b){return k(A(B(this,function(a){return ta(b,a)})))};var Bc=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ac=/^$|^module$|\/(java|ecma)script/i,Cc=["type","src","nonce","noModule"];g.after=function(){return E(arguments,this,!1,!1,!1,!0,!0)};g.append=function(){return E(arguments,this,!1,!1,!0)};g.appendTo=function(b){return E(arguments,this,!0,!1,!0)};g.before=function(){return E(arguments,this,!1,!0)};g.insertAfter=function(b){return E(arguments,this,!0,!1,!1,!1,!1,!0)};g.insertBefore=
function(b){return E(arguments,this,!0,!0)};g.prepend=function(){return E(arguments,this,!1,!0,!0,!0,!0)};g.prependTo=function(b){return E(arguments,this,!0,!0,!0,!1,!1,!0)};g.replaceWith=function(b){return this.before(b).remove()};g.replaceAll=function(b){k(b).replaceWith(this);return this};g.wrapAll=function(b){b=k(b);for(var a=b[0];a.children.length;)a=a.firstElementChild;this.first().before(b);return this.appendTo(a)};g.wrap=function(b){return this.each(function(a,c){var d=k(b)[0];k(c).wrapAll(a?
d.cloneNode(!0):d)})};g.wrapInner=function(b){return this.each(function(a,c){a=k(c);c=a.contents();c.length?c.wrapAll(b):a.append(b)})};g.has=function(b){var a=u(b)?function(a,d){return ta(b,d).length}:function(a,d){return d.contains(b)};return this.filter(a)};g.is=function(b){var a=wa(b);return Aa.call(this,function(b,d){return a.call(b,d,b)})};g.next=function(b,a){return N(k(A(B(this,"nextElementSibling",a))),b)};g.nextAll=function(b){return this.next(b,!0)};g.not=function(b){var a=wa(b);return this.filter(function(b,
d){return!a.call(d,b,d)})};g.parent=function(b){return N(k(A(B(this,"parentNode"))),b)};g.index=function(b){var a=b?k(b)[0]:this[0];b=b?this:k(a).parent().children();return lb.call(b,a)};g.closest=function(b){var a=this.filter(b);if(a.length)return a;var c=this.parent();return c.length?c.closest(b):a};g.parents=function(b){return N(k(A(B(this,"parentElement",!0))),b)};g.prev=function(b,a){return N(k(A(B(this,"previousElementSibling",a))),b)};g.prevAll=function(b){return this.prev(b,!0)};g.siblings=
function(b){return N(k(A(B(this,function(a){return k(a).parent().children().not(a)}))),b)};var ja=function(){function b(){L(this,b);this.listeners=[]}return M(b,[{key:"on",value:function(a){var b=this;(this.listeners=this.listeners||[]).push(a);return function(){b.listeners=b.listeners.filter(function(b){return b!==a})}}},{key:"once",value:function(a){var b=this;return this.on(function(){b.unbindAll();try{for(var c=arguments.length,f=Array(c),h=0;h<c;h++)f[h]=arguments[h];a.apply(b,f)}catch(l){r.error("Signal listener callback error: "+
l)}})}},{key:"emit",value:function(){for(var a=this,b=arguments.length,d=Array(b),f=0;f<b;f++)d[f]=arguments[f];0!==this.listeners.length&&this.listeners.forEach(function(b){try{b.apply(a,d)}catch(l){r.error("Signal listener callback error: "+l)}})}},{key:"unbindAll",value:function(){this.listeners=[]}}])}(),Rc=function(b){r.debug("Unbinding all signals for type: ",b);Object.keys(b).forEach(function(a){b[a].unbindAll&&b[a].unbindAll()})},n=M(function a(){L(this,a)});n.onEventSend=new ja;n.onFireException=
new ja;n.onPageMatchStatusUpdated=new ja;n.onInitSitemap=new ja;n.unbindAll=function(){Rc(n)};var m={result:{currentPage:null,matchedConfig:null,matchStatus:null},config:{pageTypes:[]}},v=null,Kb=function(){return m.config},Pa=function(){return m.result};(function(a){a.Pending="pending";a.Running="running";a.Selected="selected";a.Matched="matched";a.Rejected="rejected"})(e.MatchStatus||(e.MatchStatus={}));var Ra=function(a){return new Promise(function(c,d){var f=m.config.pageTypeDefault;f&&V({pageName:f.name,
status:e.MatchStatus.Pending});if(f&&!a.length)Qa(f),c(f);else{Sc(a);var h=function(h){Lb(h);Tc(a)||(f?(Qa(f),c(f)):d("No matching page found"))};a.map(function(a){Uc(a).then(function(d){d?(f&&Lb(f),Qa(a),c(a)):h(a)}).catch(function(c){"sitemap_reinit"!==c&&n.onFireException.emit(Error("isMatch failed while evaluating the ".concat(a.name," page config")),"Site-wide Javascript");h(a)})})}})},Mb=function(){m.result.matchStatus&&(m.result.matchStatus.forEach(function(a){a.status===e.MatchStatus.Running&&
a._reject("sitemap_reinit")}),m.result.matchStatus=[]);n.onPageMatchStatusUpdated.emit(m.result.matchStatus)},Sc=function(a){a.forEach(function(a){V({pageName:a.name,status:e.MatchStatus.Pending})})},Qa=function(a){V({pageName:a.name,endTime:Date.now(),status:m.result.matchStatus.find(function(a){return a.status===e.MatchStatus.Selected})?e.MatchStatus.Matched:e.MatchStatus.Selected})},Lb=function(a){V({pageName:a.name,status:e.MatchStatus.Rejected,endTime:Date.now()})},Tc=function(a){return m.result.matchStatus.filter(function(a){return a.status===
e.MatchStatus.Rejected},0).length<a.length},Uc=function(a){return new Promise(function(c,d){V({pageName:a.name,status:e.MatchStatus.Running,startTime:Date.now(),_reject:d});if("function"===typeof a.isMatch)d=a.isMatch(),"object"===x(d)?d.then(function(a){c(a)}).catch(function(){}):c(d);else{var f="isMatch failed while evaluating the ".concat(a.name," page config. isMatch must be a function.");n.onFireException.emit(Error(f),"Site-wide Javascript");d(f)}})},V=function(a){m.result.matchStatus=[].concat(gb(m.result.matchStatus||
[]),[a]);n.onPageMatchStatusUpdated.emit(m.result.matchStatus)};(function(a){a.ViewCatalogObject="View Catalog Object";a.ViewCatalogObjectDetail="View Catalog Object Detail";a.QuickViewCatalogObject="Quick View Catalog Object";a.ShareCatalogObject="Share Catalog Object";a.ReviewCatalogObject="Review Catalog Object";a.CommentCatalogObject="Comment Catalog Object";a.FavoriteCatalogObject="Favorite Catalog Object"})(e.CatalogObjectInteractionName||(e.CatalogObjectInteractionName={}));(function(a){a.AddToCart=
"Add To Cart";a.RemoveFromCart="Remove From Cart";a.ReplaceCart="Replace Cart"})(e.CartInteractionName||(e.CartInteractionName={}));(function(a){a.Purchase="Purchase";a.Preorder="Preorder";a.Cancel="Cancel";a.Ship="Ship";a.Deliver="Deliver";a.Return="Return";a.Exchange="Exchange"})(e.OrderInteractionName||(e.OrderInteractionName={}));(e.MetadataUpdateInteractionName||(e.MetadataUpdateInteractionName={})).MetadataUpdate="MetadataUpdate";(e.ConsentPurpose||(e.ConsentPurpose={})).Tracking="Tracking";
(function(a){a.OptIn="Opt In";a.OptOut="Opt Out"})(e.ConsentStatus||(e.ConsentStatus={}));var Sa=function(a,c,d){n.onFireException.emit(a,c);r.warn("sendException",{event,errorSection:c})},D=[],Nb=function(){return D},Ob=function(a){return D.find(function(c){return a.purpose==c.consent.purpose})},Ta=function(a){Pb(a,!0)},Pb=function(a,c){Array.isArray(a)?a.forEach(function(a){Qb(a,c)}):Qb(a,c);Cb(D)},Qb=function(a,c){if(a&&"object"==x(a)&&a.purpose&&a.provider&&a.status)var d=!0;else Sa(Error("Invalid consent, check that consent is a valid object and all fields are defined: ".concat(JSON.stringify(a))),
"Salesforce Web SDK"),d=!1;if(d)if(d=Ob(a)){var f=d.consent.status;if(d.consent.status!=a.status||d.consent.provider!=a.provider)d.consent=a,d.lastUpdateTime=(new Date).toISOString();c&&(f==e.ConsentStatus.OptOut&&a.status==e.ConsentStatus.OptIn&&Rb(d),f==e.ConsentStatus.OptIn&&a.status==e.ConsentStatus.OptOut&&Sb(d))}else if(d={consent:a,lastUpdateTime:(new Date).toISOString()},D.push(d),c)switch(a.status){case e.ConsentStatus.OptIn:Rb(d);break;case e.ConsentStatus.OptOut:Sb(d);break;default:r.error("Unrecognized consent status: ".concat(a.status))}},
Rb=function(a){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnConsentGrant,{detail:{grantedConsent:a}}))},Sb=function(a){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnConsentRevoke,{detail:{revokedConsent:a}}))},Vc=function(a){var c=(new Date).toISOString();a.forEach(function(a){Ob(a).lastSentTime=c});Cb(D)},Xc=function(a){Wc();Promise.resolve(a).then(function(a){a&&0<a.length&&Ta(a)})},Wc=function(){var a=Q.read();a&&(D=a.consents||[])},Yc=function(a){return 0<=a.findIndex(function(a){return a.status==
e.ConsentStatus.OptIn})},Tb=function(){return Yc(D.map(function(a){return a.consent}))},Ub=function(a){a.source=a.source||{};var c=q({},a.source||{}),d;(d=a.source.pageType)||(d=m.result.currentPage&&m.result.currentPage.source?m.result.currentPage.source.pageType:void 0);a.source=q(c,{},{pageType:d,url:a.source.url||window.location.href,urlReferrer:a.source.urlReferrer||document.referrer,channel:a.source.channel||"Web"});a.user=q(q({},a.user||{}),{},{anonymousId:C});Zc(a)},Zc=function(a){a.consents&&
Pb(a.consents,!1);a.consents=D.filter(function(a){return!a.lastSentTime||new Date(a.lastUpdateTime)>=new Date(a.lastSentTime)}).map(function(a){return a.consent});Vc(a.consents)};document.addEventListener(e.CustomEvents.OnConsentGrant,function(a){a.detail&&a.detail.grantedConsent&&Vb(a.detail.grantedConsent)});document.addEventListener(e.CustomEvents.OnConsentRevoke,function(a){a.detail&&a.detail.revokedConsent&&Vb(a.detail.revokedConsent)});var Ua=function(a){return Wb(a,Tb).catch(function(c){r.error(c.message);
n.onFireException.emit(c,"Site-wide JavaScript");return a})},Vb=function(a){Wb({interaction:{name:e.MetadataUpdateInteractionName.MetadataUpdate},consents:[a.consent]},function(){return!0}).then(function(){return r.debug("Consent event: ".concat(a.consent.status))},function(a){return n.onFireException.emit(a,"Site-wide JavaScript")})},Wb=function(a,c){a:{var d=a,f=m.result.matchedConfig;try{d=f&&f.onActionEvent?f.onActionEvent(d):d;if("object"===x(d)){a=d;break a}n.onFireException.emit(Error("onActionEvent failed for the ".concat(m.result.matchedConfig.name,
" page config. Must return an object or null.")),"Site-wide Javascript")}catch(h){n.onFireException.emit(Error("onActionEvent failed for the ".concat(m.result.matchedConfig.name," page config. ").concat(h.message,".")),"Site-wide Javascript")}a=void 0}a:{d=a;f=m.config;try{d=f.global&&f.global.onActionEvent?f.global.onActionEvent(d):d;if("object"===x(d)){a=d;break a}n.onFireException.emit(Error("onActionEvent failed for the global page config. Must return an object or null."),"Site-wide Javascript")}catch(h){n.onFireException.emit(Error("onActionEvent failed for the global page config. ".concat(h.message,
".")),"Site-wide Javascript")}a=void 0}Ub(a);c&&!c()&&r.debug("No opt-in consents provided. Event will still be dispatched.");r.debug("Sent event: ",a);n.onEventSend.emit(a);return Promise.resolve(a)},$c=function(a){return new Promise(function(c,d){n.onInitSitemap.once(function(){return d("sitemap_reinit")});var f={name:null},h=[];Object.keys(a.interaction).forEach(function(c){var d=Xb(a.interaction[c],c).then(function(a){f[c]=a});h.push(d)});Promise.all(h).then(function(){c(f)}).catch(function(a){n.onFireException.emit(Error("Catalog object interaction config was rejected"),
"Site-wide Javascript")})})},Xb=function(a,c){try{return v=c,"object"===x(a)&&!Array.isArray(a)&&0<Object.keys(a).length?ad(a):Promise.resolve(a).then(function(a){return"function"===typeof a?a():a})}catch(d){n.onFireException.emit(Error("getValue for ".concat(c," failed on ").concat(m.result.matchedConfig.name," while evaluating custom function. ").concat(d.message,".")),"Site-wide Javascript")}},ad=function(a){var c={},d=Object.keys(a),f={};d.forEach(function(d){var f=Xb(a[d],d);c[d]=f});return Promise.all(Object.values(c)).then(function(a){a.forEach(function(a,
c){f[d[c]]=a});return f})},ka,Zb=function(){la();Yb()&&(ka=setInterval(function(){var a=!1,c=(new Date).getTime(),d=m.result.matchedConfig.listeners.map(function(c){if(c.selectorFound)return c;c=Va(c);a=c.selectorFound||a;return c});a&&Object.assign(m.result.matchedConfig,q(q({},m.result.matchedConfig),{},{listeners:d}));(50<(new Date).getTime()-c||!Yb())&&la()},1E3))},Yb=function(){if(m.result.matchedConfig){var a=m.result.matchedConfig.listeners;return a?a.filter(function(a){return!a.selectorFound}).length:
!1}return!1},la=function(){"number"===typeof ka&&clearInterval(ka);ka=null},Va=function(a){var c=k(a.selector),d=q(q({},a),{},{selectorFound:0<c.length});c.on(d.bind,function(a){try{d.callback(a)}catch(h){n.onFireException.emit(Error("Listener callback on ".concat(d.bind," bound to ").concat(d.selector," failed for the ").concat(m.result.matchedConfig.name," page config. ").concat(h.message,".")),"Site-wide Javascript")}});return d},$b=function(){m.result&&m.result.matchedConfig&&m.result.matchedConfig.listeners&&
m.result.matchedConfig.listeners.forEach(function(a){k(a.selector).off(a.bind)})},G={},W=function(a){if(!a||"string"!==typeof a||"function"!==typeof G[a])return null;G[a]();delete G[a]},ac={resolveWhenTrue:{bind:function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Math.random().toString(36).slice(2),d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2E3,f=3<arguments.length&&void 0!==arguments[3]?arguments[3]:100;if("function"===typeof a)return new Promise(function(e,l){var h=
0,g=setInterval(function(){try{h+=f;var g=a();g?(W(c),e(g)):h>=d&&(W(c),e(!1))}catch(eb){W(c),l(eb)}},f);G[c]=function(){clearInterval(g)}})},unbind:W,getBindings:function(){return G},clearBindings:function(){for(var a in G)G.hasOwnProperty(a)&&"function"===typeof G[a]&&W(a)}}},bc=function(a){a.global=a.global||{};"object"!=x(a.global)&&n.onFireException.emit(Error("The global config has a type of ".concat(x(a.global),", but it must be an object")),"Sitewide Javascript");Object.assign(m.config,q({},
a));n.onInitSitemap.emit(m.config)},Wa=function(a){bd(a);return!0},ec=function(a){Ra(a.pageTypes).then(cc).then(dc).catch(function(a){"sitemap_reinit"!==a&&n.onFireException.emit(Error("Unhandled exception: ".concat(a)),"Site-wide Javascript")})},dc=function(a){m.result.matchedConfig=q(q({},a),{},{listeners:cd(a)});m.result.currentPage=q(q({},m.result.currentPage||{}),{},{source:{pageType:a.name,locale:dd(a)},user:{anonymousId:null},interaction:null,pageView:!0});return a.interaction?$c(a).then(function(a){m.result.currentPage.interaction=
a}):Promise.resolve()},cd=function(a){return(a.listeners||[]).map(function(a){return Va(a)})},dd=function(a){return"function"===typeof a.locale?a.locale():a.locale},fc=function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];return c.reduce(function(a,c){Object.keys(c).forEach(function(d){var f=a[d],e=c[d];Array.isArray(f)&&Array.isArray(e)?Object.assign(a,X({},d,f.concat.apply(f,gb(e)))):f&&"object"===x(f)&&e&&"object"===x(e)?Object.assign(a,X({},d,fc(f,e))):Object.assign(a,
X({},d,e))});return a},{})},cc=function(a){var c=m.config.global||{},d=c.onActionEvent;delete c.onActionEvent;a=fc(c,a);c.onActionEvent=d;return a},ed=function(a){a.forEach(function(a){if(!a.name||!a.isMatch)throw Error("All page configs must have a name and isMatch attribute defined");})},fd=function(){var a=m.result;Ua(m.result.currentPage);m.result=a},Xa=function(){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnSettledSitemap,{detail:{result:Pa()}}))},bd=function(a){bc(a);$b();Mb();la();
m.result.currentPage=null;m.result.matchedConfig=null;try{ed(a.pageTypes);var c=!0}catch(d){n.onFireException.emit(Error(d),"Sitemap"),c=!1}c&&Dc(a)?Ra(a.pageTypes).then(cc).then(dc).then(fd).then(Zb).then(Xa).catch(function(a){"sitemap_reinit"!==a&&(n.onFireException.emit(Error("Unhandled exception: ".concat(a)),"Site-wide Javascript"),Xa())}):Xa()},w=function(a,c){if(a)try{return a(c)}catch(d){return n.onFireException.emit(Error("getValue for ".concat(v," failed on ").concat(m.result.matchedConfig.name,
" inside of the custom transform function. ").concat(d)),"Site-wide Javascript"),null}return c},Ya=function(a,c){c=c||window;a=a.split(".");a=na(a);var d;try{for(a.s();!(d=a.n()).done;){var f=d.value;var e=/(\w+)\[([0-9]+)\]/.exec(f);if(c[f])c=c[f];else if(e){if(c[e[1]]&&(c=c[e[1]][parseInt(e[2],10)],!c))return null}else return null}}catch(l){a.e(l)}finally{a.f()}return c},gc={fromSelector:function(a,c){return function(){if("string"!=typeof a)return n.onFireException.emit(Error("getValue for ".concat(v,
" failed on ").concat(m.result.matchedConfig.name,". Selector must be a string.")),"Site-wide Javascript"),null;var d=k(a).first().text();return d=w(c,d)}},fromSelectorAttribute:function(a,c,d){return function(){if("string"!=typeof a)return n.onFireException.emit(Error("getValue for ".concat(v," failed on ").concat(m.result.matchedConfig.name,". Selector must be a string.")),"Site-wide Javascript"),null;if("string"!=typeof c)return n.onFireException.emit(Error("getValue for ".concat(v," failed on ").concat(m.result.matchedConfig.name,
". Attribute must be a string.")),"Site-wide Javascript"),null;var e=k(a).first().attr(c);return e=w(d,e)}},fromSelectorMultiple:function(a,c){return function(){if("string"!=typeof a)return n.onFireException.emit(Error("getValue for ".concat(v," failed on ").concat(m.result.matchedConfig.name,". Selector must be a string.")),"Site-wide Javascript"),null;var d=k(a).get().map(function(a){return k(a).text()});return d=w(c,d)}},fromSelectorAttributeMultiple:function(a,c,d){return function(){if("string"!=
typeof a)return n.onFireException.emit(Error("getValue for ".concat(v," failed on ").concat(m.result.matchedConfig.name,". Selector must be a string.")),"Site-wide Javascript"),null;if("string"!=typeof c)return n.onFireException.emit(Error("getValue for ".concat(v," failed on ").concat(m.result.matchedConfig.name,". Attribute must be a string.")),"Site-wide Javascript"),null;var e=k(a).get().map(function(a){return k(a).attr(c)});return e=w(d,e)}},fromItemProp:function(a,c){return function(){var d=
k("[itemprop='"+a+"']").first().attr("content");return d=w(c,d)}},fromMeta:function(a,c){return function(){var d=k("meta[name='"+a+"']").first().attr("content")||k("meta[property='"+a+"']").first().attr("content");return d=w(c,d)}},fromWindow:function(a,c){return function(){var d=Ya(a);return d=w(c,d)}},fromJsonLd:function(a,c){return function(){var d=k("script[type='application/ld+json']").first().text();try{var e=JSON.parse(d);if(a){var h=Ya(a,e);return w(c,h)}return w(c,e)}catch(l){n.onFireException.emit(Error("Parsing JSON-LD for ".concat(v,
" failed on ").concat(m.result.matchedConfig.name,". ").concat(l)),"Site-wide Javascript")}}},fromCanonical:function(a){return function(){var c=k("link[rel=canonical]").attr("href");return c=w(a,c)}},fromHref:function(a){return function(){var c=window.location.href;return c=w(a,c)}},buildCategoryId:function(a,c,d,e){return function(){var f=Array.from(k(a));c&&(f=f.slice(c));d&&(f=f.slice(0,-1));var l=[];f.forEach(function(a){(a=k(a).text().trim())?l.push(a):n.onFireException.emit(Error("buildCategoryId for ".concat(v,
" failed on ").concat(m.result.matchedConfig.name,". A category part is null.")),"Site-wide Javascript")});f=l.join("|");return f=w(e,f)}},buildCategoryIdAttribute:function(a,c,d,e,h){return function(){var f=Array.from(k(a));d&&(f=f.slice(d));e&&(f=f.slice(0,-1));var g=[];f.forEach(function(a){(a=k(a).attr(c).trim())?g.push(a):n.onFireException.emit(Error("buildCategoryId for ".concat(v," failed on ").concat(m.result.matchedConfig.name,". A category part is null.")),"Site-wide Javascript")});f=g.join("|");
return f=w(h,f)}}},y=k,hc;(function(a){a.INITIALIZED="initialized";a.SHUT_DOWN="shutDown"})(hc||(hc={}));var Ha="shutDown";var R={cookieDomain:null,consents:null},ic=function(){function a(a,c,e){if(e)for(a=Math.random().toString(36).slice(2);d[a];)a=Math.random().toString(36).slice(2);else a=a||c;return a}function c(c,e){return{pageElementLoaded:function(f,g){if("string"!==typeof g||""===g)g=0<y("body").length?"body":"html";if("string"!==typeof f||""===f)throw Error("[pageElementLoaded] Invalid arguments");
return new Promise(function(k){var l=y(f);if(0<l.length)k(l[0]);else{l=y(g)[0];if(!l)throw Error("pageElementLoaded cannot be bound. observerSelector ".concat(g," is not on the page"));var m=new MutationObserver(function(a,d){a=na(a);var e;try{for(a.s();!(e=a.n()).done;){var g=e.value;if(g.addedNodes&&0<g.addedNodes.length){var l=na(g.addedNodes),m;try{for(l.s();!(m=l.n()).done;){var p=m.value,n=y(p).is(f)?p:y(p).find(f).get(0);if(n){c?h.unbind(c):d.disconnect();k(n);return}}}catch(Za){l.e(Za)}finally{l.f()}}}}catch(Za){a.e(Za)}finally{a.f()}});
m.observe(l,{childList:!0,subtree:!0})}c=a(c,"<pageElementLoaded>"+f,e);d[c]=function(){m&&m.disconnect()}})},pageElementVisible:function(f,g){var l=g||0;if("string"!==typeof f||""===f||"number"!==typeof l||0>l||1<l)throw Error("[pageElementVisible] Invalid arguments");return new Promise(function(g){var k=y(f),m=new IntersectionObserver(function(a,d){for(var e=0;e<a.length;e++)if(a[e].isIntersecting){c?h.unbind(c):d.disconnect();g(a[e]);break}},{threshold:l});m.observe(k[0]);c=a(c,"<pageElementVisible>"+
f,e);d[c]=function(){m.disconnect()}})},pageExit:function(f){f=f||0;if("number"!==typeof f||0>f)throw Error("[pageExit] Invalid arguments");return new Promise(function(g){function l(a){clearTimeout(n);10>=a.pageY-window.pageYOffset&&(n=0<f?setTimeout(k.bind(this,a),f):k.call(this,a))}function k(a){c?h.unbind(c):m.off("mousemove",l);clearTimeout(n);g(a)}var m=y(document),n;m.on("mousemove",l);c=a(c,"<pageExit>",e);d[c]=function(){m.off("mousemove",l)}})},pageInactive:function(f){function g(a,d){var e=
new Promise(function(e){function f(a){a=a||new Event("pageInactive");c&&!d.isSubscribe?h.unbind(c):l.off("mousemove click scroll keyup keydown",g);e(a)}function g(c){clearTimeout(k);k=setTimeout(f.bind(this,c),a)}var l=y(document),k;g();l.on("mousemove click scroll keyup keydown",g)});e.subscribe=function(f){delete e.subscribe;d.isSubscribe=!0;e.then(function(e){e.disconnect=function(){c?h.unbind(c):d.isDisconnected=!0};f(e);!d.isDisconnected&&g(a,d).subscribe(f)});return e};return e}if("number"!==
typeof f||0>=f)throw Error("[pageInactive] Invalid arguments");var l={isDisconnected:!1,isSubscribe:!1};c=a(c,"<pageInactive>",e);d[c]=function(){l.isDisconnected=!0};return g(f,l)},pageScroll:function(f){if("number"!==typeof f||0>f||1<f)throw Error("[pageScroll] Invalid arguments");return new Promise(function(g){function l(a){window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)>=f&&(g(a),c?h.unbind(c):k.off("scroll",l))}var k=y(document);k.on("scroll",l);c=a(c,"<pageScroll>",
e);d[c]=function(){k.off("scroll",l)}})}}}var d={},e=c(null,!0),h=function(){return{bind:function(a){a&&d[a]&&(d[a](),delete d[a]);return c(a)},unbind:function(a){if(!a||"string"!==typeof a||"function"!==typeof d[a])return null;d[a]();delete d[a]},getBindings:function(){return d},clearBindings:function(){for(var a in d)d.hasOwnProperty(a)&&(d[a](),delete d[a])}}}();return Object.assign(e,h)}(),jc=function(){function a(c){var d=this;L(this,a);this.clearRateLimiter=function(){d.sentEvents=[]};this.eventWithinLimitTimeRange=
function(a,c,d){return d-c.time<a};this.getTimeRangeMax=function(){return d.eventRateLimiterConfig.globalTimeRange};this.removeOldEvents=function(a){for(var c=d.getTimeRangeMax(),e=d.sentEvents.length-1;0<=e;e--)if(!d.eventWithinLimitTimeRange(c,d.sentEvents[e],a)){d.sentEvents.splice(0,e+1);break}};this.checkGlobalLimits=function(a,c){var e=q({},d.eventRateLimiterConfig),f=e.globalLimit;e=e.globalTimeRange;return d.eventWithinLimitTimeRange(e,d.sentEvents[a],c)&&(d.globalCounter++,d.globalCounter>
f)?(r.info("Event rate limit exceeded. More than ".concat(f," events ")+"sent in ".concat(e,"ms.")),!0):!1};this.checkLimits=function(a,c){return d.checkGlobalLimits(a,c.time)};this.sentEvents=[];this.eventRateLimiterConfig=c}return M(a,[{key:"resetCounters",value:function(){this.globalCounter=0}},{key:"isTriggerLimitExceeded",value:function(a){var c=Date.now();a=q(q({},a),{},{time:c});this.sentEvents.push(a);this.removeOldEvents(c);this.resetCounters();for(c=this.sentEvents.length-1;0<=c;c--)if(this.checkLimits(c,
a))return!0;return!1}}])}(),gd=function(a){function c(a){L(this,c);var d=lc(this,c,[a]);d.getTimeRangeMax=function(){return d.eventRateLimiterConfig.perInteractionTimeRange?Math.max(d.eventRateLimiterConfig.globalTimeRange,d.eventRateLimiterConfig.perInteractionTimeRange):d.eventRateLimiterConfig.globalTimeRange};d.checkInteractionLimits=function(a,c,e){return d.eventRateLimiterConfig.perInteractionLimit&&d.eventRateLimiterConfig.perInteractionTimeRange&&d.eventWithinLimitTimeRange(d.eventRateLimiterConfig.perInteractionTimeRange,
d.sentEvents[a],c)&&d.sentEvents[a].name===e&&(d.perEventCounter++,d.perEventCounter>d.eventRateLimiterConfig.perInteractionLimit)?(r.info("Event rate limit exceeded. More than ".concat(d.eventRateLimiterConfig.perInteractionLimit," events ")+"with interaction name of ".concat(e," sent in ").concat(d.eventRateLimiterConfig.perInteractionTimeRange,"ms.")),!0):!1};d.checkLimits=function(a,c){return d.checkGlobalLimits(a,c.time)||d.checkInteractionLimits(a,c.time,c.name)};return d}mc(c,a);return M(c,
[{key:"resetCounters",value:function(){fb(c,"resetCounters",this,3)([]);this.perEventCounter=0}},{key:"isTriggerLimitExceeded",value:function(a){return fb(c,"isTriggerLimitExceeded",this,3)([a])}}])}(jc),Da,Ea,Fa,Ga,$a=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!(Gc(window.navigator.userAgent||"")?ea("You are a robot."):"prerender"===document.visibilityState&&Hc?ea("Page is pre-rendered and loaded in Safari."):1))return Promise.reject();"initialized"==Ha&&ea("reinitializing Web SDK");
a.cookieDomain&&U(a.cookieDomain);yb();R=q(q({},R),a);document.dispatchEvent(new CustomEvent(e.CustomEvents.OnBeforeInit,{detail:{sdkConfig:R}}));Ec();Db();Ha="initialized";document.dispatchEvent(new CustomEvent(e.CustomEvents.OnInit,{detail:{sdkConfig:R}}));Xc(R.consents);return Promise.resolve()},kc=function(){var a=D.map(function(a){return a.consent});$a(q(q({},R),{},{consents:a})).then(function(){Wa(m.config)})};window.SalesforceInteractions={init:$a,reinit:kc,sendEvent:Ua,sendException:Sa,getAnonymousId:Eb,
setAnonymousId:ia,getCookieDomain:xb,setCookieDomain:U,updateConsents:Ta,getConsents:Nb,ConsentStatus:e.ConsentStatus,log:r,getLoggingLevel:ib,setLoggingLevel:hb,initSitemap:Wa,getSitemapConfig:Kb,getSitemapResult:Pa,CatalogObjectInteractionName:e.CatalogObjectInteractionName,CartInteractionName:e.CartInteractionName,OrderInteractionName:e.OrderInteractionName,listener:ub,build:ec,cashDom:y,resolvers:gc,util:ac,DisplayUtils:ic,CustomEvents:e.CustomEvents};e.DEFAULT_CHANNEL="Web";e.DisplayUtils=ic;
e.EventRateLimiter=jc;e.InteractionEventRateLimiter=gd;e.SITEMAP_REINIT="sitemap_reinit";e.STORAGE_INFO=Ja;e.attemptToBindListener=Va;e.build=ec;e.cancelListenerSearch=la;e.cashDom=y;e.clearPersistedIdentities=function(){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnClearPersistedIdentities))};e.currentConsentOptInExists=Tb;e.generateUuid=jb;e.getAnonymousId=Eb;e.getConsents=Nb;e.getCookieDomain=xb;e.getCurrentSitemapKey=function(){return v};e.getLoggingLevel=ib;e.getSitemapConfig=Kb;e.getSitemapResult=
Pa;e.getState=function(){return m};e.getValueFromNestedObject=Ya;e.identityCookieExists=Fb;e.init=$a;e.initSitemap=Wa;e.listener=ub;e.log=r;e.matchPageConfig=Ra;e.prepareEvent=Ub;e.reinit=kc;e.removeCurrentListeners=$b;e.removeOutstandingPageMatchResolvers=Mb;e.resetAnonymousId=function(){document.dispatchEvent(new CustomEvent(e.CustomEvents.OnResetAnonymousId))};e.resolvers=gc;e.sendEvent=Ua;e.sendException=Sa;e.setAnonymousId=ia;e.setConfig=bc;e.setCookieDomain=U;e.setCurrentSitemapKey=function(a){v=
a};e.setLoggingLevel=hb;e.setSameSiteAttributeOnCookie=function(a){Ab=a};e.setSecureAttributeOnCookie=function(a){zb=a};e.sha1=aa;e.shutDown=ea;e.startListenerSearch=Zb;e.updateConsents=Ta;e.util=ac;return e}({});


// CDP EVENT RECEIVER - npm/@salesforce/interactions-cdp-event-receiver/1.0/build/dist/index.min.js
(function () {
  var cdpEventReceiver=function(i){"use strict";function I(e,...n){n.forEach(t=>{if(e==null||Object.prototype.hasOwnProperty.call(e,t)===!1||e[t]==null)throw new Error(`missing required option "${String(t)}"`)})}function se(e,n=""){const t="https://";try{if(e=e.trim(),/^.+:\/\/.*/.test(e)||(e=t+e),e=t+new URL(e).hostname,!e.endsWith(".salesforce.com"))throw new TypeError("Invalid URL: "+e)}catch{if(e="",n!=="")throw new Error(n)}return e}function x(e,n){const t=new CustomEvent(e,{detail:n});document.dispatchEvent(t)}async function P(e){return await new Promise((n,t)=>{const r=new XMLHttpRequest;r.onload=()=>n(r),r.onerror=()=>n(r),r.abort=()=>t(new Error("Request aborted")),e(r)})}async function ie(e){await new Promise(n=>{setTimeout(n,e)})}function q(e){return e?.status===200||e?.status===204}function d(){return window.SalesforceInteractions}function _(){const e=d().getAnonymousId();if(e==null||e==="")throw new Error("sessionId is missing");return e}function A(e){var n;return(n=e.deviceId)!==null&&n!==void 0?n:_()}const ue=5,le=5;function de(e){var n,t;const r=e.tenantSpecificEndpoint+"/web/v2/authentication",o=(n=e.authenticator.maxAttempts)!==null&&n!==void 0?n:le,a=(t=e.authenticator.retryDelay)!==null&&t!==void 0?t:ue;let c=!1,s=!1;return async()=>{if(c)return!0;if(s)return!1;const l=async()=>{const u=await P(y=>{const E=btoa(JSON.stringify({appSourceId:e.authenticator.appSourceId,deviceId:A(e)}));y.open("POST",r),y.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),y.send(`auth=${E}`)});if(u.status===401)throw s=!0,new Error("Unauthorized");return q(u)};for(let u=o;u>0;u--)try{if(c=await l(),c)return!0}finally{!(c||s)&&u>1&&await ie(a)}throw s=!0,new Error("No more authentication retries")}}function M(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(n,t)=>{const r=t.toString();return String.fromCharCode(parseInt(`0x${r}`,16))}))}var b;(function(e){e.OnBeforeEventSend="dataCloud:onBeforeEventSend",e.OnEventSend="dataCloud:onEventSend"})(b||(b={})),window.SalesforceInteractions!=null&&(window.SalesforceInteractions.DataCloud={CustomEvents:b,profileHasChanged:!1});let S;const fe=new Uint8Array(16);function ge(){if(!S&&(S=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!S))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return S(fe)}var pe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ve(e){return typeof e=="string"&&pe.test(e)}const f=[];for(let e=0;e<256;++e)f.push((e+256).toString(16).slice(1));function F(e,n=0){return f[e[n+0]]+f[e[n+1]]+f[e[n+2]]+f[e[n+3]]+"-"+f[e[n+4]]+f[e[n+5]]+"-"+f[e[n+6]]+f[e[n+7]]+"-"+f[e[n+8]]+f[e[n+9]]+"-"+f[e[n+10]]+f[e[n+11]]+f[e[n+12]]+f[e[n+13]]+f[e[n+14]]+f[e[n+15]]}function me(e){if(!ve(e))throw TypeError("Invalid UUID");let n;const t=new Uint8Array(16);return t[0]=(n=parseInt(e.slice(0,8),16))>>>24,t[1]=n>>>16&255,t[2]=n>>>8&255,t[3]=n&255,t[4]=(n=parseInt(e.slice(9,13),16))>>>8,t[5]=n&255,t[6]=(n=parseInt(e.slice(14,18),16))>>>8,t[7]=n&255,t[8]=(n=parseInt(e.slice(19,23),16))>>>8,t[9]=n&255,t[10]=(n=parseInt(e.slice(24,36),16))/1099511627776&255,t[11]=n/4294967296&255,t[12]=n>>>24&255,t[13]=n>>>16&255,t[14]=n>>>8&255,t[15]=n&255,t}function he(e){e=unescape(encodeURIComponent(e));const n=[];for(let t=0;t<e.length;++t)n.push(e.charCodeAt(t));return n}const ye="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Ie="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function H(e,n,t){function r(o,a,c,s){var l;if(typeof o=="string"&&(o=he(o)),typeof a=="string"&&(a=me(a)),((l=a)===null||l===void 0?void 0:l.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let u=new Uint8Array(16+o.length);if(u.set(a),u.set(o,a.length),u=t(u),u[6]=u[6]&15|n,u[8]=u[8]&63|128,c){s=s||0;for(let y=0;y<16;++y)c[s+y]=u[y];return c}return F(u)}try{r.name=e}catch{}return r.DNS=ye,r.URL=Ie,r}function we(e){if(typeof e=="string"){const n=unescape(encodeURIComponent(e));e=new Uint8Array(n.length);for(let t=0;t<n.length;++t)e[t]=n.charCodeAt(t)}return Oe(Ce(Ee(e),e.length*8))}function Oe(e){const n=[],t=e.length*32,r="0123456789abcdef";for(let o=0;o<t;o+=8){const a=e[o>>5]>>>o%32&255,c=parseInt(r.charAt(a>>>4&15)+r.charAt(a&15),16);n.push(c)}return n}function V(e){return(e+64>>>9<<4)+14+1}function Ce(e,n){e[n>>5]|=128<<n%32,e[V(n)-1]=n;let t=1732584193,r=-271733879,o=-1732584194,a=271733878;for(let c=0;c<e.length;c+=16){const s=t,l=r,u=o,y=a;t=p(t,r,o,a,e[c],7,-680876936),a=p(a,t,r,o,e[c+1],12,-389564586),o=p(o,a,t,r,e[c+2],17,606105819),r=p(r,o,a,t,e[c+3],22,-1044525330),t=p(t,r,o,a,e[c+4],7,-176418897),a=p(a,t,r,o,e[c+5],12,1200080426),o=p(o,a,t,r,e[c+6],17,-1473231341),r=p(r,o,a,t,e[c+7],22,-45705983),t=p(t,r,o,a,e[c+8],7,1770035416),a=p(a,t,r,o,e[c+9],12,-1958414417),o=p(o,a,t,r,e[c+10],17,-42063),r=p(r,o,a,t,e[c+11],22,-1990404162),t=p(t,r,o,a,e[c+12],7,1804603682),a=p(a,t,r,o,e[c+13],12,-40341101),o=p(o,a,t,r,e[c+14],17,-1502002290),r=p(r,o,a,t,e[c+15],22,1236535329),t=v(t,r,o,a,e[c+1],5,-165796510),a=v(a,t,r,o,e[c+6],9,-1069501632),o=v(o,a,t,r,e[c+11],14,643717713),r=v(r,o,a,t,e[c],20,-373897302),t=v(t,r,o,a,e[c+5],5,-701558691),a=v(a,t,r,o,e[c+10],9,38016083),o=v(o,a,t,r,e[c+15],14,-660478335),r=v(r,o,a,t,e[c+4],20,-405537848),t=v(t,r,o,a,e[c+9],5,568446438),a=v(a,t,r,o,e[c+14],9,-1019803690),o=v(o,a,t,r,e[c+3],14,-187363961),r=v(r,o,a,t,e[c+8],20,1163531501),t=v(t,r,o,a,e[c+13],5,-1444681467),a=v(a,t,r,o,e[c+2],9,-51403784),o=v(o,a,t,r,e[c+7],14,1735328473),r=v(r,o,a,t,e[c+12],20,-1926607734),t=m(t,r,o,a,e[c+5],4,-378558),a=m(a,t,r,o,e[c+8],11,-2022574463),o=m(o,a,t,r,e[c+11],16,1839030562),r=m(r,o,a,t,e[c+14],23,-35309556),t=m(t,r,o,a,e[c+1],4,-1530992060),a=m(a,t,r,o,e[c+4],11,1272893353),o=m(o,a,t,r,e[c+7],16,-155497632),r=m(r,o,a,t,e[c+10],23,-1094730640),t=m(t,r,o,a,e[c+13],4,681279174),a=m(a,t,r,o,e[c],11,-358537222),o=m(o,a,t,r,e[c+3],16,-722521979),r=m(r,o,a,t,e[c+6],23,76029189),t=m(t,r,o,a,e[c+9],4,-640364487),a=m(a,t,r,o,e[c+12],11,-421815835),o=m(o,a,t,r,e[c+15],16,530742520),r=m(r,o,a,t,e[c+2],23,-995338651),t=h(t,r,o,a,e[c],6,-198630844),a=h(a,t,r,o,e[c+7],10,1126891415),o=h(o,a,t,r,e[c+14],15,-1416354905),r=h(r,o,a,t,e[c+5],21,-57434055),t=h(t,r,o,a,e[c+12],6,1700485571),a=h(a,t,r,o,e[c+3],10,-1894986606),o=h(o,a,t,r,e[c+10],15,-1051523),r=h(r,o,a,t,e[c+1],21,-2054922799),t=h(t,r,o,a,e[c+8],6,1873313359),a=h(a,t,r,o,e[c+15],10,-30611744),o=h(o,a,t,r,e[c+6],15,-1560198380),r=h(r,o,a,t,e[c+13],21,1309151649),t=h(t,r,o,a,e[c+4],6,-145523070),a=h(a,t,r,o,e[c+11],10,-1120210379),o=h(o,a,t,r,e[c+2],15,718787259),r=h(r,o,a,t,e[c+9],21,-343485551),t=w(t,s),r=w(r,l),o=w(o,u),a=w(a,y)}return[t,r,o,a]}function Ee(e){if(e.length===0)return[];const n=e.length*8,t=new Uint32Array(V(n));for(let r=0;r<n;r+=8)t[r>>5]|=(e[r/8]&255)<<r%32;return t}function w(e,n){const t=(e&65535)+(n&65535);return(e>>16)+(n>>16)+(t>>16)<<16|t&65535}function be(e,n){return e<<n|e>>>32-n}function T(e,n,t,r,o,a){return w(be(w(w(n,e),w(r,a)),o),t)}function p(e,n,t,r,o,a,c){return T(n&t|~n&r,e,n,o,a,c)}function v(e,n,t,r,o,a,c){return T(n&r|t&~r,e,n,o,a,c)}function m(e,n,t,r,o,a,c){return T(n^t^r,e,n,o,a,c)}function h(e,n,t,r,o,a,c){return T(t^(n|~r),e,n,o,a,c)}H("v3",48,we);var k={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function B(e,n,t){if(k.randomUUID&&!e)return k.randomUUID();e=e||{};const r=e.random||(e.rng||ge)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,F(r)}function je(e,n,t,r){switch(e){case 0:return n&t^~n&r;case 1:return n^t^r;case 2:return n&t^n&r^t&r;case 3:return n^t^r}}function R(e,n){return e<<n|e>>>32-n}function Se(e){const n=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){const c=unescape(encodeURIComponent(e));e=[];for(let s=0;s<c.length;++s)e.push(c.charCodeAt(s))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,o=Math.ceil(r/16),a=new Array(o);for(let c=0;c<o;++c){const s=new Uint32Array(16);for(let l=0;l<16;++l)s[l]=e[c*64+l*4]<<24|e[c*64+l*4+1]<<16|e[c*64+l*4+2]<<8|e[c*64+l*4+3];a[c]=s}a[o-1][14]=(e.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(e.length-1)*8&4294967295;for(let c=0;c<o;++c){const s=new Uint32Array(80);for(let g=0;g<16;++g)s[g]=a[c][g];for(let g=16;g<80;++g)s[g]=R(s[g-3]^s[g-8]^s[g-14]^s[g-16],1);let l=t[0],u=t[1],y=t[2],E=t[3],D=t[4];for(let g=0;g<80;++g){const ce=Math.floor(g/20),Ct=R(l,5)+je(ce,u,y,E)+D+n[ce]+s[g]>>>0;D=E,E=y,y=R(u,30)>>>0,u=l,l=Ct}t[0]=t[0]+l>>>0,t[1]=t[1]+u>>>0,t[2]=t[2]+y>>>0,t[3]=t[3]+E>>>0,t[4]=t[4]+D>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}H("v5",80,Se);function Te(e){return(typeof e?.time=="number"?new Date(e.time):new Date).toISOString()}function O(e,n){return{eventId:B(),dateTime:Te(e),sessionId:_(),deviceId:A(n)}}function Ae(e,n){var t;const r=(t=e.consents)!==null&&t!==void 0?t:[];if(r.length===0)return[];const o=[];return r.forEach(a=>{const c=Ue(a,e,n);c!=null&&o.push(c)}),o}function Re(e){return e.length>0&&e.every(n=>n.status==="opt-out")}function Ue(e,n,t){try{let r;if(e.status===i.ConsentStatus.OptIn)r="opt-in";else if(e.status===i.ConsentStatus.OptOut)r="opt-out";else return d().log.error(`Consent value should be either "${i.ConsentStatus.OptIn}" or "${i.ConsentStatus.OptOut}"`,n),null;return Object.assign(Object.assign({},O(n,t)),{eventType:"consentLog",category:"Engagement",purpose:e.purpose,provider:e.provider,status:r})}catch(r){return d().log.error(r.message),null}}function j(e){var n,t,r,o,a,c;return{interactionName:(n=e?.interaction)===null||n===void 0?void 0:n.name,pageView:e?.pageView,sourceUrl:(t=e?.source)===null||t===void 0?void 0:t.url,sourceUrlReferrer:(r=e?.source)===null||r===void 0?void 0:r.urlReferrer,sourceChannel:(o=e?.source)===null||o===void 0?void 0:o.channel,sourceLocale:(a=e?.source)===null||a===void 0?void 0:a.locale,sourcePageType:(c=e?.source)===null||c===void 0?void 0:c.pageType}}const Ne=/^[a-zA-Z](?!.*__)(?!.*_$)\w{0,79}$/;function J(e){return typeof e!="string"||!Ne.test(e)?(d().log.warn(`[Invalid eventType: "${e}"] Must begin with a letter (a-zA-Z) and can only contain alphanumeric characters and underscores (no spaces.) Also cannot end with or have consecutive underscores. Max 80 characters.`),null):e}function $e(e,n){var t;const r=(t=e?.user)===null||t===void 0?void 0:t.attributes;if(typeof r!="object")return[];const o=J(r?.eventType);if(o==null)throw new Error(`Missing or invalid required "user.attributes.eventType" string in action: ${JSON.stringify(e,null,"	")}`);return[Object.assign(Object.assign(Object.assign(Object.assign({},O(e,n)),j(e)),r),{eventType:o,category:"Profile"})]}function G(e){return{eventId:B(),category:e.category,dateTime:e.dateTime,deviceId:e.deviceId,sessionId:e.sessionId,eventType:""}}function Le(e){return e?.id!=null}function De(e){return e?.id!=null&&e?.type!=null}function U(e){return e?.catalogObjectId!=null&&e?.catalogObjectType!=null&&e?.quantity!=null}function xe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var N={exports:{}};const Pe=/[\p{Lu}]/u,qe=/[\p{Ll}]/u,K=/^[\p{Lu}](?![\p{Lu}])/gu,W=/([\p{Alpha}\p{N}_]|$)/u,X=/[_.\- ]+/,_e=new RegExp("^"+X.source),Z=new RegExp(X.source+W.source,"gu"),Q=new RegExp("\\d+"+W.source,"gu"),Me=(e,n,t)=>{let r=!1,o=!1,a=!1;for(let c=0;c<e.length;c++){const s=e[c];r&&Pe.test(s)?(e=e.slice(0,c)+"-"+e.slice(c),r=!1,a=o,o=!0,c++):o&&a&&qe.test(s)?(e=e.slice(0,c-1)+"-"+e.slice(c-1),a=o,o=!1,r=!0):(r=n(s)===s&&t(s)!==s,a=o,o=t(s)===s&&n(s)!==s)}return e},Fe=(e,n)=>(K.lastIndex=0,e.replace(K,t=>n(t))),He=(e,n)=>(Z.lastIndex=0,Q.lastIndex=0,e.replace(Z,(t,r)=>n(r)).replace(Q,t=>n(t))),Y=(e,n)=>{if(!(typeof e=="string"||Array.isArray(e)))throw new TypeError("Expected the input to be `string | string[]`");if(n={pascalCase:!1,preserveConsecutiveUppercase:!1,...n},Array.isArray(e)?e=e.map(a=>a.trim()).filter(a=>a.length).join("-"):e=e.trim(),e.length===0)return"";const t=n.locale===!1?a=>a.toLowerCase():a=>a.toLocaleLowerCase(n.locale),r=n.locale===!1?a=>a.toUpperCase():a=>a.toLocaleUpperCase(n.locale);return e.length===1?n.pascalCase?r(e):t(e):(e!==t(e)&&(e=Me(e,t,r)),e=e.replace(_e,""),n.preserveConsecutiveUppercase?e=Fe(e,t):e=t(e),n.pascalCase&&(e=r(e.charAt(0))+e.slice(1)),He(e,r))};N.exports=Y,N.exports.default=Y;var Ve=N.exports,z=xe(Ve);function C(e,n,t={}){return e==null||(typeof e=="object"?Object.keys(e).forEach(r=>{const o=e[r],a=n!=null?z(n+"."+r):z(r);return C(o,a,t)}):n!=null&&(t[n]=e)),t}function ee(e){return I(e,"catalogObjectType","catalogObjectId","quantity"),Object.assign({catalogObjectType:e.catalogObjectType,catalogObjectId:e.catalogObjectId,price:e.price,quantity:e.quantity,currency:e.currency},C(e.attributes,"attribute"))}function te(e,n,t){const r=ke(e,t);return[r,...Be(r,n)]}function ke(e,n){return Object.assign(Object.assign(Object.assign({},O(e,n)),j(e)),{category:"Engagement",eventType:"cart"})}function Be(e,n){const t=[];if(Je(n)||Ge(n)){I(n,"lineItem");const r=$(e,n.lineItem);r!=null&&t.push(r)}else Ke(n)?(I(n,"lineItems"),n.lineItems.forEach(r=>{const o=$(e,r);o!=null&&t.push(o)})):new Set(n.lineItems).add(n.lineItem).forEach(r=>{if(U(r)){const o=$(e,r);o!=null&&t.push(o)}});return t}function $(e,n){try{return Object.assign(Object.assign(Object.assign({},G(e)),ee(n)),{eventType:"cartItem",cartEventId:e.eventId})}catch(t){return d().log.error(t.message),null}}function Je(e){return e.name===i.CartInteractionName.AddToCart}function Ge(e){return e.name===i.CartInteractionName.RemoveFromCart}function Ke(e){return e.name===i.CartInteractionName.ReplaceCart}function ne(e,n,t){I(n,"catalogObject");const r=n.catalogObject;return[We(e,r,t)]}function We(e,n,t){return I(n,"id","type"),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},O(e,t)),j(e)),C(n.attributes,"attribute")),C(n.relatedCatalogObjects,"relatedCatalogObject")),{category:"Engagement",eventType:"catalog",id:n.id,type:n.type})}function re(e,n,t){I(n,"order");const r=n.order,o=Xe(e,r,t);return[o,...Ze(o,r)]}function Xe(e,n,t){return I(n,"id"),Object.assign(Object.assign(Object.assign(Object.assign({},O(e,t)),j(e)),C(n.attributes,"attribute")),{category:"Engagement",eventType:"order",orderId:n.id,orderCurrency:n.currency,orderTotalValue:n.totalValue})}function Ze(e,n){if(n.lineItems==null)return[];const t=[];return n.lineItems.forEach(r=>{const o=Qe(e,r);o!=null&&t.push(o)}),t}function Qe(e,n){try{return Object.assign(Object.assign(Object.assign({},G(e)),ee(n)),{eventType:"orderItem",orderEventId:e.eventId})}catch(t){return d().log.error(t.message),null}}function Ye(e,n,t){return[...et(e,n,t),...ze(e,n,t)]}function ze(e,n,t){var r;const o=J((r=n.eventType)!==null&&r!==void 0?r:n.name);if(o==null)return[];const a=Object.keys(e.interaction).reduce((c,s)=>(s!=="name"&&(c[s]=n[s]),c),{});return[Object.assign(Object.assign(Object.assign(Object.assign({},C(a)),O(e,t)),j(e)),{eventType:o,category:"Engagement"})]}function et(e,n,t){return n?.eventType==null?[...tt(e,n,t),...nt(e,n,t),...rt(e,n,t)]:[]}function tt(e,n,t){return ot(n)?re(e,n,t):[]}function nt(e,n,t){return at(n)?ne(e,n,t):[]}function rt(e,n,t){return ct(n)?te(e,n,t):[]}function ot(e){return Le(e?.order)}function at(e){return De(e?.catalogObject)}function ct(e){var n;return U(e?.lineItem)||((n=e?.lineItems)===null||n===void 0?void 0:n.some(U))}function st(e,n){const t=e?.interaction;return t==null?[]:(I(e.interaction,"name"),it(t)?re(e,t,n):ut(t)?ne(e,t,n):lt(t)?te(e,t,n):Ye(e,t,n))}function it(e){return i.OrderInteractionName.Return===e.name||i.OrderInteractionName.Ship===e.name||i.OrderInteractionName.Preorder===e.name||i.OrderInteractionName.Cancel===e.name||i.OrderInteractionName.Exchange===e.name||i.OrderInteractionName.Purchase===e.name||i.OrderInteractionName.Deliver===e.name}function ut(e){return i.CatalogObjectInteractionName.ViewCatalogObject===e.name||i.CatalogObjectInteractionName.CommentCatalogObject===e.name||i.CatalogObjectInteractionName.FavoriteCatalogObject===e.name||i.CatalogObjectInteractionName.ReviewCatalogObject===e.name||i.CatalogObjectInteractionName.ShareCatalogObject===e.name||i.CatalogObjectInteractionName.QuickViewCatalogObject===e.name||i.CatalogObjectInteractionName.ViewCatalogObjectDetail===e.name}function lt(e){return i.CartInteractionName.ReplaceCart===e.name||i.CartInteractionName.AddToCart===e.name||i.CartInteractionName.RemoveFromCart===e.name}function dt(e,n){var t,r;const o=Ae(e,n);if(Re(o))return o;const a=$e(e,n);return!((r=(t=d())===null||t===void 0?void 0:t.DataCloud)===null||r===void 0)&&r.profileHasChanged&&(a.length===0&&(a.push(Object.assign(Object.assign({},O(e,n)),{category:"Profile",eventType:"identity",isAnonymous:1})),d().log.debug(`Attaching new anonymous identity: ${A(n)}`)),d().DataCloud.profileHasChanged=!1),[...o,...a,...st(e,n)]}function ft(e,n){return new Request(e,n)}const oe="application/json, text/javascript, */*; q=0.01";async function gt(e,n){const t=dt(e,n),r={actionEvent:e,events:t},o=!document.dispatchEvent(new CustomEvent(b.OnBeforeEventSend,{detail:r,cancelable:!0}));if(d().getLoggingLevel()>=4&&d().log.debug(`Events translated for Data Cloud: ${JSON.stringify(t,ae,"	")}`),t.length>0&&!o){const a=n.tenantSpecificEndpoint+"/web/events/"+n.authenticator.appSourceId,c=JSON.stringify({events:t},ae);x(b.OnEventSend,JSON.parse(c)),await pt(a,c)}}async function pt(e,n){ht()?await mt(e,n):await vt(e,n)}async function vt(e,n){const t=await P(r=>{const o=encodeURIComponent(M(n));r.open("POST",e,!0),r.setRequestHeader("Accept",oe),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(`event=${o}`)});if(!q(t)){const r=new Error(`Response was not OK: ${t.responseText}`);throw Object.assign(r,{status:t.status,statusText:t.statusText}),r}}async function mt(e,n){const t=encodeURIComponent(M(n)),r=new Headers;r.append("Accept",oe),r.append("Content-Type","application/x-www-form-urlencoded");const o={method:"POST",headers:r,body:`event=${t}`,credentials:"omit",keepalive:!0},a=await fetch(e,o);if(await a.text(),!a.ok){const c=new Error(`Response was not OK. Type: ${a.type}, status: ${a.status} (${a.statusText})`);throw Object.assign(c,{status:a.status,statusText:a.statusText,type:a.type}),c}}function ae(e,n){return typeof n=="boolean"?n?1:0:n}function ht(){if(typeof window.fetch!="function")return!1;try{return!!ft("_",{keepalive:!0}).keepalive}catch{return!1}}function yt(e){const n=de(e);return async t=>{await n()&&await gt(t,e)}}function It(e){I(e,"tenantSpecificEndpoint","authenticator"),I(e.authenticator,"appSourceId"),e.tenantSpecificEndpoint=se(e.tenantSpecificEndpoint,"tenantSpecificEndpoint is invalid");const n=yt(e);L(i.CustomEvents.OnBeforeInit,async t=>{t?.detail.sdkConfig!==void 0&&(t.detail.sdkConfig.dataCloud=e)}),L(i.CustomEvents.OnSetAnonymousId,async t=>{const{newAnonymousId:r,previousAnonymousId:o}=t.detail;"previousAnonymousId"in t.detail&&"newAnonymousId"in t.detail&&r!==o&&(d().DataCloud.profileHasChanged=!0,d().log.debug(`deviceId has changed from "${String(o)}" to "${String(r)}"`))}),L(i.CustomEvents.OnEventSend,async t=>{try{const r=t.detail.actionEvent;wt()||Ot(r)?await n(r):d().log.debug("event not sent to CDP because consent was not given")}catch(r){d().log.error(r.message),x(i.CustomEvents.OnException,{error:r})}})}function L(e,n){function t(){document.removeEventListener(e,n),window.removeEventListener("pagehide",t)}document.addEventListener(e,n),window.addEventListener("pagehide",t)}function wt(){return d().getConsents().findIndex(e=>e.consent.status===i.ConsentStatus.OptIn)>=0}function Ot(e){var n;return((n=e?.interaction)===null||n===void 0?void 0:n.name)===i.MetadataUpdateInteractionName.MetadataUpdate&&Array.isArray(e.consents)&&e.consents.some(t=>t.status===i.ConsentStatus.OptOut)}return window.getSalesforceInteractions=()=>d(),window.getSalesforceInteractionsName=()=>"SalesforceInteractions",It}(window.SalesforceInteractions);

  try {
    cdpEventReceiver({
      tenantSpecificEndpoint: "https://myzd9nbwhfrwc9l0gvqt9m30m8.c360a.salesforce.com",
      authenticator: {
        appSourceId: "7a70f6c8-5952-4de0-a72b-d6cfd74841b4"
      }
    });
  } catch (e) {
    console.error("[Salesforce Data Cloud] Error initializing Web SDK:", e);
  }
})();

      (function () {
      // ----- module personalization - npm/@salesforce/interactions-personalization/1.0/build/dist/index.min.js
      try {
        (function(y){"use strict";function $s(e){var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if(n!=="default"){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}var O=$s(y),Ws=Object.defineProperty,Ni=Object.getOwnPropertySymbols,js=Object.prototype.hasOwnProperty,qs=Object.prototype.propertyIsEnumerable,Di=(e,t,n)=>t in e?Ws(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ys=(e,t)=>{for(var n in t||(t={}))js.call(t,n)&&Di(e,n,t[n]);if(Ni)for(var n of Ni(t))qs.call(t,n)&&Di(e,n,t[n]);return e},Ks=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});function Mi(e,t=(n=>(n=window==null?void 0:window.location)==null?void 0:n.search)()){if(w(e)&&w(t)){const n=new URLSearchParams(t);return Array.from(n.keys()).find(r=>r.toLowerCase()===e.toLowerCase())!==void 0}return!1}function Zs(e,t=(n=>(n=window==null?void 0:window.location)==null?void 0:n.search)()){if(w(e)&&w(t)){const n=new URLSearchParams(t),r=Array.from(n.keys()).find(i=>i.toLowerCase()===e.toLowerCase());if(w(r))return n.get(r)}return null}function Xs(e,t=(n=>(n=window==null?void 0:window.location)==null?void 0:n.search)()){if(F(e)&&w(t)){const n=new URLSearchParams(t),r=e.map(o=>o.toLowerCase()),i=Array.from(n.keys()).filter(o=>r.includes(o.toLowerCase()));if(i.length>0){let o={};return i.forEach(s=>{var l;o=Ys({[s]:(l=n.get(s))!=null?l:""},o)}),o}}return null}function Qs(e,t=(n=>(n=window==null?void 0:window.location)==null?void 0:n.href)()){const n=new URL(t);if(w(e)){const r=n.searchParams,i=Array.from(r.keys()).find(o=>o.toLowerCase()===e.toLowerCase());w(i)&&n.searchParams.delete(i)}return n}function w(e,t=!1,n=!0){return typeof e!="string"?!1:t?!0:(n?e.trim():e)!==""}function R(e){return typeof e=="undefined"||e===null}function F(e,t=!1){return Array.isArray(e)?t?!0:e.length!==0:!1}function Js(e,t=!1){return e instanceof Map?t?!0:e.size!==0:!1}function el(e,t=!1){return e instanceof Set?t?!0:e.size!==0:!1}function N(e,t=!0){if(typeof e!="object"||e===null||Array.isArray(e))return!1;if(!t){for(const n in e)return!0;return!1}return!0}function ae(e,t){return N(e)&&!!Object.prototype.hasOwnProperty.call(e,t)}function Dt(e,t=!0){return typeof e=="number"&&(t?Number.isFinite(e):!0)}function an(e){return typeof e=="boolean"}function sn(e){return e!==null&&!isNaN(e)&&e instanceof Date}function jn(e,t){return!w(e)||!w(t)?e===t:e.toLowerCase()===t.toLowerCase()}function qn(e){return e+":"+y.generateUuid()}function Li(e){return`[${e}]`}const tl=function(){return{pageElementVisible:function(e){return Ks(this,null,function*(){return yield new Promise(function(t){const n=(i,o)=>{for(let s=0;s<i.length;s++)if(i[s].isIntersecting){o.disconnect(),t(e);break}},r=new IntersectionObserver(n);document.addEventListener(y.CustomEvents.OnShutDown,()=>{r.disconnect()}),r.observe(e)})})}}}();class nl{constructor(t,n=50,r=!0){this.name=t,this.maxEntries=n,this.entries=new Map,r&&document.addEventListener(y.CustomEvents.OnShutDown,()=>{this.clear()})}get(t){return this.entries.get(t)}set(t,n){y.log.debug(`Cache "${this.name}": adding ${t}`,n),this.entries.set(t,n),this.trimIfNecessary()}clear(){y.log.info(`Cache "${this.name}": clearing all ${this.entries.size} entries`),this.entries.clear()}delete(t){y.log.debug(`Cache "${this.name}": deleting ${t}`),this.entries.delete(t)}trimIfNecessary(){let t=this.entries.size-this.maxEntries;if(!(Dt(t)||t<=0)){y.log.info(`Cache "${this.name}": removing oldest ${String(t)} entries`);for(const[n,r]of this.entries)if(y.log.info(`Cache "${this.name}": removing value:`,r),this.entries.delete(n),--t<=0)break}}}function Mt(e,t){let n=null;try{w(t)?n=new Date(t):Dt(t)?n=new Date(t):sn(t)&&(n=t)}catch(r){}if(sn(n))return n;throw new Error(`${e} is not a valid date`)}function Ri(e,t){return e.endsWith("Date")?Mt(e,t):t}function xi(e){let t=0;switch(e){case"ERROR":t=1;break;case"WARN":t=2;break;case"INFO":t=3;break;case"DEBUG":t=4;break;case"TRACE":t=5;break}return y.log.shouldLog(t)}class k{constructor(t,n=new Date){this.detail=t,this.timestamp=n}}class Yn{constructor(t){this.updates=[],R(t)?this.setFinished(Promise.reject(new Error("Never updated")),!1):this.setFinished(t)}get finished(){return this._finished}update(t,n){this.updates.push(t),this.setFinished(n)}setFinished(t,n=!0){R(t)||(this._finished=t,this._finished.catch(r=>{if(!n)return;let i;if(r instanceof Error)i=r;else{let o;w(r)?o=r:w(r.message)?o=r.message:o=String(r),i=new Error(o)}this.updates.push(new k(i))}))}}class ln{constructor(t){this.pec=t,this.status=new Yn}get revertStatus(){return this._revertStatus}revert(){return R(this._revertStatus)?(R(this.initiateRevert)?this._revertStatus=new Yn(Promise.resolve()):this._revertStatus=this.initiateRevert(),this._revertStatus.update(new k("Requested")),this._revertStatus):this._revertStatus}static updateForAll(t,n,r){t.forEach(i=>{i.status.update(n,r)})}}class ge extends Error{constructor(t,n,r){super(),this.name=t,this.message=n,this.cause=r==null?void 0:r.cause,this.context=r==null?void 0:r.context}isContextWithConfigName(t){return N(t)&&"configName"in t&&typeof t.configName=="string"}getConfigName(){return this.isContextWithConfigName(this.context)?this.context.configName:""}getMessageWithContext(){return this.context!==void 0?`${this.message} Context: ${JSON.stringify(this.context)}`:this.message}}var le=(e=>(e.AnchorDmoNameRequired="ANCHOR_DMO_NAME_REQUIRED",e.AnchorIdNullOrNotEmpty="ANCHOR_ID_NULL_OR_NOT_EMPTY",e.AnchorIdRequiredWithDmoName="ANCHOR_ID_REQUIRED_WITH_DMO_NAME",e.ContextIsNotAnObject="CONTEXT_IS_NOT_AN_OBJECT",e.InitRequiresAppSource="INIT_REQUIRES_APP_SOURCE",e.InitRequiresTSE="INIT_REQUIRES_TSE",e.PersonalizationPointIsNotDefined="PERSONALIZATION_POINT_IS_NOT_DEFINED",e.PersonalizationPointNameIsNotAString="PERSONALIZATION_POINT_NAME_IS_NOT_A_STRING",e.PersonalizationPointDecisionIdIsNotAString="PERSONALIZATION_POINT_DECISION_ID_IS_NOT_A_STRING",e.PersonalizationPointDecisionIdProvidedNonPreview="PERSONALIZATION_POINT_DECISION_ID_PROVIDED_NON_PREVIEW",e.PersonalizationPointsIsNotAnArray="PERSONALIZATION_POINTS_IS_NOT_AN_ARRAY",e.DecisionIdNotValid="DECISION_ID_NOT_VALID",e.EndpointOverrideNotValid="ENDPOINT_OVERRIDE_NOT_VALID",e.IndividualIdNotValid="INDIVIDUAL_ID_NOT_VALID",e))(le||{});class me extends ge{}var ki=(e=>(e.PersonalizationFetchFailed="PERSONALIZATION_FETCH_FAILED",e))(ki||{});class Ui extends ge{}var ct=(e=>(e.InvalidJsonObject="INVALID_JSON_OBJECT",e.MissingPersonalizationId="MISSING_PERSONALIZATION_ID",e.MissingPersonalizationPointName="MISSING_PERSONALIZATION_POINT_NAME",e.MissingPersonalizationDecision="MISSING_PERSONALIZATION_DECISION",e.MissingPersonalizationsArray="MISSING_PERSONALIZATIONS_ARRAY",e))(ct||{});class Lt extends ge{}var _e=(e=>(e.MissingPersonalization="MISSING_PERSONALIZATION",e.ElementsNotFound="ELEMENTS_NOT_FOUND",e.FoundNonElement="FOUND_NON_ELEMENT",e.AlreadyPersonalized="ALREADY_PERSONALIZED",e.NotSupported="NOT_SUPPORTED",e.MissingSubstitutions="MISSING_SUBSTITUTIONS",e.MissingPersonalizationDataAttributes="MISSING_PERSONALIZATION_DATA_ATTRIBUTES",e))(_e||{});class ue extends ge{}var J=(e=>(e.DuplicateTransformer="DUPLICATE_TRANSFORMER",e.InvalidLastModifiedDate="INVALID_LAST_MODIFIED_DATE",e.InvalidPublishedDate="INVALID_PUBLISHED_DATE",e.InvalidSubstitutionConfigType="INVALID_SUBSTITUTION_CONFIG_TYPE",e.InvalidSubstitutionDefinitionConfigDataType="INVALID_SUBSTITUTION_DEFINITION_CONFIG_DATA_TYPE",e.InvalidSubstitutionDefinitionConfigType="INVALID_SUBSTITUTION_DEFINITION_CONFIG_TYPE",e.InvalidSubstitutionDefinitionDescription="INVALID_SUBSTITUTION_DEFINITION_DESCRIPTION",e.InvalidSubstitutionDefinitionLabel="INVALID_SUBSTITUTION_DEFINITION_LABEL",e.InvalidSubstitutionDefinitions="INVALID_SUBSTITUTION_DEFINITIONS",e.InvalidSubstitutionDefinitionValue="INVALID_SUBSTITUTION_DEFINITION_VALUE",e.InvalidTransformerType="INVALID_TRANSFORMER_TYPE",e.InvalidTransformerTypeDetails="INVALID_TRANSFORMER_TYPE_DETAILS",e.InvalidTransformerTypeDetailsType="INVALID_TRANSFORMER_TYPE_DETAILS_TYPE",e.MissingImplementation="MISSING_IMPLEMENTATION",e.MissingTransformer="MISSING_TRANSFORMER",e.MissingTransformerName="MISSING_TRANSFORMER_NAME",e.MissingTransformerSubstitutionDefinition="MISSING_TRANSFORMER_SUBSTITUTION_DEFINITION",e.MissingTransformerSubstitutionDefinitionKey="MISSING_TRANSFORMER_SUBSTITUTION_DEFINITION_KEY",e.MissingTransformerTypeDetails="MISSING_TRANSFORMER_TYPE_DETAILS",e.MissingTransformerTypeDetailsCss="MISSING_TRANSFORMER_TYPE_DETAILS_HTML",e.MissingTransformerTypeDetailsHtml="MISSING_TRANSFORMER_TYPE_DETAILS_HTML",e))(J||{});class X extends ge{}var M=(e=>(e.ContentZonesNotAvailable="CONTENT_ZONES_NOT_AVAILABLE",e.DuplicatePersonalizationExperienceConfig="DUPLICATE_PERSONALIZATION_EXPERIENCE_CONFIG",e.EngagementDestinationsNotAvailable="ENGAGEMENT_DESTINATIONS_NOT_AVAILABLE",e.InvalidDataProviderDataSpaceReferenceType="INVALID_DATA_PROVIDER_DATA_SPACE_REFERENCE_TYPE",e.InvalidDataProviderReferenceType="INVALID_DATA_PROVIDER_REFERENCE_TYPE",e.InvalidDataProviderType="INVALID_DATA_PROVIDER_TYPE",e.InvalidLastModifiedDate="INVALID_LAST_MODIFIED_DATE",e.InvalidPublishedDate="INVALID_PUBLISHED_DATE",e.InvalidRenderIfEmpty="INVALID_RENDER_IF_EMPTY",e.InvalidSourceMatchers="INVALID_SOURCE_MATCHERS",e.InvalidSourceMatcherType="INVALID_SOURCE_MATCHER_TYPE",e.InvalidSourceMatcherValueOnlyStar="INVALID_SOURCE_MATCHER_ONLY_STAR",e.InvalidSourceMatcherValueRepeatedStars="INVALID_SOURCE_MATCHER_REPEATED_STARS",e.InvalidSourceMatcherValueSpaceWithStars="INVALID_SOURCE_MATCHER_SPACE_WITH_STARS",e.InvalidTransformationConfigEngagementDestination="INVALID_TRANSFORMATION_CONFIG_ENGAGEMENT_DESTINATION",e.InvalidTransformationConfigEngagementDestinationName="INVALID_TRANSFORMATION_CONFIG_ENGAGEMENT_DESTINATION_NAME",e.InvalidTransformationConfigMethod="INVALID_TRANSFORMATION_CONFIG_METHOD",e.InvalidTransformationConfigWhen="INVALID_TRANSFORMATION_CONFIG_WHEN",e.InvalidTransformationConfigWhenTypes="INVALID_TRANSFORMATION_CONFIG_WHEN_TYPES",e.InvalidTransformationContentZone="INVALID_TRANSFORMATION_CONTENT_ZONE",e.InvalidTransformations="INVALID_TRANSFORMATIONS",e.InvalidTransformationSubstitutionValues="INVALID_TRANSFORMATION_SUBSTITUTION_VALUES",e.InvalidTransformationType="INVALID_TRANSFORMATION_TYPE",e.InvalidTransformerName="INVALID_TRANSFORMER_NAME",e.InvalidWhenValueDelay="INVALID_WHEN_VALUE_DELAY",e.InvalidWhenValuePath="INVALID_WHEN_VALUE_PATH",e.InvalidWhenValuePercent="INVALID_WHEN_VALUE_PERCENT",e.InvalidWhenValueTag="INVALID_WHEN_VALUE_TAG",e.MethodRequiresSpecificTransformations="METHOD_REQUIRES_SPECIFIC_TRANSFORMATIONS",e.MissingConfig="MISSING_CONFIG",e.MissingDataProvider="MISSING_DATA_PROVIDER",e.MissingDataProviderValue="MISSING_DATA_PROVIDER_VALUE",e.MissingDataSpaceReferenceType="MISSING_DATA_SPACE_REFERENCE_TYPE",e.MissingDataSpaceValue="MISSING_DATA_SPACE_VALUE",e.MissingEngagementConfig=" MISSING_ENGAGEMENT_CONFIG",e.MissingEngagementConfigDefaults=" MISSING_ENGAGEMENT_CONFIG_DEFAULTS",e.MissingEngagementConfigGlobalDefault=" MISSING_ENGAGEMENT_CONFIG_GLOBAL_DEFAULT",e.MissingName="MISSING_NAME",e.MissingSourceMatchers="MISSING_SOURCE_MATCHERS",e.MissingSourceMatcherValue="MISSING_SOURCE_MATCHER_VALUE",e.MissingSubstitutionDefinitionDefaultValue="MISSING_SUBSTITUTION_DEFINITION_DEFAULT_VALUE",e.MissingTransformation="MISSING_TRANSFORMATION",e.MissingTransformationConfig="MISSING_TRANSFORMATION_CONFIG",e.MissingTransformationConfigMethod="MISSING_TRANSFORMATION_CONFIG_METHOD",e.MissingTransformationName="MISSING_TRANSFORMATION_NAME",e.MissingTransformationPath="MISSING_TRANSFORMATION_PATH",e.MissingTransformationSubstitutionValues="MISSING_TRANSFORMATION_SUBSTITUTION_VALUES",e.MissingTransformationTag="MISSING_TRANSFORMATION_TAG",e.MissingTransformerName="MISSING_TRANSFORMER_NAME",e.PaddedSourceMatcherValue="PADDED_SOURCE_MATCHER_VALUE",e.SubstitutionDefinitionKeyNotSupported="SUBSTITUTION_DEFINITION_KEY_NOT_SUPPORTED",e.TransformerDoesNotSupportSubstitutionValues="TRANSFORMER_DOES_NOT_SUPPORT_SUBSTITUTION_VALUES",e.TransformationConfigMethodNotSupported="TRANSFORMATION_CONFIG_METHOD_NOT_SUPPORTED",e.TransformationNameNotSupported="TRANSFORMATION_NAME_NOT_SUPPORTED",e.TransformationPathNotSupported="TRANSFORMATION_PATH_NOT_SUPPORTED",e.TransformationTagNotSupported="TRANSFORMATION_TAG_NOT_SUPPORTED",e.TransformersNotAvailable="TRANSFORMATIONS_NOT_AVAILABLE",e.UnexpectedError="UNEXPECTED_ERROR",e.WhenValuesNotSupported="WHEN_VALUES_NOT_SUPPORTED",e.WhenValuesValidationLogicNotImplemented="WHEN_VALUES_VALIDATION_LOGIC_NOT_IMPLEMENTED",e.WhenTypeRequiresSpecificMethodType="WHEN_TYPE_REQUIRES_SPECIFIC_METHOD_TYPE",e))(M||{});class D extends ge{}var ft=(e=>(e.MissingPersonalizationExperienceConfig="MISSING_PERSONALIZATION_EXPERIENCE_CONFIG",e.DuplicatePersonalizationExperienceConfigs="DUPLICATE_PERSONALIZATION_EXPERIENCE_CONFIGS",e.PointOptionsNotValid="POINT_OPTIONS_NOT_VALID",e.PointOptionKeyInvalid="POINT_OPTION_KEY_INVALID",e))(ft||{});class Rt extends ge{}var Kn=(e=>(e.OnlySupportConfiguredDataSpace="ONLY_SUPPORT_CONFIGURED_DATA_SPACE",e.OnlySupportDataProviderApiName="ONLY_SUPPORT_DATA_PROVIDER_API_NAME",e.OnlySupportDataSpaceApiName="ONLY_SUPPORT_DATA_SPACE_API_NAME",e.OnlySupportPersonalizationPoint="ONLY_SUPPORT_PERSONALIZATION_POINT",e))(Kn||{});class un extends ge{}var Me=(e=>(e.AddingClickListenerError="ADDING_CLICK_LISTENER_ERROR",e.DisplayUtilsPageExitError="DISPLAY_UTILS_PAGE_EXIT_ERROR",e.DisplayUtilsPageScrollError="DISPLAY_UTILS_PAGE_SCROLL_ERROR",e.NotWaitingForElementClick="NOT_WAITING_FOR_ELEMENT_CLICK",e.NotWaitingForElementPath="NOT_WAITING_FOR_ELEMENT_PATH",e.NotWaitingForPageExit="NOT_WAITING_FOR_PAGE_EXIT",e.NotWaitingForPageScroll="NOT_WAITING_FOR_PAGE_SCROLL",e))(Me||{});class Ve extends ge{}var ce=(e=>(e.InvalidAllowedElements="INVALID_ALLOWED_ELEMENTS",e.InvalidAllowedElementKey="INVALID_ALLOWED_ELEMENT_KEY",e.InvalidAllowedProperties="INVALID_ALLOWED_PROPERTIES",e.InvalidAllowedTargetMethodTypeMethod="INVALID_ALLOWED_TARGET_METHOD_TYPE_METHOD",e.InvalidAllowedTargetMethodTypes="INVALID_ALLOWED_TARGET_METHOD_TYPES",e.InvalidAllowedTransformers="INVALID_ALLOWED_TRANSFORMERS",e.InvalidConfig="INVALID_CONFIG",e.InvalidConfigOptions="INVALID_CONFIG_OPTIONS",e))(ce||{});class ve extends ge{}var Qe=(e=>(e.ConfigIsRequired="CONFIG_IS_REQUIRED",e.TransformersAreRequired="TRANSFORMERS_ARE_REQUIRED",e.WpmConfigIsRequired="WPM_CONFIG_IS_REQUIRED",e))(Qe||{});class dt extends ge{}var Te=(e=>(e.MethodIsRequired="METHOD_IS_REQUIRED",e.MethodNotAllowed="METHOD_NOT_ALLOWED",e.OnlyElementsSupported="ONLY_TARGET_ELEMENTS_ARE_SUPPORTED",e.OneSourceMatcherSupported="ONE_SOURCE_MATCHER_IS_SUPPORTED",e.OneTransformerSupported="ONE_TRANSFORMER_IS_SUPPORTED",e.PropertyNotAllowed="PROPERTY_NOT_ALLOWED",e.SubstitutionValuesNotAllowed="SUBSTITUTION_VALUES_NOT_ALLOWED",e.TagsNotAllowed="TAGS_NOT_ALLOWED",e.TransformersAreDisabled="TRANSFORMERS_ARE_DISABLED",e))(Te||{});class Ae extends ge{}var $=(e=>(e.DestinationEventModifiersAreRequired="DESTINATION_EVENT_MODIFIERS_ARE_REQUIRED",e.EngagementDestinationsAreRequired="ENGAGEMENT_DESTINATIONS_ARE_REQUIRED",e.EngagementDestinationDefaultsAreRequired="ENGAGEMENT_DESTINATION_DEFAULTS_ARE_REQUIRED",e.InvalidConfig="INVALID_CONFIG",e.InvalidDestinationEventModifier="INVALID_DESTINATION_EVENT_MODIFIER",e.InvalidEngagementDestinationDefaultByName="INVALID_ENGAGEMENT_DESTINATION_DEFAULT_BY_NAME",e.InvalidEngagementDestinationDefaultByNameValue="INVALID_ENGAGEMENT_DESTINATION_DEFAULT_BY_NAME_VALUE",e.InvalidEngagementDestinationDefaultByType="INVALID_ENGAGEMENT_DESTINATION_DEFAULT_BY_TYPE",e.InvalidEngagementDestinationDefaultByTypeValue="INVALID_ENGAGEMENT_DESTINATION_DEFAULT_BY_TYPE_VALUE",e.InvalidEngagementDestinationDefaultGlobal="INVALID_ENGAGEMENT_DESTINATION_DEFAULT_GLOBAL",e.InvalidEngagementDestinationDescription="INVALID_ENGAGEMENT_DESTINATION_DESCRIPTION",e.InvalidEngagementDestinationAttributeDescription="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_DESCRIPTION",e.InvalidEngagementDestinationAttributeEngagements="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENTS",e.InvalidEngagementDestinationAttributeEngagementHandle="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_HANDLE",e.InvalidEngagementDestinationAttributeEngagementObserve="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_OBSERVE",e.InvalidEngagementDestinationAttributeEngagementQualify="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_QUALIFY",e.InvalidEngagementDestinationAttributeEngagementValue="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_VALUE",e.InvalidEngagementDestinationAttributeEventModifierModifyEvent="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_EVENT_MODIFIER_MODIFY_EVENT",e.InvalidEngagementDestinationAttributeEventModifiers="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_EVENT_MODIFIERS",e.InvalidEngagementDestinationAttributeEventModifiersValue="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_EVENT_MODIFIERS_VALUE",e.InvalidEngagementDestinationAttributeEventModifierValueDefault="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_EVENT_MODIFIER_VALUE_DEFAULT",e.InvalidEngagementDestinationAttributeEventModifierValueType="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_EVENT_MODIFIER_VALUE_TYPE",e.InvalidEngagementDestinationAttributes="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTES",e.InvalidEngagementDestinationAttributeScope="INVALID_ENGAGEMENT_DESTINATION_ATTRIBUTE_SCOPE",e.MissingEngagementDestinationAttributeEngagementHandle="MISSING_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_HANDLE",e.MissingEngagementDestinationAttributeEngagementObserve="MISSING_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_OBSERVE",e.MissingEngagementDestinationAttributeEngagementQualify="MISSING_ENGAGEMENT_DESTINATION_ATTRIBUTE_ENGAGEMENT_QUALIFY",e.MissingEngagementDestinationAttributeEventModifierModifyEvent="MISSING_ENGAGEMENT_DESTINATION_ATTRIBUTE_EVENT_MODIFIER_MODIFY_EVENT",e))($||{});class W extends ge{}class Zn extends Error{constructor(t){super(t),this.name=this.constructor.name}}function rl(e){return N(e)&&"message"in e&&typeof e.message=="string"}function Q(e){if(e instanceof ge)return{message:e.getMessageWithContext()};if(rl(e))return e;if(w(e))return{message:e};try{return new Error(JSON.stringify(e))}catch(t){return new Error(String(e))}}const il="personalization/decisions";var ol=Object.defineProperty,Fi=Object.getOwnPropertySymbols,al=Object.prototype.hasOwnProperty,sl=Object.prototype.propertyIsEnumerable,zi=(e,t,n)=>t in e?ol(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Vi=(e,t)=>{for(var n in t||(t={}))al.call(t,n)&&zi(e,n,t[n]);if(Fi)for(var n of Fi(t))sl.call(t,n)&&zi(e,n,t[n]);return e};let cn,Xn,Hi="",ht={};function Qn(){return cn!=null?cn:""}function ll(){return Xn!=null?Xn:""}function ul(){return ht}function xt(){var e;return(e=ht==null?void 0:ht.dataspace)!=null?e:""}function fn(){return Hi}function cl(){document.addEventListener(O.CustomEvents.OnBeforeInit,e=>{var t;const n=e==null?void 0:e.detail.sdkConfig;n!==void 0&&(ht=Vi(Vi({},ht),(t=n.personalization)!=null?t:{}),e.detail.sdkConfig.personalization=ht)})}function fl(){document.addEventListener(O.CustomEvents.OnInit,e=>{var t,n,r;const i=(n=(t=e==null?void 0:e.detail)==null?void 0:t.sdkConfig)==null?void 0:n.dataCloud;if(R(i)){O.log.warn("OnInit did not include Data Cloud config");return}if(!w(i.tenantSpecificEndpoint))O.log.warn("Tenant Specific Endpoint URL was not provided in Data Cloud config");else try{cn=new URL(il,i.tenantSpecificEndpoint).toString()}catch(o){O.log.warn(`Tenant Specific Endpoint URL is not valid: ${i.tenantSpecificEndpoint}`)}!N(i.authenticator)||!w(i.authenticator.appSourceId)?O.log.warn("App Source Id was not provided in Data Cloud config"):Xn=i.authenticator.appSourceId,N(document.currentScript)&&(Hi=(r=document.currentScript.nonce)!=null?r:"")})}function Bi(e){if(e===void 0){if(!w(cn))throw new me(le.InitRequiresTSE,"Tenant Specific Endpoint URL must be set by calling SalesforceInteractions.init.")}else if(!w(e))throw new me(le.EndpointOverrideNotValid,"Endpoint URL must be a valid string if provided.")}function Ye(){return!w(Qn())}var Ce=(e=>(e.HtmlElementModifier="HTMLElementModifier",e.Handlebars="Handlebars",e))(Ce||{}),dn=(e=>(e.String="String",e))(dn||{}),hn=(e=>(e.SchemaPath="SchemaPath",e))(hn||{});const dl=[{name:"HTMLElementModifier",transformerType:"HTMLElementModifier",transformerTypeDetails:{}}];var Jn=(e=>(e.PersonalizationPoint="PersonalizationPoint",e))(Jn||{}),er=(e=>(e.ApiName="ApiName",e))(er||{}),Oe=(e=>(e.Immediately="Immediately",e.ExitIntent="ExitIntent",e.ElementClick="ElementClick",e.ScrollPercent="ScrollPercent",e))(Oe||{}),q=(e=>(e.ReplaceContentZoneContent="ReplaceContentZoneContent",e.ReplaceElementContent="ReplaceElementContent",e.AddAfterElement="AddAfterElement",e.AddBeforeElement="AddBeforeElement",e.AddOverlay="AddOverlay",e))(q||{});function pt(e){return e!==void 0&&e==="AddOverlay"}function Ke(e){return(e==null?void 0:e.tag)!==void 0}function Je(e){return(e==null?void 0:e.name)!==void 0}function Gi(e){return(e==null?void 0:e.path)!==void 0}function $i(e){return(e==null?void 0:e.percent)!==void 0}function Wi(e){return(e==null?void 0:e.delay)!==void 0}function hl(e){return R(e)||e==="PersonalizationPoint"}/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:ji,setPrototypeOf:qi,isFrozen:pl,getPrototypeOf:gl,getOwnPropertyDescriptor:ml}=Object;let{freeze:fe,seal:Se,create:Yi}=Object,{apply:tr,construct:nr}=typeof Reflect!="undefined"&&Reflect;fe||(fe=function(t){return t}),Se||(Se=function(t){return t}),tr||(tr=function(t,n,r){return t.apply(n,r)}),nr||(nr=function(t,n){return new t(...n)});const pn=he(Array.prototype.forEach),vl=he(Array.prototype.lastIndexOf),Ki=he(Array.prototype.pop),kt=he(Array.prototype.push),El=he(Array.prototype.splice),gn=he(String.prototype.toLowerCase),rr=he(String.prototype.toString),Zi=he(String.prototype.match),Ut=he(String.prototype.replace),_l=he(String.prototype.indexOf),yl=he(String.prototype.trim),Pe=he(Object.prototype.hasOwnProperty),de=he(RegExp.prototype.test),Ft=Tl(TypeError);function he(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return tr(e,t,r)}}function Tl(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return nr(e,n)}}function z(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:gn;qi&&qi(e,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const o=n(i);o!==i&&(pl(t)||(t[r]=o),i=o)}e[i]=!0}return e}function Sl(e){for(let t=0;t<e.length;t++)Pe(e,t)||(e[t]=null);return e}function et(e){const t=Yi(null);for(const[n,r]of ji(e))Pe(e,n)&&(Array.isArray(r)?t[n]=Sl(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=et(r):t[n]=r);return t}function zt(e,t){for(;e!==null;){const r=ml(e,t);if(r){if(r.get)return he(r.get);if(typeof r.value=="function")return he(r.value)}e=gl(e)}function n(){return null}return n}const Xi=fe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ir=fe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),or=fe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wl=fe(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ar=fe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),bl=fe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Qi=fe(["#text"]),Ji=fe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),sr=fe(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),eo=fe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mn=fe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Il=Se(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Al=Se(/<%[\w\W]*|[\w\W]*%>/gm),Cl=Se(/\$\{[\w\W]*/gm),Ol=Se(/^data-[\-\w.\u00B7-\uFFFF]+$/),Pl=Se(/^aria-[\-\w]+$/),to=Se(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Nl=Se(/^(?:\w+script|data):/i),Dl=Se(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),no=Se(/^html$/i),Ml=Se(/^[a-z][.\w]*(-[.\w]+)+$/i);var ro=Object.freeze({__proto__:null,ARIA_ATTR:Pl,ATTR_WHITESPACE:Dl,CUSTOM_ELEMENT:Ml,DATA_ATTR:Ol,DOCTYPE_NAME:no,ERB_EXPR:Al,IS_ALLOWED_URI:to,IS_SCRIPT_OR_DATA:Nl,MUSTACHE_EXPR:Il,TMPLIT_EXPR:Cl});const Vt={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Ll=function(){return typeof window=="undefined"?null:window},Rl=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML(s){return s},createScriptURL(s){return s}})}catch(s){return console.warn("TrustedTypes policy "+o+" could not be created."),null}},io=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function oo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ll();const t=x=>oo(x);if(t.version="3.2.4",t.removed=[],!e||!e.document||e.document.nodeType!==Vt.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,i=r.currentScript,{DocumentFragment:o,HTMLTemplateElement:s,Node:l,Element:a,NodeFilter:u,NamedNodeMap:c=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:p,DOMParser:f,trustedTypes:h}=e,d=a.prototype,g=zt(d,"cloneNode"),v=zt(d,"remove"),S=zt(d,"nextSibling"),_=zt(d,"childNodes"),b=zt(d,"parentNode");if(typeof s=="function"){const x=n.createElement("template");x.content&&x.content.ownerDocument&&(n=x.content.ownerDocument)}let m,T="";const{implementation:P,createNodeIterator:A,createDocumentFragment:U,getElementsByTagName:K}=n,{importNode:G}=r;let H=io();t.isSupported=typeof ji=="function"&&typeof b=="function"&&P&&P.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ke,ERB_EXPR:Ue,TMPLIT_EXPR:Ei,DATA_ATTR:hp,ARIA_ATTR:pp,IS_SCRIPT_OR_DATA:gp,ATTR_WHITESPACE:_s,CUSTOM_ELEMENT:mp}=ro;let{IS_ALLOWED_URI:ys}=ro,ne=null;const Ts=z({},[...Xi,...ir,...or,...ar,...Qi]);let ie=null;const Ss=z({},[...Ji,...sr,...eo,...mn]);let te=Object.seal(Yi(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tn=null,_i=null,ws=!0,yi=!0,bs=!1,Is=!0,It=!1,Ti=!0,ut=!1,Si=!1,wi=!1,At=!1,Fn=!1,zn=!1,As=!0,Cs=!1;const vp="user-content-";let bi=!0,nn=!1,Ct={},Ot=null;const Os=z({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ps=null;const Ns=z({},["audio","video","img","source","image","track"]);let Ii=null;const Ds=z({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Vn="http://www.w3.org/1998/Math/MathML",Hn="http://www.w3.org/2000/svg",je="http://www.w3.org/1999/xhtml";let Pt=je,Ai=!1,Ci=null;const Ep=z({},[Vn,Hn,je],rr);let Bn=z({},["mi","mo","mn","ms","mtext"]),Gn=z({},["annotation-xml"]);const _p=z({},["title","style","font","a","script"]);let rn=null;const yp=["application/xhtml+xml","text/html"],Tp="text/html";let re=null,Nt=null;const Sp=n.createElement("form"),Ms=function(E){return E instanceof RegExp||E instanceof Function},Oi=function(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Nt&&Nt===E)){if((!E||typeof E!="object")&&(E={}),E=et(E),rn=yp.indexOf(E.PARSER_MEDIA_TYPE)===-1?Tp:E.PARSER_MEDIA_TYPE,re=rn==="application/xhtml+xml"?rr:gn,ne=Pe(E,"ALLOWED_TAGS")?z({},E.ALLOWED_TAGS,re):Ts,ie=Pe(E,"ALLOWED_ATTR")?z({},E.ALLOWED_ATTR,re):Ss,Ci=Pe(E,"ALLOWED_NAMESPACES")?z({},E.ALLOWED_NAMESPACES,rr):Ep,Ii=Pe(E,"ADD_URI_SAFE_ATTR")?z(et(Ds),E.ADD_URI_SAFE_ATTR,re):Ds,Ps=Pe(E,"ADD_DATA_URI_TAGS")?z(et(Ns),E.ADD_DATA_URI_TAGS,re):Ns,Ot=Pe(E,"FORBID_CONTENTS")?z({},E.FORBID_CONTENTS,re):Os,tn=Pe(E,"FORBID_TAGS")?z({},E.FORBID_TAGS,re):{},_i=Pe(E,"FORBID_ATTR")?z({},E.FORBID_ATTR,re):{},Ct=Pe(E,"USE_PROFILES")?E.USE_PROFILES:!1,ws=E.ALLOW_ARIA_ATTR!==!1,yi=E.ALLOW_DATA_ATTR!==!1,bs=E.ALLOW_UNKNOWN_PROTOCOLS||!1,Is=E.ALLOW_SELF_CLOSE_IN_ATTR!==!1,It=E.SAFE_FOR_TEMPLATES||!1,Ti=E.SAFE_FOR_XML!==!1,ut=E.WHOLE_DOCUMENT||!1,At=E.RETURN_DOM||!1,Fn=E.RETURN_DOM_FRAGMENT||!1,zn=E.RETURN_TRUSTED_TYPE||!1,wi=E.FORCE_BODY||!1,As=E.SANITIZE_DOM!==!1,Cs=E.SANITIZE_NAMED_PROPS||!1,bi=E.KEEP_CONTENT!==!1,nn=E.IN_PLACE||!1,ys=E.ALLOWED_URI_REGEXP||to,Pt=E.NAMESPACE||je,Bn=E.MATHML_TEXT_INTEGRATION_POINTS||Bn,Gn=E.HTML_INTEGRATION_POINTS||Gn,te=E.CUSTOM_ELEMENT_HANDLING||{},E.CUSTOM_ELEMENT_HANDLING&&Ms(E.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(te.tagNameCheck=E.CUSTOM_ELEMENT_HANDLING.tagNameCheck),E.CUSTOM_ELEMENT_HANDLING&&Ms(E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(te.attributeNameCheck=E.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),E.CUSTOM_ELEMENT_HANDLING&&typeof E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(te.allowCustomizedBuiltInElements=E.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),It&&(yi=!1),Fn&&(At=!0),Ct&&(ne=z({},Qi),ie=[],Ct.html===!0&&(z(ne,Xi),z(ie,Ji)),Ct.svg===!0&&(z(ne,ir),z(ie,sr),z(ie,mn)),Ct.svgFilters===!0&&(z(ne,or),z(ie,sr),z(ie,mn)),Ct.mathMl===!0&&(z(ne,ar),z(ie,eo),z(ie,mn))),E.ADD_TAGS&&(ne===Ts&&(ne=et(ne)),z(ne,E.ADD_TAGS,re)),E.ADD_ATTR&&(ie===Ss&&(ie=et(ie)),z(ie,E.ADD_ATTR,re)),E.ADD_URI_SAFE_ATTR&&z(Ii,E.ADD_URI_SAFE_ATTR,re),E.FORBID_CONTENTS&&(Ot===Os&&(Ot=et(Ot)),z(Ot,E.FORBID_CONTENTS,re)),bi&&(ne["#text"]=!0),ut&&z(ne,["html","head","body"]),ne.table&&(z(ne,["tbody"]),delete tn.tbody),E.TRUSTED_TYPES_POLICY){if(typeof E.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ft('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof E.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ft('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');m=E.TRUSTED_TYPES_POLICY,T=m.createHTML("")}else m===void 0&&(m=Rl(h,i)),m!==null&&typeof T=="string"&&(T=m.createHTML(""));fe&&fe(E),Nt=E}},Ls=z({},[...ir,...or,...wl]),Rs=z({},[...ar,...bl]),wp=function(E){let C=b(E);(!C||!C.tagName)&&(C={namespaceURI:Pt,tagName:"template"});const L=gn(E.tagName),Z=gn(C.tagName);return Ci[E.namespaceURI]?E.namespaceURI===Hn?C.namespaceURI===je?L==="svg":C.namespaceURI===Vn?L==="svg"&&(Z==="annotation-xml"||Bn[Z]):!!Ls[L]:E.namespaceURI===Vn?C.namespaceURI===je?L==="math":C.namespaceURI===Hn?L==="math"&&Gn[Z]:!!Rs[L]:E.namespaceURI===je?C.namespaceURI===Hn&&!Gn[Z]||C.namespaceURI===Vn&&!Bn[Z]?!1:!Rs[L]&&(_p[L]||!Ls[L]):!!(rn==="application/xhtml+xml"&&Ci[E.namespaceURI]):!1},Fe=function(E){kt(t.removed,{element:E});try{b(E).removeChild(E)}catch(C){v(E)}},$n=function(E,C){try{kt(t.removed,{attribute:C.getAttributeNode(E),from:C})}catch(L){kt(t.removed,{attribute:null,from:C})}if(C.removeAttribute(E),E==="is")if(At||Fn)try{Fe(C)}catch(L){}else try{C.setAttribute(E,"")}catch(L){}},xs=function(E){let C=null,L=null;if(wi)E="<remove></remove>"+E;else{const oe=Zi(E,/^[\r\n\t ]+/);L=oe&&oe[0]}rn==="application/xhtml+xml"&&Pt===je&&(E='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+E+"</body></html>");const Z=m?m.createHTML(E):E;if(Pt===je)try{C=new f().parseFromString(Z,rn)}catch(oe){}if(!C||!C.documentElement){C=P.createDocument(Pt,"template",null);try{C.documentElement.innerHTML=Ai?T:Z}catch(oe){}}const se=C.body||C.documentElement;return E&&L&&se.insertBefore(n.createTextNode(L),se.childNodes[0]||null),Pt===je?K.call(C,ut?"html":"body")[0]:ut?C.documentElement:se},ks=function(E){return A.call(E.ownerDocument||E,E,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Pi=function(E){return E instanceof p&&(typeof E.nodeName!="string"||typeof E.textContent!="string"||typeof E.removeChild!="function"||!(E.attributes instanceof c)||typeof E.removeAttribute!="function"||typeof E.setAttribute!="function"||typeof E.namespaceURI!="string"||typeof E.insertBefore!="function"||typeof E.hasChildNodes!="function")},Us=function(E){return typeof l=="function"&&E instanceof l};function qe(x,E,C){pn(x,L=>{L.call(t,E,C,Nt)})}const Fs=function(E){let C=null;if(qe(H.beforeSanitizeElements,E,null),Pi(E))return Fe(E),!0;const L=re(E.nodeName);if(qe(H.uponSanitizeElement,E,{tagName:L,allowedTags:ne}),E.hasChildNodes()&&!Us(E.firstElementChild)&&de(/<[/\w]/g,E.innerHTML)&&de(/<[/\w]/g,E.textContent)||E.nodeType===Vt.progressingInstruction||Ti&&E.nodeType===Vt.comment&&de(/<[/\w]/g,E.data))return Fe(E),!0;if(!ne[L]||tn[L]){if(!tn[L]&&Vs(L)&&(te.tagNameCheck instanceof RegExp&&de(te.tagNameCheck,L)||te.tagNameCheck instanceof Function&&te.tagNameCheck(L)))return!1;if(bi&&!Ot[L]){const Z=b(E)||E.parentNode,se=_(E)||E.childNodes;if(se&&Z){const oe=se.length;for(let Ee=oe-1;Ee>=0;--Ee){const ze=g(se[Ee],!0);ze.__removalCount=(E.__removalCount||0)+1,Z.insertBefore(ze,S(E))}}}return Fe(E),!0}return E instanceof a&&!wp(E)||(L==="noscript"||L==="noembed"||L==="noframes")&&de(/<\/no(script|embed|frames)/i,E.innerHTML)?(Fe(E),!0):(It&&E.nodeType===Vt.text&&(C=E.textContent,pn([ke,Ue,Ei],Z=>{C=Ut(C,Z," ")}),E.textContent!==C&&(kt(t.removed,{element:E.cloneNode()}),E.textContent=C)),qe(H.afterSanitizeElements,E,null),!1)},zs=function(E,C,L){if(As&&(C==="id"||C==="name")&&(L in n||L in Sp))return!1;if(!(yi&&!_i[C]&&de(hp,C))){if(!(ws&&de(pp,C))){if(!ie[C]||_i[C]){if(!(Vs(E)&&(te.tagNameCheck instanceof RegExp&&de(te.tagNameCheck,E)||te.tagNameCheck instanceof Function&&te.tagNameCheck(E))&&(te.attributeNameCheck instanceof RegExp&&de(te.attributeNameCheck,C)||te.attributeNameCheck instanceof Function&&te.attributeNameCheck(C))||C==="is"&&te.allowCustomizedBuiltInElements&&(te.tagNameCheck instanceof RegExp&&de(te.tagNameCheck,L)||te.tagNameCheck instanceof Function&&te.tagNameCheck(L))))return!1}else if(!Ii[C]){if(!de(ys,Ut(L,_s,""))){if(!((C==="src"||C==="xlink:href"||C==="href")&&E!=="script"&&_l(L,"data:")===0&&Ps[E])){if(!(bs&&!de(gp,Ut(L,_s,"")))){if(L)return!1}}}}}}return!0},Vs=function(E){return E!=="annotation-xml"&&Zi(E,mp)},Hs=function(E){qe(H.beforeSanitizeAttributes,E,null);const{attributes:C}=E;if(!C||Pi(E))return;const L={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ie,forceKeepAttr:void 0};let Z=C.length;for(;Z--;){const se=C[Z],{name:oe,namespaceURI:Ee,value:ze}=se,on=re(oe);let pe=oe==="value"?ze:yl(ze);if(L.attrName=on,L.attrValue=pe,L.keepAttr=!0,L.forceKeepAttr=void 0,qe(H.uponSanitizeAttribute,E,L),pe=L.attrValue,Cs&&(on==="id"||on==="name")&&($n(oe,E),pe=vp+pe),Ti&&de(/((--!?|])>)|<\/(style|title)/i,pe)){$n(oe,E);continue}if(L.forceKeepAttr||($n(oe,E),!L.keepAttr))continue;if(!Is&&de(/\/>/i,pe)){$n(oe,E);continue}It&&pn([ke,Ue,Ei],Gs=>{pe=Ut(pe,Gs," ")});const Bs=re(E.nodeName);if(zs(Bs,on,pe)){if(m&&typeof h=="object"&&typeof h.getAttributeType=="function"&&!Ee)switch(h.getAttributeType(Bs,on)){case"TrustedHTML":{pe=m.createHTML(pe);break}case"TrustedScriptURL":{pe=m.createScriptURL(pe);break}}try{Ee?E.setAttributeNS(Ee,oe,pe):E.setAttribute(oe,pe),Pi(E)?Fe(E):Ki(t.removed)}catch(Gs){}}}qe(H.afterSanitizeAttributes,E,null)},bp=function x(E){let C=null;const L=ks(E);for(qe(H.beforeSanitizeShadowDOM,E,null);C=L.nextNode();)qe(H.uponSanitizeShadowNode,C,null),Fs(C),Hs(C),C.content instanceof o&&x(C.content);qe(H.afterSanitizeShadowDOM,E,null)};return t.sanitize=function(x){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},C=null,L=null,Z=null,se=null;if(Ai=!x,Ai&&(x="<!-->"),typeof x!="string"&&!Us(x))if(typeof x.toString=="function"){if(x=x.toString(),typeof x!="string")throw Ft("dirty is not a string, aborting")}else throw Ft("toString is not a function");if(!t.isSupported)return x;if(Si||Oi(E),t.removed=[],typeof x=="string"&&(nn=!1),nn){if(x.nodeName){const ze=re(x.nodeName);if(!ne[ze]||tn[ze])throw Ft("root node is forbidden and cannot be sanitized in-place")}}else if(x instanceof l)C=xs("<!---->"),L=C.ownerDocument.importNode(x,!0),L.nodeType===Vt.element&&L.nodeName==="BODY"||L.nodeName==="HTML"?C=L:C.appendChild(L);else{if(!At&&!It&&!ut&&x.indexOf("<")===-1)return m&&zn?m.createHTML(x):x;if(C=xs(x),!C)return At?null:zn?T:""}C&&wi&&Fe(C.firstChild);const oe=ks(nn?x:C);for(;Z=oe.nextNode();)Fs(Z),Hs(Z),Z.content instanceof o&&bp(Z.content);if(nn)return x;if(At){if(Fn)for(se=U.call(C.ownerDocument);C.firstChild;)se.appendChild(C.firstChild);else se=C;return(ie.shadowroot||ie.shadowrootmode)&&(se=G.call(r,se,!0)),se}let Ee=ut?C.outerHTML:C.innerHTML;return ut&&ne["!doctype"]&&C.ownerDocument&&C.ownerDocument.doctype&&C.ownerDocument.doctype.name&&de(no,C.ownerDocument.doctype.name)&&(Ee="<!DOCTYPE "+C.ownerDocument.doctype.name+`>
`+Ee),It&&pn([ke,Ue,Ei],ze=>{Ee=Ut(Ee,ze," ")}),m&&zn?m.createHTML(Ee):Ee},t.setConfig=function(){let x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Oi(x),Si=!0},t.clearConfig=function(){Nt=null,Si=!1},t.isValidAttribute=function(x,E,C){Nt||Oi({});const L=re(x),Z=re(E);return zs(L,Z,C)},t.addHook=function(x,E){typeof E=="function"&&kt(H[x],E)},t.removeHook=function(x,E){if(E!==void 0){const C=vl(H[x],E);return C===-1?void 0:El(H[x],C,1)[0]}return Ki(H[x])},t.removeHooks=function(x){H[x]=[]},t.removeAllHooks=function(){H=io()},t}var xl=oo();class kl{sanitizeString(t){if(!w(t))return"";try{return xl.sanitize(t)}catch(n){return y.log.error("could not verify that content was safe",n),""}}sanitizeObject(t){const n=F(t);if(!N(t)&&!n)if(w(t))try{return this.sanitizeString(String(t))}catch(r){return y.log.error("could not verify that content was safe",r),""}else return t;if(n)return this.sanitizeArray(t);for(const r in t)N(t[r])?t[r]=this.sanitizeObject(t[r]):F(t[r])?t[r]=this.sanitizeArray(t[r]):ae(t,r)&&(t[r]=this.sanitizeObject(t[r]));return t}sanitizeArray(t){if(!F(t))return[];for(let n=0;n<t.length;n++)t[n]=this.sanitizeObject(t[n]);return t}}const gt="data-sf-personalization-",Le=`${gt}id`,tt="view",mt=`${gt}${tt}`,Re="click",vt=`${gt}${Re}`,Ul=[tt,Re],Et="destination",_t="object-id",yt="content-id",vn="interaction-name",En="event-type",lr="type",Fl=[yt,_t,Et,vn,En,lr],ao="Product",so="Other",lo=[ao,so];var nt=(e=>(e.TransformerConfig="TransformerConfig",e.Element="Element",e.Any="Any",e))(nt||{}),_n=(e=>(e.SchemaPath="SchemaPath",e))(_n||{});class zl{add(t,n,r){if(typeof arguments[0]!="string")for(let i in arguments[0])this.add(i,arguments[0][i],arguments[1]);else(Array.isArray(t)?t:[t]).forEach(function(i){this[i]=this[i]||[],n&&this[i][r?"unshift":"push"](n)},this)}run(t,n){this[t]=this[t]||[],this[t].forEach(function(r){r.call(n&&n.context?n.context:n,n)})}}class Vl{constructor(t){this.jsep=t,this.registered={}}register(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(i=>{if(typeof i!="object"||!i.name||!i.init)throw new Error("Invalid JSEP plugin format");this.registered[i.name]||(i.init(this.jsep),this.registered[i.name]=i)})}}class I{static get version(){return"1.4.0"}static toString(){return"JavaScript Expression Parser (JSEP) v"+I.version}static addUnaryOp(t){return I.max_unop_len=Math.max(t.length,I.max_unop_len),I.unary_ops[t]=1,I}static addBinaryOp(t,n,r){return I.max_binop_len=Math.max(t.length,I.max_binop_len),I.binary_ops[t]=n,r?I.right_associative.add(t):I.right_associative.delete(t),I}static addIdentifierChar(t){return I.additional_identifier_chars.add(t),I}static addLiteral(t,n){return I.literals[t]=n,I}static removeUnaryOp(t){return delete I.unary_ops[t],t.length===I.max_unop_len&&(I.max_unop_len=I.getMaxKeyLen(I.unary_ops)),I}static removeAllUnaryOps(){return I.unary_ops={},I.max_unop_len=0,I}static removeIdentifierChar(t){return I.additional_identifier_chars.delete(t),I}static removeBinaryOp(t){return delete I.binary_ops[t],t.length===I.max_binop_len&&(I.max_binop_len=I.getMaxKeyLen(I.binary_ops)),I.right_associative.delete(t),I}static removeAllBinaryOps(){return I.binary_ops={},I.max_binop_len=0,I}static removeLiteral(t){return delete I.literals[t],I}static removeAllLiterals(){return I.literals={},I}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(t){this.expr=t,this.index=0}static parse(t){return new I(t).parse()}static getMaxKeyLen(t){return Math.max(0,...Object.keys(t).map(n=>n.length))}static isDecimalDigit(t){return t>=48&&t<=57}static binaryPrecedence(t){return I.binary_ops[t]||0}static isIdentifierStart(t){return t>=65&&t<=90||t>=97&&t<=122||t>=128&&!I.binary_ops[String.fromCharCode(t)]||I.additional_identifier_chars.has(String.fromCharCode(t))}static isIdentifierPart(t){return I.isIdentifierStart(t)||I.isDecimalDigit(t)}throwError(t){const n=new Error(t+" at character "+this.index);throw n.index=this.index,n.description=t,n}runHook(t,n){if(I.hooks[t]){const r={context:this,node:n};return I.hooks.run(t,r),r.node}return n}searchHook(t){if(I.hooks[t]){const n={context:this};return I.hooks[t].find(function(r){return r.call(n.context,n),n.node}),n.node}}gobbleSpaces(){let t=this.code;for(;t===I.SPACE_CODE||t===I.TAB_CODE||t===I.LF_CODE||t===I.CR_CODE;)t=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");const t=this.gobbleExpressions(),n=t.length===1?t[0]:{type:I.COMPOUND,body:t};return this.runHook("after-all",n)}gobbleExpressions(t){let n=[],r,i;for(;this.index<this.expr.length;)if(r=this.code,r===I.SEMCOL_CODE||r===I.COMMA_CODE)this.index++;else if(i=this.gobbleExpression())n.push(i);else if(this.index<this.expr.length){if(r===t)break;this.throwError('Unexpected "'+this.char+'"')}return n}gobbleExpression(){const t=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",t)}gobbleBinaryOp(){this.gobbleSpaces();let t=this.expr.substr(this.index,I.max_binop_len),n=t.length;for(;n>0;){if(I.binary_ops.hasOwnProperty(t)&&(!I.isIdentifierStart(this.code)||this.index+t.length<this.expr.length&&!I.isIdentifierPart(this.expr.charCodeAt(this.index+t.length))))return this.index+=n,t;t=t.substr(0,--n)}return!1}gobbleBinaryExpression(){let t,n,r,i,o,s,l,a,u;if(s=this.gobbleToken(),!s||(n=this.gobbleBinaryOp(),!n))return s;for(o={value:n,prec:I.binaryPrecedence(n),right_a:I.right_associative.has(n)},l=this.gobbleToken(),l||this.throwError("Expected expression after "+n),i=[s,o,l];n=this.gobbleBinaryOp();){if(r=I.binaryPrecedence(n),r===0){this.index-=n.length;break}o={value:n,prec:r,right_a:I.right_associative.has(n)},u=n;const c=p=>o.right_a&&p.right_a?r>p.prec:r<=p.prec;for(;i.length>2&&c(i[i.length-2]);)l=i.pop(),n=i.pop().value,s=i.pop(),t={type:I.BINARY_EXP,operator:n,left:s,right:l},i.push(t);t=this.gobbleToken(),t||this.throwError("Expected expression after "+u),i.push(o,t)}for(a=i.length-1,t=i[a];a>1;)t={type:I.BINARY_EXP,operator:i[a-1].value,left:i[a-2],right:t},a-=2;return t}gobbleToken(){let t,n,r,i;if(this.gobbleSpaces(),i=this.searchHook("gobble-token"),i)return this.runHook("after-token",i);if(t=this.code,I.isDecimalDigit(t)||t===I.PERIOD_CODE)return this.gobbleNumericLiteral();if(t===I.SQUOTE_CODE||t===I.DQUOTE_CODE)i=this.gobbleStringLiteral();else if(t===I.OBRACK_CODE)i=this.gobbleArray();else{for(n=this.expr.substr(this.index,I.max_unop_len),r=n.length;r>0;){if(I.unary_ops.hasOwnProperty(n)&&(!I.isIdentifierStart(this.code)||this.index+n.length<this.expr.length&&!I.isIdentifierPart(this.expr.charCodeAt(this.index+n.length)))){this.index+=r;const o=this.gobbleToken();return o||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:I.UNARY_EXP,operator:n,argument:o,prefix:!0})}n=n.substr(0,--r)}I.isIdentifierStart(t)?(i=this.gobbleIdentifier(),I.literals.hasOwnProperty(i.name)?i={type:I.LITERAL,value:I.literals[i.name],raw:i.name}:i.name===I.this_str&&(i={type:I.THIS_EXP})):t===I.OPAREN_CODE&&(i=this.gobbleGroup())}return i?(i=this.gobbleTokenProperty(i),this.runHook("after-token",i)):this.runHook("after-token",!1)}gobbleTokenProperty(t){this.gobbleSpaces();let n=this.code;for(;n===I.PERIOD_CODE||n===I.OBRACK_CODE||n===I.OPAREN_CODE||n===I.QUMARK_CODE;){let r;if(n===I.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==I.PERIOD_CODE)break;r=!0,this.index+=2,this.gobbleSpaces(),n=this.code}this.index++,n===I.OBRACK_CODE?(t={type:I.MEMBER_EXP,computed:!0,object:t,property:this.gobbleExpression()},t.property||this.throwError('Unexpected "'+this.char+'"'),this.gobbleSpaces(),n=this.code,n!==I.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):n===I.OPAREN_CODE?t={type:I.CALL_EXP,arguments:this.gobbleArguments(I.CPAREN_CODE),callee:t}:(n===I.PERIOD_CODE||r)&&(r&&this.index--,this.gobbleSpaces(),t={type:I.MEMBER_EXP,computed:!1,object:t,property:this.gobbleIdentifier()}),r&&(t.optional=!0),this.gobbleSpaces(),n=this.code}return t}gobbleNumericLiteral(){let t="",n,r;for(;I.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(this.code===I.PERIOD_CODE)for(t+=this.expr.charAt(this.index++);I.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);if(n=this.char,n==="e"||n==="E"){for(t+=this.expr.charAt(this.index++),n=this.char,(n==="+"||n==="-")&&(t+=this.expr.charAt(this.index++));I.isDecimalDigit(this.code);)t+=this.expr.charAt(this.index++);I.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+t+this.char+")")}return r=this.code,I.isIdentifierStart(r)?this.throwError("Variable names cannot start with a number ("+t+this.char+")"):(r===I.PERIOD_CODE||t.length===1&&t.charCodeAt(0)===I.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:I.LITERAL,value:parseFloat(t),raw:t}}gobbleStringLiteral(){let t="";const n=this.index,r=this.expr.charAt(this.index++);let i=!1;for(;this.index<this.expr.length;){let o=this.expr.charAt(this.index++);if(o===r){i=!0;break}else if(o==="\\")switch(o=this.expr.charAt(this.index++),o){case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:t+=o}else t+=o}return i||this.throwError('Unclosed quote after "'+t+'"'),{type:I.LITERAL,value:t,raw:this.expr.substring(n,this.index)}}gobbleIdentifier(){let t=this.code,n=this.index;for(I.isIdentifierStart(t)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(t=this.code,I.isIdentifierPart(t));)this.index++;return{type:I.IDENTIFIER,name:this.expr.slice(n,this.index)}}gobbleArguments(t){const n=[];let r=!1,i=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let o=this.code;if(o===t){r=!0,this.index++,t===I.CPAREN_CODE&&i&&i>=n.length&&this.throwError("Unexpected token "+String.fromCharCode(t));break}else if(o===I.COMMA_CODE){if(this.index++,i++,i!==n.length){if(t===I.CPAREN_CODE)this.throwError("Unexpected token ,");else if(t===I.CBRACK_CODE)for(let s=n.length;s<i;s++)n.push(null)}}else if(n.length!==i&&i!==0)this.throwError("Expected comma");else{const s=this.gobbleExpression();(!s||s.type===I.COMPOUND)&&this.throwError("Expected comma"),n.push(s)}}return r||this.throwError("Expected "+String.fromCharCode(t)),n}gobbleGroup(){this.index++;let t=this.gobbleExpressions(I.CPAREN_CODE);if(this.code===I.CPAREN_CODE)return this.index++,t.length===1?t[0]:t.length?{type:I.SEQUENCE_EXP,expressions:t}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:I.ARRAY_EXP,elements:this.gobbleArguments(I.CBRACK_CODE)}}}const Hl=new zl;Object.assign(I,{hooks:Hl,plugins:new Vl(I),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"??":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10,"**":11},right_associative:new Set(["**"]),additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"}),I.max_unop_len=I.getMaxKeyLen(I.unary_ops),I.max_binop_len=I.getMaxKeyLen(I.binary_ops);const He=e=>new I(e).parse(),Bl=Object.getOwnPropertyNames(class{});Object.getOwnPropertyNames(I).filter(e=>!Bl.includes(e)&&He[e]===void 0).forEach(e=>{He[e]=I[e]}),He.Jsep=I;const Gl="ConditionalExpression";var $l={name:"ternary",init(e){e.hooks.add("after-expression",function(n){if(n.node&&this.code===e.QUMARK_CODE){this.index++;const r=n.node,i=this.gobbleExpression();if(i||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===e.COLON_CODE){this.index++;const o=this.gobbleExpression();if(o||this.throwError("Expected expression"),n.node={type:Gl,test:r,consequent:i,alternate:o},r.operator&&e.binary_ops[r.operator]<=.9){let s=r;for(;s.right.operator&&e.binary_ops[s.right.operator]<=.9;)s=s.right;n.node.test=s.right,s.right=n.node,n.node=r}}else this.throwError("Expected :")}})}};He.plugins.register($l);const uo=47,Wl=92;var jl={name:"regex",init(e){e.hooks.add("gobble-token",function(n){if(this.code===uo){const r=++this.index;let i=!1;for(;this.index<this.expr.length;){if(this.code===uo&&!i){const o=this.expr.slice(r,this.index);let s="";for(;++this.index<this.expr.length;){const a=this.code;if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57)s+=this.char;else break}let l;try{l=new RegExp(o,s)}catch(a){this.throwError(a.message)}return n.node={type:e.LITERAL,value:l,raw:this.expr.slice(r-1,this.index)},n.node=this.gobbleTokenProperty(n.node),n.node}this.code===e.OBRACK_CODE?i=!0:i&&this.code===e.CBRACK_CODE&&(i=!1),this.index+=this.code===Wl?2:1}this.throwError("Unclosed Regex")}})}};const ur=43,Tt={name:"assignment",assignmentOperators:new Set(["=","*=","**=","/=","%=","+=","-=","<<=",">>=",">>>=","&=","^=","|=","||=","&&=","??="]),updateOperators:[ur,45],assignmentPrecedence:.9,init(e){const t=[e.IDENTIFIER,e.MEMBER_EXP];Tt.assignmentOperators.forEach(r=>e.addBinaryOp(r,Tt.assignmentPrecedence,!0)),e.hooks.add("gobble-token",function(i){const o=this.code;Tt.updateOperators.some(s=>s===o&&s===this.expr.charCodeAt(this.index+1))&&(this.index+=2,i.node={type:"UpdateExpression",operator:o===ur?"++":"--",argument:this.gobbleTokenProperty(this.gobbleIdentifier()),prefix:!0},(!i.node.argument||!t.includes(i.node.argument.type))&&this.throwError(`Unexpected ${i.node.operator}`))}),e.hooks.add("after-token",function(i){if(i.node){const o=this.code;Tt.updateOperators.some(s=>s===o&&s===this.expr.charCodeAt(this.index+1))&&(t.includes(i.node.type)||this.throwError(`Unexpected ${i.node.operator}`),this.index+=2,i.node={type:"UpdateExpression",operator:o===ur?"++":"--",argument:i.node,prefix:!1})}}),e.hooks.add("after-expression",function(i){i.node&&n(i.node)});function n(r){Tt.assignmentOperators.has(r.operator)?(r.type="AssignmentExpression",n(r.left),n(r.right)):r.operator||Object.values(r).forEach(i=>{i&&typeof i=="object"&&n(i)})}}};He.plugins.register(jl,Tt),He.addUnaryOp("typeof"),He.addLiteral("null",null),He.addLiteral("undefined",void 0);const ql=new Set(["constructor","__proto__","__defineGetter__","__defineSetter__"]),j={evalAst(e,t){switch(e.type){case"BinaryExpression":case"LogicalExpression":return j.evalBinaryExpression(e,t);case"Compound":return j.evalCompound(e,t);case"ConditionalExpression":return j.evalConditionalExpression(e,t);case"Identifier":return j.evalIdentifier(e,t);case"Literal":return j.evalLiteral(e,t);case"MemberExpression":return j.evalMemberExpression(e,t);case"UnaryExpression":return j.evalUnaryExpression(e,t);case"ArrayExpression":return j.evalArrayExpression(e,t);case"CallExpression":return j.evalCallExpression(e,t);case"AssignmentExpression":return j.evalAssignmentExpression(e,t);default:throw SyntaxError("Unexpected expression",e)}},evalBinaryExpression(e,t){return{"||":(r,i)=>r||i(),"&&":(r,i)=>r&&i(),"|":(r,i)=>r|i(),"^":(r,i)=>r^i(),"&":(r,i)=>r&i(),"==":(r,i)=>r==i(),"!=":(r,i)=>r!=i(),"===":(r,i)=>r===i(),"!==":(r,i)=>r!==i(),"<":(r,i)=>r<i(),">":(r,i)=>r>i(),"<=":(r,i)=>r<=i(),">=":(r,i)=>r>=i(),"<<":(r,i)=>r<<i(),">>":(r,i)=>r>>i(),">>>":(r,i)=>r>>>i(),"+":(r,i)=>r+i(),"-":(r,i)=>r-i(),"*":(r,i)=>r*i(),"/":(r,i)=>r/i(),"%":(r,i)=>r%i()}[e.operator](j.evalAst(e.left,t),()=>j.evalAst(e.right,t))},evalCompound(e,t){let n;for(let r=0;r<e.body.length;r++){e.body[r].type==="Identifier"&&["var","let","const"].includes(e.body[r].name)&&e.body[r+1]&&e.body[r+1].type==="AssignmentExpression"&&(r+=1);const i=e.body[r];n=j.evalAst(i,t)}return n},evalConditionalExpression(e,t){return j.evalAst(e.test,t)?j.evalAst(e.consequent,t):j.evalAst(e.alternate,t)},evalIdentifier(e,t){if(Object.hasOwn(t,e.name))return t[e.name];throw ReferenceError(`${e.name} is not defined`)},evalLiteral(e){return e.value},evalMemberExpression(e,t){const n=String(e.computed?j.evalAst(e.property):e.property.name),r=j.evalAst(e.object,t);if(r==null)throw TypeError(`Cannot read properties of ${r} (reading '${n}')`);if(!Object.hasOwn(r,n)&&ql.has(n))throw TypeError(`Cannot read properties of ${r} (reading '${n}')`);const i=r[n];return typeof i=="function"?i.bind(r):i},evalUnaryExpression(e,t){return{"-":r=>-j.evalAst(r,t),"!":r=>!j.evalAst(r,t),"~":r=>~j.evalAst(r,t),"+":r=>+j.evalAst(r,t),typeof:r=>typeof j.evalAst(r,t)}[e.operator](e.argument)},evalArrayExpression(e,t){return e.elements.map(n=>j.evalAst(n,t))},evalCallExpression(e,t){const n=e.arguments.map(i=>j.evalAst(i,t));return j.evalAst(e.callee,t)(...n)},evalAssignmentExpression(e,t){if(e.left.type!=="Identifier")throw SyntaxError("Invalid left-hand side in assignment");const n=e.left.name,r=j.evalAst(e.right,t);return t[n]=r,t[n]}};class Yl{constructor(t){this.code=t,this.ast=He(this.code)}runInNewContext(t){const n=Object.assign(Object.create(null),t);return j.evalAst(this.ast,n)}}function Ze(e,t){return e=e.slice(),e.push(t),e}function cr(e,t){return t=t.slice(),t.unshift(e),t}class Kl extends Error{constructor(t){super('JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)'),this.avoidNew=!0,this.value=t,this.name="NewError"}}function B(e,t,n,r,i){if(!(this instanceof B))try{return new B(e,t,n,r,i)}catch(s){if(!s.avoidNew)throw s;return s.value}typeof e=="string"&&(i=r,r=n,n=t,t=e,e=null);const o=e&&typeof e=="object";if(e=e||{},this.json=e.json||n,this.path=e.path||t,this.resultType=e.resultType||"value",this.flatten=e.flatten||!1,this.wrap=Object.hasOwn(e,"wrap")?e.wrap:!0,this.sandbox=e.sandbox||{},this.eval=e.eval===void 0?"safe":e.eval,this.ignoreEvalErrors=typeof e.ignoreEvalErrors=="undefined"?!1:e.ignoreEvalErrors,this.parent=e.parent||null,this.parentProperty=e.parentProperty||null,this.callback=e.callback||r||null,this.otherTypeCallback=e.otherTypeCallback||i||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},e.autostart!==!1){const s={path:o?e.path:t};o?"json"in e&&(s.json=e.json):s.json=n;const l=this.evaluate(s);if(!l||typeof l!="object")throw new Kl(l);return l}}B.prototype.evaluate=function(e,t,n,r){let i=this.parent,o=this.parentProperty,{flatten:s,wrap:l}=this;if(this.currResultType=this.resultType,this.currEval=this.eval,this.currSandbox=this.sandbox,n=n||this.callback,this.currOtherTypeCallback=r||this.otherTypeCallback,t=t||this.json,e=e||this.path,e&&typeof e=="object"&&!Array.isArray(e)){if(!e.path&&e.path!=="")throw new TypeError('You must supply a "path" property when providing an object argument to JSONPath.evaluate().');if(!Object.hasOwn(e,"json"))throw new TypeError('You must supply a "json" property when providing an object argument to JSONPath.evaluate().');({json:t}=e),s=Object.hasOwn(e,"flatten")?e.flatten:s,this.currResultType=Object.hasOwn(e,"resultType")?e.resultType:this.currResultType,this.currSandbox=Object.hasOwn(e,"sandbox")?e.sandbox:this.currSandbox,l=Object.hasOwn(e,"wrap")?e.wrap:l,this.currEval=Object.hasOwn(e,"eval")?e.eval:this.currEval,n=Object.hasOwn(e,"callback")?e.callback:n,this.currOtherTypeCallback=Object.hasOwn(e,"otherTypeCallback")?e.otherTypeCallback:this.currOtherTypeCallback,i=Object.hasOwn(e,"parent")?e.parent:i,o=Object.hasOwn(e,"parentProperty")?e.parentProperty:o,e=e.path}if(i=i||null,o=o||null,Array.isArray(e)&&(e=B.toPathString(e)),!e&&e!==""||!t)return;const a=B.toPathArray(e);a[0]==="$"&&a.length>1&&a.shift(),this._hasParentSelector=null;const u=this._trace(a,t,["$"],i,o,n).filter(function(c){return c&&!c.isParentSelector});return u.length?!l&&u.length===1&&!u[0].hasArrExpr?this._getPreferredOutput(u[0]):u.reduce((c,p)=>{const f=this._getPreferredOutput(p);return s&&Array.isArray(f)?c=c.concat(f):c.push(f),c},[]):l?[]:void 0},B.prototype._getPreferredOutput=function(e){const t=this.currResultType;switch(t){case"all":{const n=Array.isArray(e.path)?e.path:B.toPathArray(e.path);return e.pointer=B.toPointer(n),e.path=typeof e.path=="string"?e.path:B.toPathString(e.path),e}case"value":case"parent":case"parentProperty":return e[t];case"path":return B.toPathString(e[t]);case"pointer":return B.toPointer(e.path);default:throw new TypeError("Unknown result type")}},B.prototype._handleCallback=function(e,t,n){if(t){const r=this._getPreferredOutput(e);e.path=typeof e.path=="string"?e.path:B.toPathString(e.path),t(r,n,e)}},B.prototype._trace=function(e,t,n,r,i,o,s,l){let a;if(!e.length)return a={path:n,value:t,parent:r,parentProperty:i,hasArrExpr:s},this._handleCallback(a,o,"value"),a;const u=e[0],c=e.slice(1),p=[];function f(h){Array.isArray(h)?h.forEach(d=>{p.push(d)}):p.push(h)}if((typeof u!="string"||l)&&t&&Object.hasOwn(t,u))f(this._trace(c,t[u],Ze(n,u),t,u,o,s));else if(u==="*")this._walk(t,h=>{f(this._trace(c,t[h],Ze(n,h),t,h,o,!0,!0))});else if(u==="..")f(this._trace(c,t,n,r,i,o,s)),this._walk(t,h=>{typeof t[h]=="object"&&f(this._trace(e.slice(),t[h],Ze(n,h),t,h,o,!0))});else{if(u==="^")return this._hasParentSelector=!0,{path:n.slice(0,-1),expr:c,isParentSelector:!0};if(u==="~")return a={path:Ze(n,u),value:i,parent:r,parentProperty:null},this._handleCallback(a,o,"property"),a;if(u==="$")f(this._trace(c,t,n,null,null,o,s));else if(/^(-?\d*):(-?\d*):?(\d*)$/u.test(u))f(this._slice(u,c,t,n,r,i,o));else if(u.indexOf("?(")===0){if(this.currEval===!1)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");const h=u.replace(/^\?\((.*?)\)$/u,"$1"),d=/@.?([^?]*)[['](\??\(.*?\))(?!.\)\])[\]']/gu.exec(h);d?this._walk(t,g=>{const v=[d[2]],S=d[1]?t[g][d[1]]:t[g];this._trace(v,S,n,r,i,o,!0).length>0&&f(this._trace(c,t[g],Ze(n,g),t,g,o,!0))}):this._walk(t,g=>{this._eval(h,t[g],g,n,r,i)&&f(this._trace(c,t[g],Ze(n,g),t,g,o,!0))})}else if(u[0]==="("){if(this.currEval===!1)throw new Error("Eval [(expr)] prevented in JSONPath expression.");f(this._trace(cr(this._eval(u,t,n.at(-1),n.slice(0,-1),r,i),c),t,n,r,i,o,s))}else if(u[0]==="@"){let h=!1;const d=u.slice(1,-2);switch(d){case"scalar":(!t||!["object","function"].includes(typeof t))&&(h=!0);break;case"boolean":case"string":case"undefined":case"function":typeof t===d&&(h=!0);break;case"integer":Number.isFinite(t)&&!(t%1)&&(h=!0);break;case"number":Number.isFinite(t)&&(h=!0);break;case"nonFinite":typeof t=="number"&&!Number.isFinite(t)&&(h=!0);break;case"object":t&&typeof t===d&&(h=!0);break;case"array":Array.isArray(t)&&(h=!0);break;case"other":h=this.currOtherTypeCallback(t,n,r,i);break;case"null":t===null&&(h=!0);break;default:throw new TypeError("Unknown value type "+d)}if(h)return a={path:n,value:t,parent:r,parentProperty:i},this._handleCallback(a,o,"value"),a}else if(u[0]==="`"&&t&&Object.hasOwn(t,u.slice(1))){const h=u.slice(1);f(this._trace(c,t[h],Ze(n,h),t,h,o,s,!0))}else if(u.includes(",")){const h=u.split(",");for(const d of h)f(this._trace(cr(d,c),t,n,r,i,o,!0))}else!l&&t&&Object.hasOwn(t,u)&&f(this._trace(c,t[u],Ze(n,u),t,u,o,s,!0))}if(this._hasParentSelector)for(let h=0;h<p.length;h++){const d=p[h];if(d&&d.isParentSelector){const g=this._trace(d.expr,t,d.path,r,i,o,s);if(Array.isArray(g)){p[h]=g[0];const v=g.length;for(let S=1;S<v;S++)h++,p.splice(h,0,g[S])}else p[h]=g}}return p},B.prototype._walk=function(e,t){if(Array.isArray(e)){const n=e.length;for(let r=0;r<n;r++)t(r)}else e&&typeof e=="object"&&Object.keys(e).forEach(n=>{t(n)})},B.prototype._slice=function(e,t,n,r,i,o,s){if(!Array.isArray(n))return;const l=n.length,a=e.split(":"),u=a[2]&&Number.parseInt(a[2])||1;let c=a[0]&&Number.parseInt(a[0])||0,p=a[1]&&Number.parseInt(a[1])||l;c=c<0?Math.max(0,c+l):Math.min(l,c),p=p<0?Math.max(0,p+l):Math.min(l,p);const f=[];for(let h=c;h<p;h+=u)this._trace(cr(h,t),n,r,i,o,s,!0).forEach(g=>{f.push(g)});return f},B.prototype._eval=function(e,t,n,r,i,o){this.currSandbox._$_parentProperty=o,this.currSandbox._$_parent=i,this.currSandbox._$_property=n,this.currSandbox._$_root=this.json,this.currSandbox._$_v=t;const s=e.includes("@path");s&&(this.currSandbox._$_path=B.toPathString(r.concat([n])));const l=this.currEval+"Script:"+e;if(!B.cache[l]){let a=e.replaceAll("@parentProperty","_$_parentProperty").replaceAll("@parent","_$_parent").replaceAll("@property","_$_property").replaceAll("@root","_$_root").replaceAll(/@([.\s)[])/gu,"_$_v$1");if(s&&(a=a.replaceAll("@path","_$_path")),this.currEval==="safe"||this.currEval===!0||this.currEval===void 0)B.cache[l]=new this.safeVm.Script(a);else if(this.currEval==="native")B.cache[l]=new this.vm.Script(a);else if(typeof this.currEval=="function"&&this.currEval.prototype&&Object.hasOwn(this.currEval.prototype,"runInNewContext")){const u=this.currEval;B.cache[l]=new u(a)}else if(typeof this.currEval=="function")B.cache[l]={runInNewContext:u=>this.currEval(a,u)};else throw new TypeError(`Unknown "eval" property "${this.currEval}"`)}try{return B.cache[l].runInNewContext(this.currSandbox)}catch(a){if(this.ignoreEvalErrors)return!1;throw new Error("jsonPath: "+a.message+": "+e)}},B.cache={},B.toPathString=function(e){const t=e,n=t.length;let r="$";for(let i=1;i<n;i++)/^(~|\^|@.*?\(\))$/u.test(t[i])||(r+=/^[0-9*]+$/u.test(t[i])?"["+t[i]+"]":"['"+t[i]+"']");return r},B.toPointer=function(e){const t=e,n=t.length;let r="";for(let i=1;i<n;i++)/^(~|\^|@.*?\(\))$/u.test(t[i])||(r+="/"+t[i].toString().replaceAll("~","~0").replaceAll("/","~1"));return r},B.toPathArray=function(e){const{cache:t}=B;if(t[e])return t[e].concat();const n=[],i=e.replaceAll(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\(\)/gu,";$&;").replaceAll(/[['](\??\(.*?\))[\]'](?!.\])/gu,function(o,s){return"[#"+(n.push(s)-1)+"]"}).replaceAll(/\[['"]([^'\]]*)['"]\]/gu,function(o,s){return"['"+s.replaceAll(".","%@%").replaceAll("~","%%@@%%")+"']"}).replaceAll("~",";~;").replaceAll(/['"]?\.['"]?(?![^[]*\])|\[['"]?/gu,";").replaceAll("%@%",".").replaceAll("%%@@%%","~").replaceAll(/(?:;)?(\^+)(?:;)?/gu,function(o,s){return";"+s.split("").join(";")+";"}).replaceAll(/;;;|;;/gu,";..;").replaceAll(/;$|'?\]|'$/gu,"").split(";").map(function(o){const s=o.match(/#(\d+)/u);return!s||!s[1]?o:n[s[1]]});return t[e]=i,t[e].concat()},B.prototype.safeVm={Script:Yl};const Zl=function(e,t,n){const r=e.length;for(let i=0;i<r;i++){const o=e[i];n(o)&&t.push(e.splice(i--,1)[0])}};class Xl{constructor(t){this.code=t}runInNewContext(t){let n=this.code;const r=Object.keys(t),i=[];Zl(r,i,u=>typeof t[u]=="function");const o=r.map(u=>t[u]);n=i.reduce((u,c)=>{let p=t[c].toString();return/function/u.test(p)||(p="function "+p),"var "+c+"="+p+";"+u},"")+n,!/(['"])use strict\1/u.test(n)&&!r.includes("arguments")&&(n="var arguments = undefined;"+n),n=n.replace(/;\s*$/u,"");const l=n.lastIndexOf(";"),a=l!==-1?n.slice(0,l+1)+" return "+n.slice(l+1):" return "+n;return new Function(...r,a)(...o)}}B.prototype.vm={Script:Xl};var Ql=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});const co=class Wn{validateTransformerDetails(t){}validateMethod(t){}validateSubstitutionValues(t){}setContent(t,n,r,i,o,s=q.ReplaceElementContent){const l=`pec ${i.pec.name}, transformation ${r.transformerName}, personalizationId ${o}`;i.status.update(new k(`Awaiting element/conditions ${l}`));const a=t.then(u=>{if(!(u instanceof Element))throw new ue(_e.FoundNonElement,"Found non-Element");if(!R(i.revertStatus)){const c=`Aborting ${l}, revert has been called`;return y.log.info(c),i.status.update(new k(c)),p=>{p.update(new k(`Nothing to revert, since revert was requested before transformation, ${l}`))}}if(i.status.update(new k(`About to transform/render, element/conditions ready ${l}`)),pt(s)){const c=u.closest("body");if(R(c))throw new ue(_e.ElementsNotFound,"Could not add overlay, body not found");return this.insertAdjacentHtmlUnlessAlreadyPersonalized(c,"beforeend",n,l)}else{if(Je(r))return this.setInnerHtmlUnlessAlreadyPersonalized(u,n,l);if(Ke(r)){const c=s!=null?s:q.ReplaceElementContent;switch(c){case q.ReplaceElementContent:return this.setInnerHtmlUnlessAlreadyPersonalized(u,n,l);case q.AddAfterElement:return this.insertAdjacentHtmlUnlessAlreadyPersonalized(u,"afterend",n,l);case q.AddBeforeElement:return this.insertAdjacentHtmlUnlessAlreadyPersonalized(u,"beforebegin",n,l);default:throw new ue(_e.NotSupported,`method "${c}" is not supported for Element transformations`)}}else throw new ue(_e.NotSupported,"transformation is not of a known type")}});return a.catch(u=>{const c=new Error(`Could not set content for ${l}: ${Q(u).message}`);i.status.update(new k(c)),y.log.error(c.message)}),{promise:a.then(),revert:u=>Ql(this,null,function*(){u.update(new k("Awaiting transformPromise"));const c=a.then(p=>{p(u)},p=>{if(p instanceof ue){u.update(new k(`Nothing to revert, no transformation attempt, ${l}`));return}throw p});c.catch(p=>{const f=new Error(`Issue reverting ${l}: `+Q(p).message);y.log.error(f),u.update(new k(f))}),yield c})}}setInnerHtmlUnlessAlreadyPersonalized(t,n,r){if(t.children.length>0&&this.isElementAlreadyPersonalized(t.children[0]))throw new ue(_e.AlreadyPersonalized,`Aborting setting innerHTML, element ${t.localName} already personalized`);const i=n();y.log.trace(`Setting element ${t.localName}'s innerHTML to ${i}, ${r}`,t);const o=t.innerHTML;return t.innerHTML=i,s=>{let l=`Reverting, ${r}`;s.update(new k(l)),y.log.debug(l),t.innerHTML=o,l=`Reverted, ${r}`,s.update(new k(l)),y.log.debug(l)}}insertAdjacentHtmlUnlessAlreadyPersonalized(t,n,r,i){let o;switch(n){case"beforebegin":o=t.previousSibling;break;case"afterbegin":o=t.firstChild;break;case"beforeend":o=t.lastChild;break;case"afterend":o=t.nextSibling;break;default:throw new Error(`Unsupported insertAdjacentHTML position: ${String(n)}`)}if(o instanceof Element&&this.isElementAlreadyPersonalized(t))throw new ue(_e.AlreadyPersonalized,`Aborting inserting adjacent HTML, adjacent element ${o.localName} ${n} from ${t.localName} is already personalized`);const s=r();y.log.trace(`Inserting adjacent HTML ${n} element ${t.localName}'s with ${s}, ${i}`,t);const l=this.getHTMLElements(s);return this.insertAdjacentElements(t,n,l),a=>{let u=`Reverting, ${i}`;a.update(new k(u)),y.log.debug(u),l.forEach(c=>c.remove()),u=`Reverted, ${i}`,a.update(new k(u)),y.log.debug(u)}}isElementAlreadyPersonalized(t){return t.getAttributeNames().some(n=>n.startsWith(gt))}autoInjectDefaultRootAttributes(t,n,r,i=!0){const o=[];t.hasAttribute(Le)?y.log.debug(`Element already has root attribute "${Le}"`,t):(y.log.debug(`Adding root attribute "${Le}"="${n}" to element`,t),t.setAttribute(Le,n),o.push(()=>{t.removeAttribute(Le)}));const s={};w(r)&&(s[Et]=r);const l=JSON.stringify(s);return i&&(t.hasAttribute(mt)?y.log.debug(`Element already has root attribute "${mt}"`,t):(y.log.debug(`Adding root attribute "${mt}"="${l}" to element`,t),t.setAttribute(mt,l),o.push(()=>{t.removeAttribute(mt)}))),t.hasAttribute(vt)?y.log.debug(`Element already has attribute "${vt}"`,t):(y.log.debug(`Adding attribute "${vt}"="${l}" to element`,t),t.setAttribute(vt,l),o.push(()=>{t.removeAttribute(vt)})),a=>{o.forEach(u=>u==null?void 0:u(a))}}autoInjectDefaultItemAttributes(t,n,r,i=!0){const o=[];R(n)||(t.setAttribute(Le,n),o.push(()=>{t.removeAttribute(Le)}));const s=JSON.stringify(r);if(i){const a=this.assignMaybeOverrideAttribute(t,mt,s);o.push(a)}const l=this.assignMaybeOverrideAttribute(t,vt,s);return o.push(l),a=>{o.forEach(u=>u==null?void 0:u(a))}}assignMaybeOverrideAttribute(t,n,r){return t.hasAttribute(n)?y.log.debug(`Overwriting item attribute "${n}"="${r}" on element`,t):y.log.debug(`Adding item attribute "${n}"="${r}" to element`,t),t.setAttribute(n,r),()=>{t.removeAttribute(n)}}static findValueDefaultForContentId(t){var n,r,i;return(i=(r=(n=t.attributes)==null?void 0:n.eventModifiers)==null?void 0:r[yt])==null?void 0:i.valueDefault}static findValueDefaultForObjectId(t){var n,r,i;return(i=(r=(n=t.attributes)==null?void 0:n.eventModifiers)==null?void 0:r[_t])==null?void 0:i.valueDefault}buildModifiersIfItemRelated(t,n,r){if(!N(t))return;const i={},o=Wn.findValueDefaultForContentId(r);if(w(o)){const l=this.getSanitizedContentString(o,t);w(l)&&(i[yt]=l)}const s=Wn.findValueDefaultForObjectId(r);if(w(s)){const l=this.getSanitizedContentString(s,t);w(l)&&(i[_t]=l)}if(Object.keys(i).length!==0)return w(n)&&(i[Et]=n),i}getHTMLElements(t){const n=document.createElement("div");return n.innerHTML=t,Array.from(n.children)}getPathParentObject(t,n){if(!w(t))return;const r=B({path:`$.${t}`,json:n,wrap:!1,resultType:"parent"});return N(r)?r:void 0}getSanitizedContentString(t,n){const r=B({path:`$${t}`,json:n,wrap:!1});if(R(r))return;const i=String(r),o=Wn.sanitizer.sanitizeString(i);return y.log.debug(`sanitized data for dataPath ${t}: ${o}`),o}insertAdjacentElement(t,n,r){if(r==="beforeend")t.appendChild(n);else{if(t.parentNode===null)throw new Error("Unable to find parent element");r==="beforebegin"?t.parentNode.insertBefore(n,t):r==="afterbegin"?t.parentNode.insertBefore(n,t.firstChild):r==="afterend"&&t.parentNode.insertBefore(n,t.nextSibling)}}insertAdjacentElements(t,n,r){const i=[];if(n==="beforeend"||n==="afterend"?r.forEach(o=>{try{this.insertAdjacentElement(t,o,n)}catch(s){i.push(Q(s).message)}}):(n==="beforebegin"||n==="afterbegin")&&r.reverse().forEach(o=>{try{this.insertAdjacentElement(t,o,n)}catch(s){i.push(Q(s).message)}}),i.length>0)throw new Error(`Issues with insertAdjacentElements: ${JSON.stringify(i)}`)}};co.sanitizer=new kl;let fr=co;function yn(e,t,n){var r,i;if(!w(e,!0))throw new D(M.MissingTransformerName,"Transformer Name is required.");if(!N(n))throw new D(M.MissingEngagementConfig,"Engagement Configuration or Destinations are not defined.");const o=n.destinationDefaults;if(o===void 0)throw new D(M.MissingEngagementConfigDefaults,"Engagement Configuration Defaults are not defined.");let s=e!==""?(r=o.byName)==null?void 0:r[e]:void 0;if(w(s)||(s=(i=o.byType)==null?void 0:i[t],w(s)))return s;if(!w(o.global))throw new D(M.MissingEngagementConfigGlobalDefault,"Engagement Configuration Global Default is not defined.");return o.global}function fo(e,t,n,r){if(w(e))return e;try{return yn(t,n,r)}catch(i){return}}var Jl=Object.defineProperty,eu=Object.defineProperties,tu=Object.getOwnPropertyDescriptors,ho=Object.getOwnPropertySymbols,nu=Object.prototype.hasOwnProperty,ru=Object.prototype.propertyIsEnumerable,po=(e,t,n)=>t in e?Jl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,iu=(e,t)=>{for(var n in t||(t={}))nu.call(t,n)&&po(e,n,t[n]);if(ho)for(var n of ho(t))ru.call(t,n)&&po(e,n,t[n]);return e},ou=(e,t)=>eu(e,tu(t));let go=null;function au(e){var t;if(N(e)&&(ae(e,"anchorId")||ae(e,"anchorDmoName"))){const n=ou(iu({},ae(e,"anchorDmoName")&&{anchorDmoName:e.anchorDmoName}),{anchorId:(t=e.anchorId)!=null?t:""});return su(n),n.anchorId===null?null:n}else return go}function su(e){if(ae(e,"anchorDmoName")&&(!w(e.anchorDmoName)||!w(e.anchorId)))throw w(e.anchorId)?new me(le.AnchorDmoNameRequired,"Anchor Dmo Name must be a non-empty string when provided."):new me(le.AnchorIdRequiredWithDmoName,"Anchor Id cannot be null if Anchor Dmo Name is provided.");if(e.anchorId!==null&&!w(e.anchorId))throw new me(le.AnchorIdNullOrNotEmpty,"Anchor Id must be null or a non-empty string.")}document.addEventListener(O.CustomEvents.OnEventSend,e=>{var t,n,r;if(((r=(n=(t=e==null?void 0:e.detail)==null?void 0:t.actionEvent)==null?void 0:n.interaction)==null?void 0:r.name)===O.CatalogObjectInteractionName.ViewCatalogObject){const i=e.detail.actionEvent.interaction.catalogObject;N(i)&&w(i.id)&&w(i.type)&&mo({anchorId:i.id})}}),document.addEventListener(O.CustomEvents.OnInit,()=>{mo(null)});function mo(e){go=e}var vo=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});const Eo="TestMode";class lu{constructor(t,n){this.statuses=t,this.finished=Promise.allSettled(Object.values(t).map(r=>vo(this,null,function*(){return yield r.finished}))).then(r=>{const i=r.filter(o=>o.status==="rejected").map(o=>Q(o.reason).message);if(i.length>0)throw new Error(`Issue(s) with preview (see 'statuses' for more detail): ${JSON.stringify(i)}`)}),this.finished.catch(()=>{}),this.revert=()=>(R(this._revertResponse)&&(this._revertResponse=n()),this._revertResponse)}}class uu{constructor(t){this.statuses=t,this.finished=Promise.allSettled(Object.values(t).map(n=>vo(this,null,function*(){return yield n.finished}))).then(n=>{const r=n.filter(i=>i.status==="rejected").map(i=>Q(i.reason).message);if(r.length>0)throw new Error(`Issue(s) with revert (see 'statuses' for more detail): ${JSON.stringify(r)}`)}),this.finished.catch(()=>{})}}let Be=null;function cu(e){const t={};let n=!1;return w(e==null?void 0:e.pageType)?(t.pageType=e.pageType,n=!0):w(Be==null?void 0:Be.pageType)&&(t.pageType=Be==null?void 0:Be.pageType,n=!0),w(e==null?void 0:e.interaction)?(t.interaction=e.interaction,n=!0):w(Be==null?void 0:Be.interaction)&&(t.interaction=Be==null?void 0:Be.interaction,n=!0),n?t:null}function dr(e){Be=e}function fu(){document.addEventListener(y.CustomEvents.OnShutDown,()=>dr(null)),document.addEventListener(y.CustomEvents.OnInit,()=>dr(null)),document.addEventListener(y.CustomEvents.OnSettledSitemap,e=>{var t,n;((t=e==null?void 0:e.detail)==null?void 0:t.result)!==void 0&&du((n=e==null?void 0:e.detail)==null?void 0:n.result)})}function du(e){var t,n,r,i,o,s,l,a,u,c,p,f;const h={};let d=!1;const g=(i=(t=e==null?void 0:e.matchedConfig)==null?void 0:t.name)!=null?i:(r=(n=e==null?void 0:e.currentPage)==null?void 0:n.source)==null?void 0:r.pageType;w(g)&&(h.pageType=g,d=!0),w((s=(o=e==null?void 0:e.matchedConfig)==null?void 0:o.interaction)==null?void 0:s.name)?(h.interaction=(a=(l=e==null?void 0:e.matchedConfig)==null?void 0:l.interaction)==null?void 0:a.name,d=!0):w((c=(u=e==null?void 0:e.currentPage)==null?void 0:u.interaction)==null?void 0:c.name)&&(h.interaction=(f=(p=e==null?void 0:e.currentPage)==null?void 0:p.interaction)==null?void 0:f.name,d=!0),dr(d?h:null)}var hu=Object.defineProperty,_o=Object.getOwnPropertySymbols,pu=Object.prototype.hasOwnProperty,gu=Object.prototype.propertyIsEnumerable,yo=(e,t,n)=>t in e?hu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ht=(e,t)=>{for(var n in t||(t={}))pu.call(t,n)&&yo(e,n,t[n]);if(_o)for(var n of _o(t))gu.call(t,n)&&yo(e,n,t[n]);return e},hr=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});const pr=new nl("PreviewMeta");function To(e,t){return hr(this,null,function*(){let n=Qn();Bi(t==null?void 0:t.endpoint),R(t==null?void 0:t.endpoint)||(n=t.endpoint,O.log.debug(`Using specified endpoint of ${n} as endpoint for fetching personalization.`));const r={method:"POST",cache:"no-store",headers:{"Content-Type":"application/json",Accept:"application/json, text/javascript, */*; q=0.01"},body:JSON.stringify(e)};return wo(e)&&(r.credentials="include",r.mode="cors"),yield window.fetch(n,r).then(i=>hr(this,null,function*(){if(!i.ok){const o=yield i.text();throw new Ui(ki.PersonalizationFetchFailed,"Personalization fetch failed.",{context:{status:i.status,message:o}})}return yield i.json().then(o=>(wu(o),wo(e)&&o.personalizations.forEach(s=>{Su({personalizationId:s.personalizationId,personalizationPointName:s.personalizationPointName})}),o))})).catch(i=>hr(this,null,function*(){return i instanceof Ui||O.log.error("Unexpected error with browser fetch."),yield Promise.reject(i)}))})}function mu(e,t){if(!F(e))throw new me(le.PersonalizationPointsIsNotAnArray,"The Personalization Points parameter must be an array of length >= 1.");e.forEach(n=>{if(R(n))throw new me(le.PersonalizationPointIsNotDefined,"The Personalization Point must be an object containing a name value.",{context:{value:n}});if(!w(n.name))throw new me(le.PersonalizationPointNameIsNotAString,"The Personalization Point name parameter must be a non empty string.",{context:{value:n.name}});if(ae(n,"decisionId")){if(t!==!0)throw new me(le.PersonalizationPointDecisionIdProvidedNonPreview,"The Personalization Point decisionId parameter can only be provided during previews.",{context:{value:n.decisionId}});if(!w(n.decisionId))throw new me(le.PersonalizationPointDecisionIdIsNotAString,"The Personalization Point decisionId parameter must be a non empty string if provided.",{context:{value:n.decisionId}})}})}function vu(e){if(!N(e))throw new me(le.ContextIsNotAnObject,"The Context parameter must be an object.")}function So(e,t,n){mu(e,n),t!==void 0&&vu(t);const r=an(n)&&n,i={personalizationPoints:e,context:Ht(Ht(Ht(Ht(Ht({individualId:Tu(r,t)},au(t)),Eu(t)),_u(t)),cu(t)),yu(t))};return r&&(i.executionFlags=[Eo]),i}function Eu(e){const t={};if(w(e==null?void 0:e.dataspace))t.dataspace=e==null?void 0:e.dataspace;else{const n=xt();w(n)&&(t.dataspace=n)}return t}function _u(e){var t;const n={};if(w(e==null?void 0:e.requestUrl))n.requestUrl=e==null?void 0:e.requestUrl;else{const r=(t=window==null?void 0:window.location)==null?void 0:t.href;w(r)&&(n.requestUrl=r)}return n}function yu(e){const t={};if([Bt(e==null?void 0:e.utm_source,n=>{t.utm_source=n}),Bt(e==null?void 0:e.utm_campaign,n=>{t.utm_campaign=n}),Bt(e==null?void 0:e.utm_medium,n=>{t.utm_medium=n}),Bt(e==null?void 0:e.utm_content,n=>{t.utm_content=n}),Bt(e==null?void 0:e.utm_term,n=>{t.utm_term=n})].every(n=>!n)){const n=Xs(["utm_source","utm_campaign","utm_medium","utm_content","utm_term"]);Gt("utm_source",n,r=>{t.utm_source=r}),Gt("utm_campaign",n,r=>{t.utm_campaign=r}),Gt("utm_medium",n,r=>{t.utm_medium=r}),Gt("utm_content",n,r=>{t.utm_content=r}),Gt("utm_term",n,r=>{t.utm_term=r})}return t}function Bt(e,t){return w(e)?(t(e),!0):!1}function Gt(e,t,n){const r=t!==null?t[e]:null;w(r)&&n(r)}function Tu(e,t){if(e&&N(t)&&ae(t,"individualId")){const n=t.individualId;if(w(n))return n}return O.getAnonymousId()}function wo(e){var t,n;return(n=(t=e==null?void 0:e.executionFlags)==null?void 0:t.includes(Eo))!=null?n:!1}function gr(e){return!R(pr.get(e))}function Su(e){pr.set(e.personalizationId,e)}function bo(e){pr.delete(e)}function Io(e){return F(e.data)||N(e.attributes,!1)}function wu(e){let t=!0;if(!N(e))throw new Lt(ct.InvalidJsonObject,"Personalization response invalid: Expected a JSON object.");if(!F(e.personalizations,!0))throw new Lt(ct.MissingPersonalizationsArray,'Personalization response invalid: Expected "personalizations" array.');if(e.personalizations.length===0&&(t=!1),e.personalizations.forEach(n=>{if(!w(n.personalizationId))throw new Lt(ct.MissingPersonalizationId,'Personalization response invalid: Expected each "personalization" to include "personalizationId".');if(!w(n.personalizationPointName))throw new Lt(ct.MissingPersonalizationPointName,'Personalization response invalid: Expected each "personalization" to include "personalizationPointName".');if(!Io(n)){O.log.debug(`Personalization invalid, does not contain "data" nor "attributes". Id ${n.personalizationId}, Name ${n.personalizationPointName}`);return}t=!1}),t)throw new Lt(ct.MissingPersonalizationDecision,'Personalization response invalid. Expected each "personalization" to include either "data" or "attributes".')}const bu={destinations:{[ao]:{label:"Product Engagement",description:"Engagement events (e.g. view/click) on this personalization are intended for the stock Product Browse Engagement DMO",disableSendingNonItemEngagementEvents:!0,eventModifiers:{[En]:"catalog",[vn]:e=>{switch(e.name){case tt:return"catalog-object-view-start";case Re:return"catalog-object-click";default:return}},[lr]:"Product"}},[so]:{label:"Website Engagement",description:"Engagement events (e.g. view/click) on this personalization are intended for the stock Website Engagement DMO",eventModifiers:{[En]:"userEngagement",[vn]:e=>{switch(e.name){case tt:return"personalization-view";case Re:return"personalization-click";default:return}}}}},destinationDefaults:{byType:{HTMLElementModifier:"Other",Handlebars:"Product"},global:"Other"},attributes:{engagements:{[tt]:{description:'Apply to specific items/recs, and to the entire personalization (to generate an "overall" view/impression, especially relevant for a banner not using recs).',scope:nt.Any,qualify:()=>Lo(tt),observe:(e,t)=>Pu(e,t),handle:e=>Ro(tt,e)},[Re]:{description:"Apply to an element in the personalization, to listen for click events (including bubbled ones), for engagement/attribution.",scope:nt.Element,qualify:()=>Lo(Re),observe:(e,t)=>Nu(e,t),handle:e=>Ro(Re,e)}},eventModifiers:{[yt]:{description:"Apply to an Engagement attribute, to specify the personalization content id (which rec in the decision) in the resulting engagement event.",scope:nt.Element,valueType:_n.SchemaPath,valueDefault:"[personalizationContentId]",modifyEvent:(e,t,n)=>{R(n.personalization)&&(n.personalization={}),n.personalization.contentId=e}},[_t]:{description:"Apply to an Engagement attribute, to specify the object id (e.g. product id) in the resulting engagement event.",scope:nt.Element,valueType:_n.SchemaPath,valueDefault:"[ssot__Id__c]",modifyEvent:(e,t,n)=>{if(t.eventModifiers===void 0)return;const r=t.eventModifiers[Et];switch(r){case"Product":n.interaction.id=e;return;case"Other":n.interaction.catalogObjectId=e;return;default:O.log.warn(`Unknown Engagement Destination "${r!=null?r:""}"`)}}},[Et]:{description:'Chosen entry from "engagementDestinations", which will modify the resulting engagement event accordingly.',scope:nt.Any,modifyEvent:(e,t,n)=>{const r=Do(e);if(r===void 0){O.log.warn(`Destination name "${e}" not found, cannot be applied to the event.`);return}for(const i in r.eventModifiers){const o=mr(i);if(o===void 0){O.log.warn(`Modifier name "${i}" unknown, cannot be applied to the event.`);continue}const s=r.eventModifiers[i];let l;if(w(s)?l=s:l=s(t),l===void 0){O.log.warn(`Modifier Name "${i}" resulted in no value and as such is not applied to the event.`);continue}o.modifyEvent(l,t,n)}}},[vn]:{description:'Defined by chosen entry in "engagementDestinations", for the "interaction name" in the resulting engagement event.',modifyEvent:(e,t,n)=>{R(n.interaction)?n.interaction={name:e}:n.interaction.name=e}},[En]:{description:'Defined by chosen entry in "engagementDestinations", for the "event type" in the resulting engagement event.',modifyEvent:(e,t,n)=>{R(n.interaction)&&(n.interaction={name:""}),n.interaction.eventType=e}},[lr]:{description:'Defined by chosen entry in "engagementDestinations", for the "type" in the resulting engagement event.',modifyEvent:(e,t,n)=>{R(n.interaction)&&(n.interaction={name:""}),n.interaction.type=e}}}}},Ao={destinations:{},destinationDefaults:{global:""}};let $t=bu,Co=!0;function xe(){return $t!=null?$t:Ao}function Iu(e){e===void 0?$t=Ao:$t=e,Co=Au($t)}function Au(e){var t,n;return!(!N((t=e==null?void 0:e.attributes)==null?void 0:t.engagements)||Ul.some(r=>{var i;return R((i=e.attributes)==null?void 0:i.engagements[r])})||!N((n=e==null?void 0:e.attributes)==null?void 0:n.eventModifiers)||Fl.some(r=>{var i;return R((i=e.attributes)==null?void 0:i.eventModifiers[r])})||!N(e==null?void 0:e.destinations,!1)||lo.some(r=>R(e.destinations[r]))||!N(e==null?void 0:e.destinationDefaults)||!lo.includes(e.destinationDefaults.global))}function Oo(){return Co}function Po(){const e=xe();if(e===void 0||e.destinations===void 0||Object.keys(e.destinations).length===0){O.log.warn("Engagement Configuration does not have any Config for Destinations");return}return e}function No(){const e=Po();return e===void 0?[]:Object.keys(e.destinations)}function Do(e){if(!w(e)){O.log.warn("A valid destination string must be provided in order to find its Engagement Destination configuration");return}const t=Po();if(t!==void 0){if(!(e in t.destinations)){O.log.warn(`Engagement Configuration does not Config for Destination "${e}"`);return}return t.destinations[e]}}function Mo(e){if(!w(e)){O.log.warn("A valid attribute name string must be provided in order to find its Engagement Attribute configuration");return}const t=xe();if(t===void 0||t.attributes===void 0){O.log.warn("Engagement Configuration does not have any Config for Attributes");return}if(!(e in t.attributes.engagements)){O.log.warn(`Engagement Configuration does not Config for Attribute "${e}"`);return}return t.attributes.engagements[e]}function mr(e){if(!w(e)){O.log.warn("A valid modifier name string must be provided in order to find its Engagement Modifier configuration");return}const t=xe();if(t===void 0||t.attributes===void 0){O.log.warn("Engagement Configuration does not have any Config for Attributes");return}if(!(e in t.attributes.eventModifiers)){O.log.warn(`Engagement Configuration does not have Config for Event Modifier "${e}"`);return}return t.attributes.eventModifiers[e]}function Lo(e){const t=Mo(e);if(t===void 0)return;const n=`${gt}${e}`,r=Li(n),i=Array.of(...document.querySelectorAll(r));for(const s of i)t.observe(s,t);const o=new MutationObserver(s=>{if(document===void 0){o.disconnect();return}s.forEach(l=>{switch(l.type){case"attributes":Cu(l,n,t);break;case"childList":Ou(l,n,t);break;default:O.log.error(`Unsupported mutation type: ${l.type}`)}})});o.observe(document,{attributes:!0,attributeFilter:[n],attributeOldValue:!1,childList:!0,subtree:!0}),document.addEventListener(O.CustomEvents.OnShutDown,()=>{o.disconnect()})}function Cu(e,t,n){if(!(e.target instanceof Element)||t!==e.attributeName)return;const r=e.target.getAttribute(t);w(r)&&n.observe(e.target,n)}function Ou(e,t,n){if(!(e.target instanceof Element))return;const r=Array.from(e.addedNodes).filter(o=>o instanceof Element);if(r.length===0)return;const i=Li(t);r.forEach(o=>{o.hasAttribute(t)&&n.observe(o,n),o.querySelectorAll(i).forEach(s=>{n.observe(s,n)})})}let St=new WeakMap;function Pu(e,t){if(St.has(e)){O.log.debug("Already observing element for visibility",e);return}O.log.debug("Observing element for visibility",e);const n=tl.pageElementVisible(e);St.set(e,n),n.then(r=>{if(St.get(r)!==n){O.log.debug("Element now visible, but aborting, no longer current observer",r);return}O.log.debug("Element now visible, calling handle",r),t.handle(r)}).catch(r=>{O.log.warn("Failed to observe element for visibility",e,r)}).finally(()=>{if(St.get(e)!==n){O.log.debug("Observing element for visibility completed, was no longer current observer",e);return}O.log.debug("Observing element for visibility completed",e),St.delete(e)})}let Tn=new WeakMap;function Nu(e,t){if(Tn.has(e)){O.log.debug("Already observing element for click",e);return}O.log.debug("Observing element for click",e);const n=r=>{r.target instanceof Element?e.contains(r.target)?Tn.get(e)!==n?(O.log.debug("Click within element, but aborting, no longer current observer",r.target,e),e.removeEventListener(Re,n)):(O.log.debug("Click within element, calling handle",r.target,e),t.handle(e)):O.log.warn("Click event target is not contained by expected element",r.target,e):O.log.warn("Click event target is not an element",r.target,e)};Tn.set(e,n),e.addEventListener(Re,n),document.addEventListener(O.CustomEvents.OnShutDown,()=>{e.removeEventListener(Re,n)})}function Du(){St=new WeakMap,Tn=new WeakMap}function Ro(e,t){const n=Mu(e,t);if(R(n))return;const r=Lu(n);R(r)||O.sendEvent(r).catch(i=>{O.log.error(`Failed to send personalization engagement event ${JSON.stringify(r)}`,i)})}function Mu(e,t){var n,r;const i=(n=t.closest(`[${Le}]`))==null?void 0:n.getAttribute(Le);if(!w(i))return O.log.warn(`${Le} not found in DOM hierarchy for element`,t),null;if(Mo(e)===void 0)return O.log.warn(`No engagement attribute definition found for ${e}`),null;const o=`${gt}${e}`;if(!t.hasAttribute(o))return O.log.warn(`Engagement attribute ${e} not found on element`,t),null;const s={},l=o.substring(5),a=(r=O.cashDom(t).attr(o))!=null?r:"",u=O.cashDom(t).data(l);O.log.debug(`Found ${e} with modifiers ${a}`,t),N(u,!1)?Object.keys(u).forEach(p=>{if(!w(p)){O.log.warn(`Ignoring empty/non-string modifier key within: ${a}`);return}const f=mr(p);if(R(f)){O.log.warn(`Ignoring unknown modifier: ${p}`);return}const h=u[p];if(!w(h)){O.log.warn(`The value for event modifier "${p}" for engagement attribute of "${e}" is not a string and thus can't be used`);return}s[p]=h}):a.trim().length>0&&O.log.warn(`The value for engagement attribute ${e} was not valid JSON, so cannot process modifiers.`);const c={name:e,element:t,eventModifiers:s,personalizationId:i};return gr(i)&&(c.isPreview=!0),c}function Lu(e){var t,n,r;if(R(e))return null;const i={interaction:{name:""},personalization:{id:e.personalizationId}};an(e.isPreview)&&e.isPreview&&(i.personalization.isTesting=!0);for(const l in e.eventModifiers){const a=mr(l);if(R(a)){O.log.warn(`Ignoring unknown modifier: ${l}`);break}const u=e.eventModifiers[l];if(!w(u)){O.log.warn(`The value for event modifier "${l}" for engagement attribute of "${e.name}" is not a string and thus can't be used`);break}try{a.modifyEvent(u,e,i)}catch(c){O.log.error(`Could not set the value for event modifier "${l}" for engagement attribute of "${e.name}"`,c)}}w((t=i.interaction)==null?void 0:t.name)||O.log.warn("Resulting engagement event has no/empty interaction.name, is likely misconfigured, and will likely be suppressed from sending");const o=(n=e.eventModifiers)==null?void 0:n[Et],s=w(o)?Do(o):void 0;return(s==null?void 0:s.disableSendingNonItemEngagementEvents)===!0&&!w((r=i.personalization)==null?void 0:r.contentId)?(O.log.debug(`Not sending event due to disableSendingNonItemEngagementEvents and no contentId string: ${JSON.stringify(i)}`),null):i}function Ru(e){if(!N(e))throw new W($.DestinationEventModifiersAreRequired,"Engagement destination event modifiers are required.");Object.entries(e).forEach(([t,n])=>{if(!w(n)&&typeof n!="function")throw new W($.InvalidDestinationEventModifier,"Engagement destinations event modifier must be a function or a valid string.")})}function xu(e){if(!N(e)||Object.keys(e).length===0)throw new W($.EngagementDestinationsAreRequired,"Engagement destinations are required.");Object.entries(e).forEach(([t,n])=>{if(n.description!==void 0&&!w(n.description))throw new W($.InvalidEngagementDestinationDescription,"Engagement destination description must be a string if provided.");Ru(n.eventModifiers)})}function ku(e){if(!N(e))throw new W($.EngagementDestinationDefaultsAreRequired,"Engagement destination defaults are required.");if(e.byName!==void 0){if(!N(e.byName))throw new W($.InvalidEngagementDestinationDefaultByName,"Engagement destination defaults by name must be an object if provided.");Object.entries(e.byName).forEach(([,t])=>{if(!w(t))throw new W($.InvalidEngagementDestinationDefaultByNameValue,"Engagement destination by name must have a valid string value.")})}if(e.byType!==void 0){if(!N(e.byType))throw new W($.InvalidEngagementDestinationDefaultByType,"Engagement destination defaults by type must be an object if provided.");Object.entries(e.byType).forEach(([,t])=>{if(!w(t))throw new W($.InvalidEngagementDestinationDefaultByTypeValue,"Engagement destination by type must have a valid string value.")})}if(!w(e.global))throw new W($.InvalidEngagementDestinationDefaultGlobal,"Engagement destination global default must be valid string value.")}function xo(e,t){var n;if(e.description!==void 0&&!w(e.description))throw new W($.InvalidEngagementDestinationAttributeDescription,"Engagement destination attribute description must be a valid string if provided.",{context:{type:t}});if(e.scope!==void 0&&!((n=Object.values(nt))!=null&&n.includes(e.scope)))throw new W($.InvalidEngagementDestinationAttributeScope,"Engagement destination attribute scope should be a valid Engagement Attribute Scope if provided.",{context:{type:t,scope:e.scope}})}function Uu(e){if(!N(e))throw new W($.InvalidEngagementDestinationAttributeEngagements,"Engagement destination attribute engagements must be a valid object.");Object.entries(e).forEach(([,t])=>{if(!N(t))throw new W($.InvalidEngagementDestinationAttributeEngagementValue,"Engagement destination attribute engagements value must be a valid object.");if(xo(t,"engagements"),t.qualify===void 0)throw new W($.MissingEngagementDestinationAttributeEngagementQualify,"Engagement destination attribute engagements must define a qualify function.");if(typeof t.qualify!="function")throw new W($.InvalidEngagementDestinationAttributeEngagementQualify,"Engagement destination attribute engagements qualify must be a function.");if(t.observe===void 0)throw new W($.MissingEngagementDestinationAttributeEngagementObserve,"Engagement destination attribute engagements must define an observe function.");if(typeof t.observe!="function")throw new W($.InvalidEngagementDestinationAttributeEngagementObserve,"Engagement destination attribute engagements observe must be a function.");if(t.handle===void 0)throw new W($.MissingEngagementDestinationAttributeEngagementHandle,"Engagement destination attribute engagements must define a handle function.");if(typeof t.handle!="function")throw new W($.InvalidEngagementDestinationAttributeEngagementHandle,"Engagement destination attribute engagements handle must be a function.")})}function Fu(e){if(!N(e))throw new W($.InvalidEngagementDestinationAttributeEventModifiers,"Engagement destination attribute event modifiers must be a valid object.");Object.entries(e).forEach(([,t])=>{var n;if(!N(t))throw new W($.InvalidEngagementDestinationAttributeEventModifiersValue,"Engagement destination attribute event modifiers value must be a valid object.");if(xo(t,"eventModifiers"),t.modifyEvent===void 0)throw new W($.MissingEngagementDestinationAttributeEventModifierModifyEvent,"Engagement destination attribute event modifiers must define a modifyEvent function.");if(typeof t.modifyEvent!="function")throw new W($.InvalidEngagementDestinationAttributeEventModifierModifyEvent,"Engagement destination attribute event modifiers modifyEvent must be a function.");if(t.valueType!==void 0&&!((n=Object.values(_n))!=null&&n.includes(t.valueType)))throw new W($.InvalidEngagementDestinationAttributeEventModifierValueType,"Engagement destination attribute event modifiers value type should be a valid Engagement Attribute Value Type if provided.",{context:{valueType:t.valueType}});if(t.valueDefault!==void 0&&!w(t.valueDefault,!1,!0))throw new W($.InvalidEngagementDestinationAttributeEventModifierValueDefault,"Engagement destination attribute event modifiers value default should be a valid non-empty string if provided.")})}function zu(e){if(!N(e))throw new W($.InvalidEngagementDestinationAttributes,"Engagement destination attributes must be a valid object if provided.");Uu(e.engagements),Fu(e.eventModifiers)}function ko(e){if(!N(e))throw new W($.InvalidConfig,"Config is required.");xu(e.destinations),ku(e.destinationDefaults),e.attributes!==void 0&&zu(e.attributes)}function Uo(e){if(Ye()){if(!N(e,!1)){O.log.error("A config is required when setting Engagement Config.");return}try{ko(e),Iu(e),O.log.info("Set Engagement Config to the following: ",e)}catch(t){O.log.error(`Engagement Config could not be set due to: ${Q(t).message}`)}}else O.log.error("Engagement Config can only be set before SalesforceInteractions.init is called.")}var vr=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});class Vu extends fr{validateMethod(t){if(t!==void 0&&t!==q.ReplaceElementContent)throw new D(M.TransformationConfigMethodNotSupported,"Transformation Config method not supported for the specific type of transformer.",{context:{transformerType:Ce.HtmlElementModifier,provided:t,required:q.ReplaceElementContent}})}validateSubstitutionValues(t){if(t===void 0||Object.entries(t).length===0)throw new D(M.MissingTransformationSubstitutionValues,"Transformation substitution values are required for the specific type of transformer.",{context:{transformerType:Ce.HtmlElementModifier}})}transform(t,n,r,i,o){const s=o.pec.name,l=i.personalizationId,a=n.transformerName,u=`pec ${s} transformer ${a} for personalization ${l}`;if(n.substitutionValues===void 0){const p=new ue(_e.MissingSubstitutions,`missing substitutionValues for transformation so cannot get the data from Personalization response, ${u}`);return y.log.warn(p.message),o.status.update(new k(p)),{promise:Promise.reject(p),revert:f=>vr(this,null,function*(){f.update(new k(`Nothing to revert, no transformation attempt, ${p.message}`)),yield Promise.resolve()})}}if(Object.entries(n.substitutionValues).length===0){const p=new ue(_e.MissingSubstitutions,"missing an entry in substitutionValues for transformation so cannot get the data from Personalization response");return y.log.warn(p.message),o.status.update(new k(p)),{promise:Promise.reject(p),revert:f=>vr(this,null,function*(){f.update(new k(`Nothing to revert, no transformation attempt, ${p.message}`)),yield Promise.resolve()})}}o.status.update(new k(`Awaiting element/conditions ${u}`));const c=r.then(p=>{if(this.isElementAlreadyPersonalized(p)){y.log.error("Aborting personalization, element is already personalized",p);const b=new ue(_e.AlreadyPersonalized,`Aborting ${u}, element is already personalized`);throw o.status.update(new k(b)),b}if(!R(o.revertStatus)){const b=`Aborting ${u}, revert has been called`;return y.log.info(b),o.status.update(new k(b)),m=>{m.update(new k(`Nothing to revert, since revert was requested before transformation, ${u}`))}}o.status.update(new k(`About to transform/render, element/conditions ready ${u}`));const f=p.outerHTML;let h,d;const g=xe(),v=fo(o.pec.transformationConfig.engagementDestination,t.name,t.transformerType,g),S=Oo();for(const b in n.substitutionValues){const m=n.substitutionValues[b];if(!w(m)){const P=`substitutionValues is missing a value for property "${b}" for transformation so cannot get the data from Personalization response`;y.log.warn(P),o.status.update(new k(P));continue}if(y.log.debug(`using dataPath ${m} to get data from personalization response`),S){const P=this.getPathParentObject(m,i),A=this.buildModifiersIfItemRelated(P,v,g);R(A)||(R(d)?(y.log.debug(`Using item-related modifiers ${JSON.stringify(A)} found adjacent to path "${m}"`),h=m,d=A):(A[yt]!==d[yt]||A[_t]!==d[_t])&&y.log.warn(`Ignoring different item-related modifiers ${JSON.stringify(A)} found adjacent to path "${m}", already using modifiers from path "${h}"`))}const T=this.isAttributeAssignment(b);if(T!==void 0)try{const P=this.getSanitizedContentString(m,i);if(w(P))if(T){this.setAttributeContent(p,b,P);const A=`Set attribute ${b} to ${P}, ${u}`;y.log.trace(A+", element:",p),o.status.update(new k(A))}else{this.setProperty(p,b,P);const A=`Set property ${b} to ${P}, ${u}`;y.log.trace(A+", element:",p),o.status.update(new k(A))}else{const A=`Could not set property ${b}, nothing found at path ${m}`;y.log.debug(A+", element:",p),o.status.update(new k(A))}}catch(P){const A=`Could not set content for ${u}, subVal "${b}"`;y.log.error(A,P);const U=new Error(A+": "+Q(P).message);o.status.update(new k(U))}}let _;return S?(R(d)?(this.autoInjectDefaultRootAttributes(p,l,v,!0),_="Auto-injected engagement attributes without item ids"):(this.autoInjectDefaultItemAttributes(p,l,d,!0),_="Auto-injected engagement attributes with item ids"),y.log.trace(_+`, ${u}`)):(_="Engagement Config does not support auto-injection of default engagement attributes",y.log.trace(_)),o.status.update(new k(_)),b=>{let m=`Reverting ${u}`;y.log.debug(m,p),b.update(new k(m)),p.insertAdjacentHTML("beforebegin",f),p.remove(),m=`Reverted ${u}`,y.log.debug(m,p),b.update(new k(m))}});return{promise:c.then(),revert:p=>vr(this,null,function*(){p.update(new k("Awaiting transformPromise"));const f=c.then(h=>{h(p)},h=>{if(h instanceof ue){p.update(new k(`Nothing to revert, no transformation attempt, ${u}`));return}throw h});f.catch(h=>{const d=new Error(`Issue reverting ${u}: `+Q(h).message);y.log.error(d),p.update(new k(d))}),yield f})}}isAttributeAssignment(t){const n=t.split(".");if(n[0].toLowerCase()==="attributes"){if(n.length===2)return!0;y.log.warn(`multiple objects for 'attributes' with propertyName '${t}' is not supported`);return}return!1}getAttributeContent(t,n){const r=n.split(".");return t.getAttribute(r[1])}removeAttribute(t,n){const r=n.split(".");t.removeAttribute(r[1])}setAttributeContent(t,n,r){const i=n.split(".");t.setAttribute(i[1],r)}setProperty(t,n,r){r=this.handleSpecialValues(n,r);const i=n.split(".");i.length>1?this.setProperty(t[i[0]],i[1],r):Object.assign(t,{[n]:r})}getProperty(t,n){const r=n.split(".");return r.length>1?this.getProperty(t[r[0]],r[1]):t[n]}handleSpecialValues(t,n){if(t.toLowerCase()==="style.backgroundimage"&&w(n))try{return`url(${encodeURI(n)})`}catch(r){y.log.warn(`Could not set style.backgroundImage to a URL "${n}" due to: `,r)}return n}}function Hu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Er={exports:{}},_r={exports:{}},we={},Y={};Y.__esModule=!0,Y.extend=Fo,Y.indexOf=ju,Y.escapeExpression=qu,Y.isEmpty=Yu,Y.createFrame=Ku,Y.blockParams=Zu,Y.appendContextPath=Xu;var Bu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},Gu=/[&<>"'`=]/g,$u=/[&<>"'`=]/;function Wu(e){return Bu[e]}function Fo(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}var yr=Object.prototype.toString;Y.toString=yr;var Tr=function(t){return typeof t=="function"};Tr(/x/)&&(Y.isFunction=Tr=function(e){return typeof e=="function"&&yr.call(e)==="[object Function]"}),Y.isFunction=Tr;var zo=Array.isArray||function(e){return e&&typeof e=="object"?yr.call(e)==="[object Array]":!1};Y.isArray=zo;function ju(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function qu(e){if(typeof e!="string"){if(e&&e.toHTML)return e.toHTML();if(e==null)return"";if(!e)return e+"";e=""+e}return $u.test(e)?e.replace(Gu,Wu):e}function Yu(e){return!e&&e!==0?!0:!!(zo(e)&&e.length===0)}function Ku(e){var t=Fo({},e);return t._parent=e,t}function Zu(e,t){return e.path=t,e}function Xu(e,t){return(e?e+".":"")+t}var Sr={exports:{}};(function(e,t){t.__esModule=!0;var n=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function r(i,o){var s=o&&o.loc,l=void 0,a=void 0,u=void 0,c=void 0;s&&(l=s.start.line,a=s.end.line,u=s.start.column,c=s.end.column,i+=" - "+l+":"+u);for(var p=Error.prototype.constructor.call(this,i),f=0;f<n.length;f++)this[n[f]]=p[n[f]];Error.captureStackTrace&&Error.captureStackTrace(this,r);try{s&&(this.lineNumber=l,this.endLineNumber=a,Object.defineProperty?(Object.defineProperty(this,"column",{value:u,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:c,enumerable:!0})):(this.column=u,this.endColumn=c))}catch(h){}}r.prototype=new Error,t.default=r,e.exports=t.default})(Sr,Sr.exports);var Ne=Sr.exports,Wt={},wr={exports:{}};(function(e,t){t.__esModule=!0;var n=Y;t.default=function(r){r.registerHelper("blockHelperMissing",function(i,o){var s=o.inverse,l=o.fn;if(i===!0)return l(this);if(i===!1||i==null)return s(this);if(n.isArray(i))return i.length>0?(o.ids&&(o.ids=[o.name]),r.helpers.each(i,o)):s(this);if(o.data&&o.ids){var a=n.createFrame(o.data);a.contextPath=n.appendContextPath(o.data.contextPath,o.name),o={data:a}}return l(i,o)})},e.exports=t.default})(wr,wr.exports);var Qu=wr.exports,br={exports:{}};(function(e,t){t.__esModule=!0;function n(s){return s&&s.__esModule?s:{default:s}}var r=Y,i=Ne,o=n(i);t.default=function(s){s.registerHelper("each",function(l,a){if(!a)throw new o.default("Must pass iterator to #each");var u=a.fn,c=a.inverse,p=0,f="",h=void 0,d=void 0;a.data&&a.ids&&(d=r.appendContextPath(a.data.contextPath,a.ids[0])+"."),r.isFunction(l)&&(l=l.call(this)),a.data&&(h=r.createFrame(a.data));function g(m,T,P){h&&(h.key=m,h.index=T,h.first=T===0,h.last=!!P,d&&(h.contextPath=d+m)),f=f+u(l[m],{data:h,blockParams:r.blockParams([l[m],m],[d+m,null])})}if(l&&typeof l=="object")if(r.isArray(l))for(var v=l.length;p<v;p++)p in l&&g(p,p,p===l.length-1);else if(typeof Symbol=="function"&&l[Symbol.iterator]){for(var S=[],_=l[Symbol.iterator](),b=_.next();!b.done;b=_.next())S.push(b.value);l=S;for(var v=l.length;p<v;p++)g(p,p,p===l.length-1)}else(function(){var m=void 0;Object.keys(l).forEach(function(T){m!==void 0&&g(m,p-1),m=T,p++}),m!==void 0&&g(m,p-1,!0)})();return p===0&&(f=c(this)),f})},e.exports=t.default})(br,br.exports);var Ju=br.exports,Ir={exports:{}};(function(e,t){t.__esModule=!0;function n(o){return o&&o.__esModule?o:{default:o}}var r=Ne,i=n(r);t.default=function(o){o.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=t.default})(Ir,Ir.exports);var ec=Ir.exports,Ar={exports:{}};(function(e,t){t.__esModule=!0;function n(s){return s&&s.__esModule?s:{default:s}}var r=Y,i=Ne,o=n(i);t.default=function(s){s.registerHelper("if",function(l,a){if(arguments.length!=2)throw new o.default("#if requires exactly one argument");return r.isFunction(l)&&(l=l.call(this)),!a.hash.includeZero&&!l||r.isEmpty(l)?a.inverse(this):a.fn(this)}),s.registerHelper("unless",function(l,a){if(arguments.length!=2)throw new o.default("#unless requires exactly one argument");return s.helpers.if.call(this,l,{fn:a.inverse,inverse:a.fn,hash:a.hash})})},e.exports=t.default})(Ar,Ar.exports);var tc=Ar.exports,Cr={exports:{}};(function(e,t){t.__esModule=!0,t.default=function(n){n.registerHelper("log",function(){for(var r=[void 0],i=arguments[arguments.length-1],o=0;o<arguments.length-1;o++)r.push(arguments[o]);var s=1;i.hash.level!=null?s=i.hash.level:i.data&&i.data.level!=null&&(s=i.data.level),r[0]=s,n.log.apply(n,r)})},e.exports=t.default})(Cr,Cr.exports);var nc=Cr.exports,Or={exports:{}};(function(e,t){t.__esModule=!0,t.default=function(n){n.registerHelper("lookup",function(r,i,o){return r&&o.lookupProperty(r,i)})},e.exports=t.default})(Or,Or.exports);var rc=Or.exports,Pr={exports:{}};(function(e,t){t.__esModule=!0;function n(s){return s&&s.__esModule?s:{default:s}}var r=Y,i=Ne,o=n(i);t.default=function(s){s.registerHelper("with",function(l,a){if(arguments.length!=2)throw new o.default("#with requires exactly one argument");r.isFunction(l)&&(l=l.call(this));var u=a.fn;if(r.isEmpty(l))return a.inverse(this);var c=a.data;return a.data&&a.ids&&(c=r.createFrame(a.data),c.contextPath=r.appendContextPath(a.data.contextPath,a.ids[0])),u(l,{data:c,blockParams:r.blockParams([l],[c&&c.contextPath])})})},e.exports=t.default})(Pr,Pr.exports);var ic=Pr.exports;Wt.__esModule=!0,Wt.registerDefaultHelpers=_c,Wt.moveHelperToHooks=yc;function rt(e){return e&&e.__esModule?e:{default:e}}var oc=Qu,ac=rt(oc),sc=Ju,lc=rt(sc),uc=ec,cc=rt(uc),fc=tc,dc=rt(fc),hc=nc,pc=rt(hc),gc=rc,mc=rt(gc),vc=ic,Ec=rt(vc);function _c(e){ac.default(e),lc.default(e),cc.default(e),dc.default(e),pc.default(e),mc.default(e),Ec.default(e)}function yc(e,t,n){e.helpers[t]&&(e.hooks[t]=e.helpers[t],n||delete e.helpers[t])}var Nr={},Dr={exports:{}};(function(e,t){t.__esModule=!0;var n=Y;t.default=function(r){r.registerDecorator("inline",function(i,o,s,l){var a=i;return o.partials||(o.partials={},a=function(u,c){var p=s.partials;s.partials=n.extend({},p,o.partials);var f=i(u,c);return s.partials=p,f}),o.partials[l.args[0]]=l.fn,a})},e.exports=t.default})(Dr,Dr.exports);var Tc=Dr.exports;Nr.__esModule=!0,Nr.registerDefaultDecorators=Ic;function Sc(e){return e&&e.__esModule?e:{default:e}}var wc=Tc,bc=Sc(wc);function Ic(e){bc.default(e)}var Mr={exports:{}};(function(e,t){t.__esModule=!0;var n=Y,r={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(o){if(typeof o=="string"){var s=n.indexOf(r.methodMap,o.toLowerCase());s>=0?o=s:o=parseInt(o,10)}return o},log:function(o){if(o=r.lookupLevel(o),typeof console!="undefined"&&r.lookupLevel(r.level)<=o){var s=r.methodMap[o];console[s]||(s="log");for(var l=arguments.length,a=Array(l>1?l-1:0),u=1;u<l;u++)a[u-1]=arguments[u];console[s].apply(console,a)}}};t.default=r,e.exports=t.default})(Mr,Mr.exports);var Vo=Mr.exports,wt={},Lr={};Lr.__esModule=!0,Lr.createNewLookupObject=Cc;var Ac=Y;function Cc(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ac.extend.apply(void 0,[Object.create(null)].concat(t))}wt.__esModule=!0,wt.createProtoAccessControl=Dc,wt.resultIsAllowed=Mc,wt.resetLoggedProperties=Rc;function Oc(e){return e&&e.__esModule?e:{default:e}}var Ho=Lr,Pc=Vo,Nc=Oc(Pc),Sn=Object.create(null);function Dc(e){var t=Object.create(null);t.constructor=!1,t.__defineGetter__=!1,t.__defineSetter__=!1,t.__lookupGetter__=!1;var n=Object.create(null);return n.__proto__=!1,{properties:{whitelist:Ho.createNewLookupObject(n,e.allowedProtoProperties),defaultValue:e.allowProtoPropertiesByDefault},methods:{whitelist:Ho.createNewLookupObject(t,e.allowedProtoMethods),defaultValue:e.allowProtoMethodsByDefault}}}function Mc(e,t,n){return Bo(typeof e=="function"?t.methods:t.properties,n)}function Bo(e,t){return e.whitelist[t]!==void 0?e.whitelist[t]===!0:e.defaultValue!==void 0?e.defaultValue:(Lc(t),!1)}function Lc(e){Sn[e]!==!0&&(Sn[e]=!0,Nc.default.log("error",'Handlebars: Access has been denied to resolve the property "'+e+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function Rc(){Object.keys(Sn).forEach(function(e){delete Sn[e]})}we.__esModule=!0,we.HandlebarsEnvironment=kr;function Go(e){return e&&e.__esModule?e:{default:e}}var it=Y,xc=Ne,Rr=Go(xc),kc=Wt,Uc=Nr,Fc=Vo,wn=Go(Fc),zc=wt,Vc="4.7.8";we.VERSION=Vc;var Hc=8;we.COMPILER_REVISION=Hc;var Bc=7;we.LAST_COMPATIBLE_COMPILER_REVISION=Bc;var Gc={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};we.REVISION_CHANGES=Gc;var xr="[object Object]";function kr(e,t,n){this.helpers=e||{},this.partials=t||{},this.decorators=n||{},kc.registerDefaultHelpers(this),Uc.registerDefaultDecorators(this)}kr.prototype={constructor:kr,logger:wn.default,log:wn.default.log,registerHelper:function(t,n){if(it.toString.call(t)===xr){if(n)throw new Rr.default("Arg not supported with multiple helpers");it.extend(this.helpers,t)}else this.helpers[t]=n},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,n){if(it.toString.call(t)===xr)it.extend(this.partials,t);else{if(typeof n=="undefined")throw new Rr.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=n}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,n){if(it.toString.call(t)===xr){if(n)throw new Rr.default("Arg not supported with multiple decorators");it.extend(this.decorators,t)}else this.decorators[t]=n},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){zc.resetLoggedProperties()}};var $c=wn.default.log;we.log=$c,we.createFrame=it.createFrame,we.logger=wn.default;var Ur={exports:{}};(function(e,t){t.__esModule=!0;function n(r){this.string=r}n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},t.default=n,e.exports=t.default})(Ur,Ur.exports);var Wc=Ur.exports,Xe={},Fr={};Fr.__esModule=!0,Fr.wrapHelper=jc;function jc(e,t){if(typeof e!="function")return e;var n=function(){var i=arguments[arguments.length-1];return arguments[arguments.length-1]=t(i),e.apply(this,arguments)};return n}Xe.__esModule=!0,Xe.checkRevision=Qc,Xe.template=Jc,Xe.wrapProgram=bn,Xe.resolvePartial=ef,Xe.invokePartial=tf,Xe.noop=jo;function qc(e){return e&&e.__esModule?e:{default:e}}function Yc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var Kc=Y,Ge=Yc(Kc),Zc=Ne,$e=qc(Zc),We=we,$o=Wt,Xc=Fr,Wo=wt;function Qc(e){var t=e&&e[0]||1,n=We.COMPILER_REVISION;if(!(t>=We.LAST_COMPATIBLE_COMPILER_REVISION&&t<=We.COMPILER_REVISION))if(t<We.LAST_COMPATIBLE_COMPILER_REVISION){var r=We.REVISION_CHANGES[n],i=We.REVISION_CHANGES[t];throw new $e.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}else throw new $e.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}function Jc(e,t){if(!t)throw new $e.default("No environment passed to template");if(!e||!e.main)throw new $e.default("Unknown template object: "+typeof e);e.main.decorator=e.main_d,t.VM.checkRevision(e.compiler);var n=e.compiler&&e.compiler[0]===7;function r(s,l,a){a.hash&&(l=Ge.extend({},l,a.hash),a.ids&&(a.ids[0]=!0)),s=t.VM.resolvePartial.call(this,s,l,a);var u=Ge.extend({},a,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),c=t.VM.invokePartial.call(this,s,l,u);if(c==null&&t.compile&&(a.partials[a.name]=t.compile(s,e.compilerOptions,t),c=a.partials[a.name](l,u)),c!=null){if(a.indent){for(var p=c.split(`
`),f=0,h=p.length;f<h&&!(!p[f]&&f+1===h);f++)p[f]=a.indent+p[f];c=p.join(`
`)}return c}else throw new $e.default("The partial "+a.name+" could not be compiled when running in runtime-only mode")}var i={strict:function(l,a,u){if(!l||!(a in l))throw new $e.default('"'+a+'" not defined in '+l,{loc:u});return i.lookupProperty(l,a)},lookupProperty:function(l,a){var u=l[a];if(u==null||Object.prototype.hasOwnProperty.call(l,a)||Wo.resultIsAllowed(u,i.protoAccessControl,a))return u},lookup:function(l,a){for(var u=l.length,c=0;c<u;c++){var p=l[c]&&i.lookupProperty(l[c],a);if(p!=null)return l[c][a]}},lambda:function(l,a){return typeof l=="function"?l.call(a):l},escapeExpression:Ge.escapeExpression,invokePartial:r,fn:function(l){var a=e[l];return a.decorator=e[l+"_d"],a},programs:[],program:function(l,a,u,c,p){var f=this.programs[l],h=this.fn(l);return a||p||c||u?f=bn(this,l,h,a,u,c,p):f||(f=this.programs[l]=bn(this,l,h)),f},data:function(l,a){for(;l&&a--;)l=l._parent;return l},mergeIfNeeded:function(l,a){var u=l||a;return l&&a&&l!==a&&(u=Ge.extend({},a,l)),u},nullContext:Object.seal({}),noop:t.VM.noop,compilerInfo:e.compiler};function o(s){var l=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],a=l.data;o._setup(l),!l.partial&&e.useData&&(a=nf(s,a));var u=void 0,c=e.useBlockParams?[]:void 0;e.useDepths&&(l.depths?u=s!=l.depths[0]?[s].concat(l.depths):l.depths:u=[s]);function p(f){return""+e.main(i,f,i.helpers,i.partials,a,c,u)}return p=qo(e.main,p,i,l.depths||[],a,c),p(s,l)}return o.isTop=!0,o._setup=function(s){if(s.partial)i.protoAccessControl=s.protoAccessControl,i.helpers=s.helpers,i.partials=s.partials,i.decorators=s.decorators,i.hooks=s.hooks;else{var l=Ge.extend({},t.helpers,s.helpers);rf(l,i),i.helpers=l,e.usePartial&&(i.partials=i.mergeIfNeeded(s.partials,t.partials)),(e.usePartial||e.useDecorators)&&(i.decorators=Ge.extend({},t.decorators,s.decorators)),i.hooks={},i.protoAccessControl=Wo.createProtoAccessControl(s);var a=s.allowCallsToHelperMissing||n;$o.moveHelperToHooks(i,"helperMissing",a),$o.moveHelperToHooks(i,"blockHelperMissing",a)}},o._child=function(s,l,a,u){if(e.useBlockParams&&!a)throw new $e.default("must pass block params");if(e.useDepths&&!u)throw new $e.default("must pass parent depths");return bn(i,s,e[s],l,0,a,u)},o}function bn(e,t,n,r,i,o,s){function l(a){var u=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],c=s;return s&&a!=s[0]&&!(a===e.nullContext&&s[0]===null)&&(c=[a].concat(s)),n(e,a,e.helpers,e.partials,u.data||r,o&&[u.blockParams].concat(o),c)}return l=qo(n,l,e,s,r,o),l.program=t,l.depth=s?s.length:0,l.blockParams=i||0,l}function ef(e,t,n){return e?!e.call&&!n.name&&(n.name=e,e=n.partials[e]):n.name==="@partial-block"?e=n.data["partial-block"]:e=n.partials[n.name],e}function tf(e,t,n){var r=n.data&&n.data["partial-block"];n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var i=void 0;if(n.fn&&n.fn!==jo&&function(){n.data=We.createFrame(n.data);var o=n.fn;i=n.data["partial-block"]=function(l){var a=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return a.data=We.createFrame(a.data),a.data["partial-block"]=r,o(l,a)},o.partials&&(n.partials=Ge.extend({},n.partials,o.partials))}(),e===void 0&&i&&(e=i),e===void 0)throw new $e.default("The partial "+n.name+" could not be found");if(e instanceof Function)return e(t,n)}function jo(){return""}function nf(e,t){return(!t||!("root"in t))&&(t=t?We.createFrame(t):{},t.root=e),t}function qo(e,t,n,r,i,o){if(e.decorator){var s={};t=e.decorator(t,s,n,r&&r[0],i,o,r),Ge.extend(t,s)}return t}function rf(e,t){Object.keys(e).forEach(function(n){var r=e[n];e[n]=of(r,t)})}function of(e,t){var n=t.lookupProperty;return Xc.wrapHelper(e,function(r){return Ge.extend({lookupProperty:n},r)})}var zr={exports:{}};(function(e,t){t.__esModule=!0,t.default=function(n){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var r=globalThis.Handlebars;n.noConflict=function(){return globalThis.Handlebars===n&&(globalThis.Handlebars=r),n}},e.exports=t.default})(zr,zr.exports);var Yo=zr.exports;(function(e,t){t.__esModule=!0;function n(_){return _&&_.__esModule?_:{default:_}}function r(_){if(_&&_.__esModule)return _;var b={};if(_!=null)for(var m in _)Object.prototype.hasOwnProperty.call(_,m)&&(b[m]=_[m]);return b.default=_,b}var i=we,o=r(i),s=Wc,l=n(s),a=Ne,u=n(a),c=Y,p=r(c),f=Xe,h=r(f),d=Yo,g=n(d);function v(){var _=new o.HandlebarsEnvironment;return p.extend(_,o),_.SafeString=l.default,_.Exception=u.default,_.Utils=p,_.escapeExpression=p.escapeExpression,_.VM=h,_.template=function(b){return h.template(b,_)},_}var S=v();S.create=v,g.default(S),S.default=S,t.default=S,e.exports=t.default})(_r,_r.exports);var af=_r.exports,Vr={exports:{}};(function(e,t){t.__esModule=!0;var n={helpers:{helperExpression:function(i){return i.type==="SubExpression"||(i.type==="MustacheStatement"||i.type==="BlockStatement")&&!!(i.params&&i.params.length||i.hash)},scopedId:function(i){return/^\.|this\b/.test(i.original)},simpleId:function(i){return i.parts.length===1&&!n.helpers.scopedId(i)&&!i.depth}}};t.default=n,e.exports=t.default})(Vr,Vr.exports);var Ko=Vr.exports,jt={},Hr={exports:{}};(function(e,t){t.__esModule=!0;var n=function(){var r={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(l,a,u,c,p,f,h){var d=f.length-1;switch(p){case 1:return f[d-1];case 2:this.$=c.prepareProgram(f[d]);break;case 3:this.$=f[d];break;case 4:this.$=f[d];break;case 5:this.$=f[d];break;case 6:this.$=f[d];break;case 7:this.$=f[d];break;case 8:this.$=f[d];break;case 9:this.$={type:"CommentStatement",value:c.stripComment(f[d]),strip:c.stripFlags(f[d],f[d]),loc:c.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:f[d],value:f[d],loc:c.locInfo(this._$)};break;case 11:this.$=c.prepareRawBlock(f[d-2],f[d-1],f[d],this._$);break;case 12:this.$={path:f[d-3],params:f[d-2],hash:f[d-1]};break;case 13:this.$=c.prepareBlock(f[d-3],f[d-2],f[d-1],f[d],!1,this._$);break;case 14:this.$=c.prepareBlock(f[d-3],f[d-2],f[d-1],f[d],!0,this._$);break;case 15:this.$={open:f[d-5],path:f[d-4],params:f[d-3],hash:f[d-2],blockParams:f[d-1],strip:c.stripFlags(f[d-5],f[d])};break;case 16:this.$={path:f[d-4],params:f[d-3],hash:f[d-2],blockParams:f[d-1],strip:c.stripFlags(f[d-5],f[d])};break;case 17:this.$={path:f[d-4],params:f[d-3],hash:f[d-2],blockParams:f[d-1],strip:c.stripFlags(f[d-5],f[d])};break;case 18:this.$={strip:c.stripFlags(f[d-1],f[d-1]),program:f[d]};break;case 19:var g=c.prepareBlock(f[d-2],f[d-1],f[d],f[d],!1,this._$),v=c.prepareProgram([g],f[d-1].loc);v.chained=!0,this.$={strip:f[d-2].strip,program:v,chain:!0};break;case 20:this.$=f[d];break;case 21:this.$={path:f[d-1],strip:c.stripFlags(f[d-2],f[d])};break;case 22:this.$=c.prepareMustache(f[d-3],f[d-2],f[d-1],f[d-4],c.stripFlags(f[d-4],f[d]),this._$);break;case 23:this.$=c.prepareMustache(f[d-3],f[d-2],f[d-1],f[d-4],c.stripFlags(f[d-4],f[d]),this._$);break;case 24:this.$={type:"PartialStatement",name:f[d-3],params:f[d-2],hash:f[d-1],indent:"",strip:c.stripFlags(f[d-4],f[d]),loc:c.locInfo(this._$)};break;case 25:this.$=c.preparePartialBlock(f[d-2],f[d-1],f[d],this._$);break;case 26:this.$={path:f[d-3],params:f[d-2],hash:f[d-1],strip:c.stripFlags(f[d-4],f[d])};break;case 27:this.$=f[d];break;case 28:this.$=f[d];break;case 29:this.$={type:"SubExpression",path:f[d-3],params:f[d-2],hash:f[d-1],loc:c.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:f[d],loc:c.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:c.id(f[d-2]),value:f[d],loc:c.locInfo(this._$)};break;case 32:this.$=c.id(f[d-1]);break;case 33:this.$=f[d];break;case 34:this.$=f[d];break;case 35:this.$={type:"StringLiteral",value:f[d],original:f[d],loc:c.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(f[d]),original:Number(f[d]),loc:c.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:f[d]==="true",original:f[d]==="true",loc:c.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:c.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:c.locInfo(this._$)};break;case 40:this.$=f[d];break;case 41:this.$=f[d];break;case 42:this.$=c.preparePath(!0,f[d],this._$);break;case 43:this.$=c.preparePath(!1,f[d],this._$);break;case 44:f[d-2].push({part:c.id(f[d]),original:f[d],separator:f[d-1]}),this.$=f[d-2];break;case 45:this.$=[{part:c.id(f[d]),original:f[d]}];break;case 46:this.$=[];break;case 47:f[d-1].push(f[d]);break;case 48:this.$=[];break;case 49:f[d-1].push(f[d]);break;case 50:this.$=[];break;case 51:f[d-1].push(f[d]);break;case 58:this.$=[];break;case 59:f[d-1].push(f[d]);break;case 64:this.$=[];break;case 65:f[d-1].push(f[d]);break;case 70:this.$=[];break;case 71:f[d-1].push(f[d]);break;case 78:this.$=[];break;case 79:f[d-1].push(f[d]);break;case 82:this.$=[];break;case 83:f[d-1].push(f[d]);break;case 86:this.$=[];break;case 87:f[d-1].push(f[d]);break;case 90:this.$=[];break;case 91:f[d-1].push(f[d]);break;case 94:this.$=[];break;case 95:f[d-1].push(f[d]);break;case 98:this.$=[f[d]];break;case 99:f[d-1].push(f[d]);break;case 100:this.$=[f[d]];break;case 101:f[d-1].push(f[d]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(l,a){throw new Error(l)},parse:function(l){var a=this,u=[0],c=[null],p=[],f=this.table,h="",d=0,g=0;this.lexer.setInput(l),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var v=this.lexer.yylloc;p.push(v);var S=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function _(){var Ue;return Ue=a.lexer.lex()||1,typeof Ue!="number"&&(Ue=a.symbols_[Ue]||Ue),Ue}for(var b,m,T,P,A={},U,K,G,H;;){if(m=u[u.length-1],this.defaultActions[m]?T=this.defaultActions[m]:((b===null||typeof b=="undefined")&&(b=_()),T=f[m]&&f[m][b]),typeof T=="undefined"||!T.length||!T[0]){var ke="";{H=[];for(U in f[m])this.terminals_[U]&&U>2&&H.push("'"+this.terminals_[U]+"'");this.lexer.showPosition?ke="Parse error on line "+(d+1)+`:
`+this.lexer.showPosition()+`
Expecting `+H.join(", ")+", got '"+(this.terminals_[b]||b)+"'":ke="Parse error on line "+(d+1)+": Unexpected "+(b==1?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(ke,{text:this.lexer.match,token:this.terminals_[b]||b,line:this.lexer.yylineno,loc:v,expected:H})}}if(T[0]instanceof Array&&T.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+b);switch(T[0]){case 1:u.push(b),c.push(this.lexer.yytext),p.push(this.lexer.yylloc),u.push(T[1]),b=null,g=this.lexer.yyleng,h=this.lexer.yytext,d=this.lexer.yylineno,v=this.lexer.yylloc;break;case 2:if(K=this.productions_[T[1]][1],A.$=c[c.length-K],A._$={first_line:p[p.length-(K||1)].first_line,last_line:p[p.length-1].last_line,first_column:p[p.length-(K||1)].first_column,last_column:p[p.length-1].last_column},S&&(A._$.range=[p[p.length-(K||1)].range[0],p[p.length-1].range[1]]),P=this.performAction.call(A,h,g,d,this.yy,T[1],c,p),typeof P!="undefined")return P;K&&(u=u.slice(0,-1*K*2),c=c.slice(0,-1*K),p=p.slice(0,-1*K)),u.push(this.productions_[T[1]][0]),c.push(A.$),p.push(A._$),G=f[u[u.length-2]][u[u.length-1]],u.push(G);break;case 3:return!0}}return!0}},i=function(){var s={EOF:1,parseError:function(a,u){if(this.yy.parser)this.yy.parser.parseError(a,u);else throw new Error(a)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var u=a.match(/(?:\r\n?|\n).*/g);return u?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var u=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-u-1),this.offset-=u;var p=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var f=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===p.length?this.yylloc.first_column:0)+p[p.length-c.length].length-c[0].length:this.yylloc.first_column-u},this.options.ranges&&(this.yylloc.range=[f[0],f[0]+this.yyleng-u]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),u=new Array(a.length+1).join("-");return a+this.upcomingInput()+`
`+u+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,u,c,p,f;this._more||(this.yytext="",this.match="");for(var h=this._currentRules(),d=0;d<h.length&&(c=this._input.match(this.rules[h[d]]),!(c&&(!u||c[0].length>u[0].length)&&(u=c,p=d,!this.options.flex)));d++);return u?(f=u[0].match(/(?:\r\n?|\n).*/g),f&&(this.yylineno+=f.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:f?f[f.length-1].length-f[f.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+u[0].length},this.yytext+=u[0],this.match+=u[0],this.matches=u,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(u[0].length),this.matched+=u[0],a=this.performAction.call(this,this.yy,this,h[p],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return typeof a!="undefined"?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return s.options={},s.performAction=function(a,u,c,p){function f(h,d){return u.yytext=u.yytext.substring(h,u.yyleng-d+h)}switch(c){case 0:if(u.yytext.slice(-2)==="\\\\"?(f(0,1),this.begin("mu")):u.yytext.slice(-1)==="\\"?(f(0,1),this.begin("emu")):this.begin("mu"),u.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(f(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(u.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return u.yytext=f(1,2).replace(/\\"/g,'"'),80;case 32:return u.yytext=f(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return u.yytext=u.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},s.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],s.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},s}();r.lexer=i;function o(){this.yy={}}return o.prototype=r,r.Parser=o,new o}();t.default=n,e.exports=t.default})(Hr,Hr.exports);var sf=Hr.exports,Br={exports:{}},Gr={exports:{}};(function(e,t){t.__esModule=!0;function n(u){return u&&u.__esModule?u:{default:u}}var r=Ne,i=n(r);function o(){this.parents=[]}o.prototype={constructor:o,mutating:!1,acceptKey:function(c,p){var f=this.accept(c[p]);if(this.mutating){if(f&&!o.prototype[f.type])throw new i.default('Unexpected node type "'+f.type+'" found when accepting '+p+" on "+c.type);c[p]=f}},acceptRequired:function(c,p){if(this.acceptKey(c,p),!c[p])throw new i.default(c.type+" requires "+p)},acceptArray:function(c){for(var p=0,f=c.length;p<f;p++)this.acceptKey(c,p),c[p]||(c.splice(p,1),p--,f--)},accept:function(c){if(c){if(!this[c.type])throw new i.default("Unknown type: "+c.type,c);this.current&&this.parents.unshift(this.current),this.current=c;var p=this[c.type](c);if(this.current=this.parents.shift(),!this.mutating||p)return p;if(p!==!1)return c}},Program:function(c){this.acceptArray(c.body)},MustacheStatement:s,Decorator:s,BlockStatement:l,DecoratorBlock:l,PartialStatement:a,PartialBlockStatement:function(c){a.call(this,c),this.acceptKey(c,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:s,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(c){this.acceptArray(c.pairs)},HashPair:function(c){this.acceptRequired(c,"value")}};function s(u){this.acceptRequired(u,"path"),this.acceptArray(u.params),this.acceptKey(u,"hash")}function l(u){s.call(this,u),this.acceptKey(u,"program"),this.acceptKey(u,"inverse")}function a(u){this.acceptRequired(u,"name"),this.acceptArray(u.params),this.acceptKey(u,"hash")}t.default=o,e.exports=t.default})(Gr,Gr.exports);var Zo=Gr.exports;(function(e,t){t.__esModule=!0;function n(c){return c&&c.__esModule?c:{default:c}}var r=Zo,i=n(r);function o(){var c=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=c}o.prototype=new i.default,o.prototype.Program=function(c){var p=!this.options.ignoreStandalone,f=!this.isRootSeen;this.isRootSeen=!0;for(var h=c.body,d=0,g=h.length;d<g;d++){var v=h[d],S=this.accept(v);if(S){var _=s(h,d,f),b=l(h,d,f),m=S.openStandalone&&_,T=S.closeStandalone&&b,P=S.inlineStandalone&&_&&b;S.close&&a(h,d,!0),S.open&&u(h,d,!0),p&&P&&(a(h,d),u(h,d)&&v.type==="PartialStatement"&&(v.indent=/([ \t]+$)/.exec(h[d-1].original)[1])),p&&m&&(a((v.program||v.inverse).body),u(h,d)),p&&T&&(a(h,d),u((v.inverse||v.program).body))}}return c},o.prototype.BlockStatement=o.prototype.DecoratorBlock=o.prototype.PartialBlockStatement=function(c){this.accept(c.program),this.accept(c.inverse);var p=c.program||c.inverse,f=c.program&&c.inverse,h=f,d=f;if(f&&f.chained)for(h=f.body[0].program;d.chained;)d=d.body[d.body.length-1].program;var g={open:c.openStrip.open,close:c.closeStrip.close,openStandalone:l(p.body),closeStandalone:s((h||p).body)};if(c.openStrip.close&&a(p.body,null,!0),f){var v=c.inverseStrip;v.open&&u(p.body,null,!0),v.close&&a(h.body,null,!0),c.closeStrip.open&&u(d.body,null,!0),!this.options.ignoreStandalone&&s(p.body)&&l(h.body)&&(u(p.body),a(h.body))}else c.closeStrip.open&&u(p.body,null,!0);return g},o.prototype.Decorator=o.prototype.MustacheStatement=function(c){return c.strip},o.prototype.PartialStatement=o.prototype.CommentStatement=function(c){var p=c.strip||{};return{inlineStandalone:!0,open:p.open,close:p.close}};function s(c,p,f){p===void 0&&(p=c.length);var h=c[p-1],d=c[p-2];if(!h)return f;if(h.type==="ContentStatement")return(d||!f?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(h.original)}function l(c,p,f){p===void 0&&(p=-1);var h=c[p+1],d=c[p+2];if(!h)return f;if(h.type==="ContentStatement")return(d||!f?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(h.original)}function a(c,p,f){var h=c[p==null?0:p+1];if(!(!h||h.type!=="ContentStatement"||!f&&h.rightStripped)){var d=h.value;h.value=h.value.replace(f?/^\s+/:/^[ \t]*\r?\n?/,""),h.rightStripped=h.value!==d}}function u(c,p,f){var h=c[p==null?c.length-1:p-1];if(!(!h||h.type!=="ContentStatement"||!f&&h.leftStripped)){var d=h.value;return h.value=h.value.replace(f?/\s+$/:/[ \t]+$/,""),h.leftStripped=h.value!==d,h.leftStripped}}t.default=o,e.exports=t.default})(Br,Br.exports);var lf=Br.exports,be={};be.__esModule=!0,be.SourceLocation=ff,be.id=df,be.stripFlags=hf,be.stripComment=pf,be.preparePath=gf,be.prepareMustache=mf,be.prepareRawBlock=vf,be.prepareBlock=Ef,be.prepareProgram=_f,be.preparePartialBlock=yf;function uf(e){return e&&e.__esModule?e:{default:e}}var cf=Ne,$r=uf(cf);function Wr(e,t){if(t=t.path?t.path.original:t,e.path.original!==t){var n={loc:e.path.loc};throw new $r.default(e.path.original+" doesn't match "+t,n)}}function ff(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}}function df(e){return/^\[.*\]$/.test(e)?e.substring(1,e.length-1):e}function hf(e,t){return{open:e.charAt(2)==="~",close:t.charAt(t.length-3)==="~"}}function pf(e){return e.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function gf(e,t,n){n=this.locInfo(n);for(var r=e?"@":"",i=[],o=0,s=0,l=t.length;s<l;s++){var a=t[s].part,u=t[s].original!==a;if(r+=(t[s].separator||"")+a,!u&&(a===".."||a==="."||a==="this")){if(i.length>0)throw new $r.default("Invalid path: "+r,{loc:n});a===".."&&o++}else i.push(a)}return{type:"PathExpression",data:e,depth:o,parts:i,original:r,loc:n}}function mf(e,t,n,r,i,o){var s=r.charAt(3)||r.charAt(2),l=s!=="{"&&s!=="&",a=/\*/.test(r);return{type:a?"Decorator":"MustacheStatement",path:e,params:t,hash:n,escaped:l,strip:i,loc:this.locInfo(o)}}function vf(e,t,n,r){Wr(e,n),r=this.locInfo(r);var i={type:"Program",body:t,strip:{},loc:r};return{type:"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:i,openStrip:{},inverseStrip:{},closeStrip:{},loc:r}}function Ef(e,t,n,r,i,o){r&&r.path&&Wr(e,r);var s=/\*/.test(e.open);t.blockParams=e.blockParams;var l=void 0,a=void 0;if(n){if(s)throw new $r.default("Unexpected inverse block on decorator",n);n.chain&&(n.program.body[0].closeStrip=r.strip),a=n.strip,l=n.program}return i&&(i=l,l=t,t=i),{type:s?"DecoratorBlock":"BlockStatement",path:e.path,params:e.params,hash:e.hash,program:t,inverse:l,openStrip:e.strip,inverseStrip:a,closeStrip:r&&r.strip,loc:this.locInfo(o)}}function _f(e,t){if(!t&&e.length){var n=e[0].loc,r=e[e.length-1].loc;n&&r&&(t={source:n.source,start:{line:n.start.line,column:n.start.column},end:{line:r.end.line,column:r.end.column}})}return{type:"Program",body:e,strip:{},loc:t}}function yf(e,t,n,r){return Wr(e,n),{type:"PartialBlockStatement",name:e.path,params:e.params,hash:e.hash,program:t,openStrip:e.strip,closeStrip:n&&n.strip,loc:this.locInfo(r)}}jt.__esModule=!0,jt.parseWithoutProcessing=Qo,jt.parse=Of;function Tf(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function Xo(e){return e&&e.__esModule?e:{default:e}}var Sf=sf,jr=Xo(Sf),wf=lf,bf=Xo(wf),If=be,Af=Tf(If),Cf=Y;jt.parser=jr.default;var In={};Cf.extend(In,Af);function Qo(e,t){if(e.type==="Program")return e;jr.default.yy=In,In.locInfo=function(r){return new In.SourceLocation(t&&t.srcName,r)};var n=jr.default.parse(e);return n}function Of(e,t){var n=Qo(e,t),r=new bf.default(t);return r.accept(n)}var qt={};qt.__esModule=!0,qt.Compiler=qr,qt.precompile=Mf,qt.compile=Lf;function Jo(e){return e&&e.__esModule?e:{default:e}}var Pf=Ne,Yt=Jo(Pf),Kt=Y,Nf=Ko,Zt=Jo(Nf),Df=[].slice;function qr(){}qr.prototype={compiler:qr,equals:function(t){var n=this.opcodes.length;if(t.opcodes.length!==n)return!1;for(var r=0;r<n;r++){var i=this.opcodes[r],o=t.opcodes[r];if(i.opcode!==o.opcode||!ea(i.args,o.args))return!1}n=this.children.length;for(var r=0;r<n;r++)if(!this.children[r].equals(t.children[r]))return!1;return!0},guid:0,compile:function(t,n){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=n,this.stringParams=n.stringParams,this.trackIds=n.trackIds,n.blockParams=n.blockParams||[],n.knownHelpers=Kt.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},n.knownHelpers),this.accept(t)},compileProgram:function(t){var n=new this.compiler,r=n.compile(t,this.options),i=this.guid++;return this.usePartial=this.usePartial||r.usePartial,this.children[i]=r,this.useDepths=this.useDepths||r.useDepths,i},accept:function(t){if(!this[t.type])throw new Yt.default("Unknown type: "+t.type,t);this.sourceNode.unshift(t);var n=this[t.type](t);return this.sourceNode.shift(),n},Program:function(t){this.options.blockParams.unshift(t.blockParams);for(var n=t.body,r=n.length,i=0;i<r;i++)this.accept(n[i]);return this.options.blockParams.shift(),this.isSimple=r===1,this.blockParams=t.blockParams?t.blockParams.length:0,this},BlockStatement:function(t){ta(t);var n=t.program,r=t.inverse;n=n&&this.compileProgram(n),r=r&&this.compileProgram(r);var i=this.classifySexpr(t);i==="helper"?this.helperSexpr(t,n,r):i==="simple"?(this.simpleSexpr(t),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",t.path.original)):(this.ambiguousSexpr(t,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(t){var n=t.program&&this.compileProgram(t.program),r=this.setupFullMustacheParams(t,n,void 0),i=t.path;this.useDecorators=!0,this.opcode("registerDecorator",r.length,i.original)},PartialStatement:function(t){this.usePartial=!0;var n=t.program;n&&(n=this.compileProgram(t.program));var r=t.params;if(r.length>1)throw new Yt.default("Unsupported number of partial arguments: "+r.length,t);r.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):r.push({type:"PathExpression",parts:[],depth:0}));var i=t.name.original,o=t.name.type==="SubExpression";o&&this.accept(t.name),this.setupFullMustacheParams(t,n,void 0,!0);var s=t.indent||"";this.options.preventIndent&&s&&(this.opcode("appendContent",s),s=""),this.opcode("invokePartial",o,i,s),this.opcode("append")},PartialBlockStatement:function(t){this.PartialStatement(t)},MustacheStatement:function(t){this.SubExpression(t),t.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(t){this.DecoratorBlock(t)},ContentStatement:function(t){t.value&&this.opcode("appendContent",t.value)},CommentStatement:function(){},SubExpression:function(t){ta(t);var n=this.classifySexpr(t);n==="simple"?this.simpleSexpr(t):n==="helper"?this.helperSexpr(t):this.ambiguousSexpr(t)},ambiguousSexpr:function(t,n,r){var i=t.path,o=i.parts[0],s=n!=null||r!=null;this.opcode("getContext",i.depth),this.opcode("pushProgram",n),this.opcode("pushProgram",r),i.strict=!0,this.accept(i),this.opcode("invokeAmbiguous",o,s)},simpleSexpr:function(t){var n=t.path;n.strict=!0,this.accept(n),this.opcode("resolvePossibleLambda")},helperSexpr:function(t,n,r){var i=this.setupFullMustacheParams(t,n,r),o=t.path,s=o.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",i.length,s);else{if(this.options.knownHelpersOnly)throw new Yt.default("You specified knownHelpersOnly, but used the unknown helper "+s,t);o.strict=!0,o.falsy=!0,this.accept(o),this.opcode("invokeHelper",i.length,o.original,Zt.default.helpers.simpleId(o))}},PathExpression:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var n=t.parts[0],r=Zt.default.helpers.scopedId(t),i=!t.depth&&!r&&this.blockParamIndex(n);i?this.opcode("lookupBlockParam",i,t.parts):n?t.data?(this.options.data=!0,this.opcode("lookupData",t.depth,t.parts,t.strict)):this.opcode("lookupOnContext",t.parts,t.falsy,t.strict,r):this.opcode("pushContext")},StringLiteral:function(t){this.opcode("pushString",t.value)},NumberLiteral:function(t){this.opcode("pushLiteral",t.value)},BooleanLiteral:function(t){this.opcode("pushLiteral",t.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(t){var n=t.pairs,r=0,i=n.length;for(this.opcode("pushHash");r<i;r++)this.pushParam(n[r].value);for(;r--;)this.opcode("assignToHash",n[r].key);this.opcode("popHash")},opcode:function(t){this.opcodes.push({opcode:t,args:Df.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(t){t&&(this.useDepths=!0)},classifySexpr:function(t){var n=Zt.default.helpers.simpleId(t.path),r=n&&!!this.blockParamIndex(t.path.parts[0]),i=!r&&Zt.default.helpers.helperExpression(t),o=!r&&(i||n);if(o&&!i){var s=t.path.parts[0],l=this.options;l.knownHelpers[s]?i=!0:l.knownHelpersOnly&&(o=!1)}return i?"helper":o?"ambiguous":"simple"},pushParams:function(t){for(var n=0,r=t.length;n<r;n++)this.pushParam(t[n])},pushParam:function(t){var n=t.value!=null?t.value:t.original||"";if(this.stringParams)n.replace&&(n=n.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",n,t.type),t.type==="SubExpression"&&this.accept(t);else{if(this.trackIds){var r=void 0;if(t.parts&&!Zt.default.helpers.scopedId(t)&&!t.depth&&(r=this.blockParamIndex(t.parts[0])),r){var i=t.parts.slice(1).join(".");this.opcode("pushId","BlockParam",r,i)}else n=t.original||n,n.replace&&(n=n.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",t.type,n)}this.accept(t)}},setupFullMustacheParams:function(t,n,r,i){var o=t.params;return this.pushParams(o),this.opcode("pushProgram",n),this.opcode("pushProgram",r),t.hash?this.accept(t.hash):this.opcode("emptyHash",i),o},blockParamIndex:function(t){for(var n=0,r=this.options.blockParams.length;n<r;n++){var i=this.options.blockParams[n],o=i&&Kt.indexOf(i,t);if(i&&o>=0)return[n,o]}}};function Mf(e,t,n){if(e==null||typeof e!="string"&&e.type!=="Program")throw new Yt.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var r=n.parse(e,t),i=new n.Compiler().compile(r,t);return new n.JavaScriptCompiler().compile(i,t)}function Lf(e,t,n){if(t===void 0&&(t={}),e==null||typeof e!="string"&&e.type!=="Program")throw new Yt.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=Kt.extend({},t),"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var r=void 0;function i(){var s=n.parse(e,t),l=new n.Compiler().compile(s,t),a=new n.JavaScriptCompiler().compile(l,t,void 0,!0);return n.template(a)}function o(s,l){return r||(r=i()),r.call(this,s,l)}return o._setup=function(s){return r||(r=i()),r._setup(s)},o._child=function(s,l,a,u){return r||(r=i()),r._child(s,l,a,u)},o}function ea(e,t){if(e===t)return!0;if(Kt.isArray(e)&&Kt.isArray(t)&&e.length===t.length){for(var n=0;n<e.length;n++)if(!ea(e[n],t[n]))return!1;return!0}}function ta(e){if(!e.path.parts){var t=e.path;e.path={type:"PathExpression",data:!1,depth:0,parts:[t.original+""],original:t.original+"",loc:t.loc}}}var Yr={exports:{}},Kr={exports:{}},Xt={},Zr={},An={},Cn={},na;function Rf(){if(na)return Cn;na=1;var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Cn.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},Cn.decode=function(t){var n=65,r=90,i=97,o=122,s=48,l=57,a=43,u=47,c=26,p=52;return n<=t&&t<=r?t-n:i<=t&&t<=o?t-i+c:s<=t&&t<=l?t-s+p:t==a?62:t==u?63:-1},Cn}var ra;function ia(){if(ra)return An;ra=1;var e=Rf(),t=5,n=1<<t,r=n-1,i=n;function o(l){return l<0?(-l<<1)+1:(l<<1)+0}function s(l){var a=(l&1)===1,u=l>>1;return a?-u:u}return An.encode=function(a){var u="",c,p=o(a);do c=p&r,p>>>=t,p>0&&(c|=i),u+=e.encode(c);while(p>0);return u},An.decode=function(a,u,c){var p=a.length,f=0,h=0,d,g;do{if(u>=p)throw new Error("Expected more digits in base 64 VLQ value.");if(g=e.decode(a.charCodeAt(u++)),g===-1)throw new Error("Invalid base64 digit: "+a.charAt(u-1));d=!!(g&i),g&=r,f=f+(g<<h),h+=t}while(d);c.value=s(f),c.rest=u},An}var Xr={},oa;function Qt(){return oa||(oa=1,function(e){function t(m,T,P){if(T in m)return m[T];if(arguments.length===3)return P;throw new Error('"'+T+'" is a required argument.')}e.getArg=t;var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(m){var T=m.match(n);return T?{scheme:T[1],auth:T[2],host:T[3],port:T[4],path:T[5]}:null}e.urlParse=i;function o(m){var T="";return m.scheme&&(T+=m.scheme+":"),T+="//",m.auth&&(T+=m.auth+"@"),m.host&&(T+=m.host),m.port&&(T+=":"+m.port),m.path&&(T+=m.path),T}e.urlGenerate=o;function s(m){var T=m,P=i(m);if(P){if(!P.path)return m;T=P.path}for(var A=e.isAbsolute(T),U=T.split(/\/+/),K,G=0,H=U.length-1;H>=0;H--)K=U[H],K==="."?U.splice(H,1):K===".."?G++:G>0&&(K===""?(U.splice(H+1,G),G=0):(U.splice(H,2),G--));return T=U.join("/"),T===""&&(T=A?"/":"."),P?(P.path=T,o(P)):T}e.normalize=s;function l(m,T){m===""&&(m="."),T===""&&(T=".");var P=i(T),A=i(m);if(A&&(m=A.path||"/"),P&&!P.scheme)return A&&(P.scheme=A.scheme),o(P);if(P||T.match(r))return T;if(A&&!A.host&&!A.path)return A.host=T,o(A);var U=T.charAt(0)==="/"?T:s(m.replace(/\/+$/,"")+"/"+T);return A?(A.path=U,o(A)):U}e.join=l,e.isAbsolute=function(m){return m.charAt(0)==="/"||n.test(m)};function a(m,T){m===""&&(m="."),m=m.replace(/\/$/,"");for(var P=0;T.indexOf(m+"/")!==0;){var A=m.lastIndexOf("/");if(A<0||(m=m.slice(0,A),m.match(/^([^\/]+:\/)?\/*$/)))return T;++P}return Array(P+1).join("../")+T.substr(m.length+1)}e.relative=a;var u=function(){var m=Object.create(null);return!("__proto__"in m)}();function c(m){return m}function p(m){return h(m)?"$"+m:m}e.toSetString=u?c:p;function f(m){return h(m)?m.slice(1):m}e.fromSetString=u?c:f;function h(m){if(!m)return!1;var T=m.length;if(T<9||m.charCodeAt(T-1)!==95||m.charCodeAt(T-2)!==95||m.charCodeAt(T-3)!==111||m.charCodeAt(T-4)!==116||m.charCodeAt(T-5)!==111||m.charCodeAt(T-6)!==114||m.charCodeAt(T-7)!==112||m.charCodeAt(T-8)!==95||m.charCodeAt(T-9)!==95)return!1;for(var P=T-10;P>=0;P--)if(m.charCodeAt(P)!==36)return!1;return!0}function d(m,T,P){var A=v(m.source,T.source);return A!==0||(A=m.originalLine-T.originalLine,A!==0)||(A=m.originalColumn-T.originalColumn,A!==0||P)||(A=m.generatedColumn-T.generatedColumn,A!==0)||(A=m.generatedLine-T.generatedLine,A!==0)?A:v(m.name,T.name)}e.compareByOriginalPositions=d;function g(m,T,P){var A=m.generatedLine-T.generatedLine;return A!==0||(A=m.generatedColumn-T.generatedColumn,A!==0||P)||(A=v(m.source,T.source),A!==0)||(A=m.originalLine-T.originalLine,A!==0)||(A=m.originalColumn-T.originalColumn,A!==0)?A:v(m.name,T.name)}e.compareByGeneratedPositionsDeflated=g;function v(m,T){return m===T?0:m===null?1:T===null?-1:m>T?1:-1}function S(m,T){var P=m.generatedLine-T.generatedLine;return P!==0||(P=m.generatedColumn-T.generatedColumn,P!==0)||(P=v(m.source,T.source),P!==0)||(P=m.originalLine-T.originalLine,P!==0)||(P=m.originalColumn-T.originalColumn,P!==0)?P:v(m.name,T.name)}e.compareByGeneratedPositionsInflated=S;function _(m){return JSON.parse(m.replace(/^\)]}'[^\n]*\n/,""))}e.parseSourceMapInput=_;function b(m,T,P){if(T=T||"",m&&(m[m.length-1]!=="/"&&T[0]!=="/"&&(m+="/"),T=m+T),P){var A=i(P);if(!A)throw new Error("sourceMapURL could not be parsed");if(A.path){var U=A.path.lastIndexOf("/");U>=0&&(A.path=A.path.substring(0,U+1))}T=l(o(A),T)}return s(T)}e.computeSourceURL=b}(Xr)),Xr}var Qr={},aa;function sa(){if(aa)return Qr;aa=1;var e=Qt(),t=Object.prototype.hasOwnProperty,n=typeof Map!="undefined";function r(){this._array=[],this._set=n?new Map:Object.create(null)}return r.fromArray=function(o,s){for(var l=new r,a=0,u=o.length;a<u;a++)l.add(o[a],s);return l},r.prototype.size=function(){return n?this._set.size:Object.getOwnPropertyNames(this._set).length},r.prototype.add=function(o,s){var l=n?o:e.toSetString(o),a=n?this.has(o):t.call(this._set,l),u=this._array.length;(!a||s)&&this._array.push(o),a||(n?this._set.set(o,u):this._set[l]=u)},r.prototype.has=function(o){if(n)return this._set.has(o);var s=e.toSetString(o);return t.call(this._set,s)},r.prototype.indexOf=function(o){if(n){var s=this._set.get(o);if(s>=0)return s}else{var l=e.toSetString(o);if(t.call(this._set,l))return this._set[l]}throw new Error('"'+o+'" is not in the set.')},r.prototype.at=function(o){if(o>=0&&o<this._array.length)return this._array[o];throw new Error("No element indexed by "+o)},r.prototype.toArray=function(){return this._array.slice()},Qr.ArraySet=r,Qr}var Jr={},la;function xf(){if(la)return Jr;la=1;var e=Qt();function t(r,i){var o=r.generatedLine,s=i.generatedLine,l=r.generatedColumn,a=i.generatedColumn;return s>o||s==o&&a>=l||e.compareByGeneratedPositionsInflated(r,i)<=0}function n(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return n.prototype.unsortedForEach=function(i,o){this._array.forEach(i,o)},n.prototype.add=function(i){t(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))},n.prototype.toArray=function(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},Jr.MappingList=n,Jr}var ua;function ca(){if(ua)return Zr;ua=1;var e=ia(),t=Qt(),n=sa().ArraySet,r=xf().MappingList;function i(o){o||(o={}),this._file=t.getArg(o,"file",null),this._sourceRoot=t.getArg(o,"sourceRoot",null),this._skipValidation=t.getArg(o,"skipValidation",!1),this._sources=new n,this._names=new n,this._mappings=new r,this._sourcesContents=null}return i.prototype._version=3,i.fromSourceMap=function(s){var l=s.sourceRoot,a=new i({file:s.file,sourceRoot:l});return s.eachMapping(function(u){var c={generated:{line:u.generatedLine,column:u.generatedColumn}};u.source!=null&&(c.source=u.source,l!=null&&(c.source=t.relative(l,c.source)),c.original={line:u.originalLine,column:u.originalColumn},u.name!=null&&(c.name=u.name)),a.addMapping(c)}),s.sources.forEach(function(u){var c=u;l!==null&&(c=t.relative(l,u)),a._sources.has(c)||a._sources.add(c);var p=s.sourceContentFor(u);p!=null&&a.setSourceContent(u,p)}),a},i.prototype.addMapping=function(s){var l=t.getArg(s,"generated"),a=t.getArg(s,"original",null),u=t.getArg(s,"source",null),c=t.getArg(s,"name",null);this._skipValidation||this._validateMapping(l,a,u,c),u!=null&&(u=String(u),this._sources.has(u)||this._sources.add(u)),c!=null&&(c=String(c),this._names.has(c)||this._names.add(c)),this._mappings.add({generatedLine:l.line,generatedColumn:l.column,originalLine:a!=null&&a.line,originalColumn:a!=null&&a.column,source:u,name:c})},i.prototype.setSourceContent=function(s,l){var a=s;this._sourceRoot!=null&&(a=t.relative(this._sourceRoot,a)),l!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(a)]=l):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(a)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},i.prototype.applySourceMap=function(s,l,a){var u=l;if(l==null){if(s.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);u=s.file}var c=this._sourceRoot;c!=null&&(u=t.relative(c,u));var p=new n,f=new n;this._mappings.unsortedForEach(function(h){if(h.source===u&&h.originalLine!=null){var d=s.originalPositionFor({line:h.originalLine,column:h.originalColumn});d.source!=null&&(h.source=d.source,a!=null&&(h.source=t.join(a,h.source)),c!=null&&(h.source=t.relative(c,h.source)),h.originalLine=d.line,h.originalColumn=d.column,d.name!=null&&(h.name=d.name))}var g=h.source;g!=null&&!p.has(g)&&p.add(g);var v=h.name;v!=null&&!f.has(v)&&f.add(v)},this),this._sources=p,this._names=f,s.sources.forEach(function(h){var d=s.sourceContentFor(h);d!=null&&(a!=null&&(h=t.join(a,h)),c!=null&&(h=t.relative(c,h)),this.setSourceContent(h,d))},this)},i.prototype._validateMapping=function(s,l,a,u){if(l&&typeof l.line!="number"&&typeof l.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(s&&"line"in s&&"column"in s&&s.line>0&&s.column>=0&&!l&&!a&&!u)){if(s&&"line"in s&&"column"in s&&l&&"line"in l&&"column"in l&&s.line>0&&s.column>=0&&l.line>0&&l.column>=0&&a)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:s,source:a,original:l,name:u}))}},i.prototype._serializeMappings=function(){for(var s=0,l=1,a=0,u=0,c=0,p=0,f="",h,d,g,v,S=this._mappings.toArray(),_=0,b=S.length;_<b;_++){if(d=S[_],h="",d.generatedLine!==l)for(s=0;d.generatedLine!==l;)h+=";",l++;else if(_>0){if(!t.compareByGeneratedPositionsInflated(d,S[_-1]))continue;h+=","}h+=e.encode(d.generatedColumn-s),s=d.generatedColumn,d.source!=null&&(v=this._sources.indexOf(d.source),h+=e.encode(v-p),p=v,h+=e.encode(d.originalLine-1-u),u=d.originalLine-1,h+=e.encode(d.originalColumn-a),a=d.originalColumn,d.name!=null&&(g=this._names.indexOf(d.name),h+=e.encode(g-c),c=g)),f+=h}return f},i.prototype._generateSourcesContent=function(s,l){return s.map(function(a){if(!this._sourcesContents)return null;l!=null&&(a=t.relative(l,a));var u=t.toSetString(a);return Object.prototype.hasOwnProperty.call(this._sourcesContents,u)?this._sourcesContents[u]:null},this)},i.prototype.toJSON=function(){var s={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(s.file=this._file),this._sourceRoot!=null&&(s.sourceRoot=this._sourceRoot),this._sourcesContents&&(s.sourcesContent=this._generateSourcesContent(s.sources,s.sourceRoot)),s},i.prototype.toString=function(){return JSON.stringify(this.toJSON())},Zr.SourceMapGenerator=i,Zr}var Jt={},ei={},fa;function kf(){return fa||(fa=1,function(e){e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2;function t(n,r,i,o,s,l){var a=Math.floor((r-n)/2)+n,u=s(i,o[a],!0);return u===0?a:u>0?r-a>1?t(a,r,i,o,s,l):l==e.LEAST_UPPER_BOUND?r<o.length?r:-1:a:a-n>1?t(n,a,i,o,s,l):l==e.LEAST_UPPER_BOUND?a:n<0?-1:n}e.search=function(r,i,o,s){if(i.length===0)return-1;var l=t(-1,i.length,r,i,o,s||e.GREATEST_LOWER_BOUND);if(l<0)return-1;for(;l-1>=0&&o(i[l],i[l-1],!0)===0;)--l;return l}}(ei)),ei}var ti={},da;function Uf(){if(da)return ti;da=1;function e(r,i,o){var s=r[i];r[i]=r[o],r[o]=s}function t(r,i){return Math.round(r+Math.random()*(i-r))}function n(r,i,o,s){if(o<s){var l=t(o,s),a=o-1;e(r,l,s);for(var u=r[s],c=o;c<s;c++)i(r[c],u)<=0&&(a+=1,e(r,a,c));e(r,a+1,c);var p=a+1;n(r,i,o,p-1),n(r,i,p+1,s)}}return ti.quickSort=function(r,i){n(r,i,0,r.length-1)},ti}var ha;function Ff(){if(ha)return Jt;ha=1;var e=Qt(),t=kf(),n=sa().ArraySet,r=ia(),i=Uf().quickSort;function o(u,c){var p=u;return typeof u=="string"&&(p=e.parseSourceMapInput(u)),p.sections!=null?new a(p,c):new s(p,c)}o.fromSourceMap=function(u,c){return s.fromSourceMap(u,c)},o.prototype._version=3,o.prototype.__generatedMappings=null,Object.defineProperty(o.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),o.prototype.__originalMappings=null,Object.defineProperty(o.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),o.prototype._charIsMappingSeparator=function(c,p){var f=c.charAt(p);return f===";"||f===","},o.prototype._parseMappings=function(c,p){throw new Error("Subclasses must implement _parseMappings")},o.GENERATED_ORDER=1,o.ORIGINAL_ORDER=2,o.GREATEST_LOWER_BOUND=1,o.LEAST_UPPER_BOUND=2,o.prototype.eachMapping=function(c,p,f){var h=p||null,d=f||o.GENERATED_ORDER,g;switch(d){case o.GENERATED_ORDER:g=this._generatedMappings;break;case o.ORIGINAL_ORDER:g=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var v=this.sourceRoot;g.map(function(S){var _=S.source===null?null:this._sources.at(S.source);return _=e.computeSourceURL(v,_,this._sourceMapURL),{source:_,generatedLine:S.generatedLine,generatedColumn:S.generatedColumn,originalLine:S.originalLine,originalColumn:S.originalColumn,name:S.name===null?null:this._names.at(S.name)}},this).forEach(c,h)},o.prototype.allGeneratedPositionsFor=function(c){var p=e.getArg(c,"line"),f={source:e.getArg(c,"source"),originalLine:p,originalColumn:e.getArg(c,"column",0)};if(f.source=this._findSourceIndex(f.source),f.source<0)return[];var h=[],d=this._findMapping(f,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,t.LEAST_UPPER_BOUND);if(d>=0){var g=this._originalMappings[d];if(c.column===void 0)for(var v=g.originalLine;g&&g.originalLine===v;)h.push({line:e.getArg(g,"generatedLine",null),column:e.getArg(g,"generatedColumn",null),lastColumn:e.getArg(g,"lastGeneratedColumn",null)}),g=this._originalMappings[++d];else for(var S=g.originalColumn;g&&g.originalLine===p&&g.originalColumn==S;)h.push({line:e.getArg(g,"generatedLine",null),column:e.getArg(g,"generatedColumn",null),lastColumn:e.getArg(g,"lastGeneratedColumn",null)}),g=this._originalMappings[++d]}return h},Jt.SourceMapConsumer=o;function s(u,c){var p=u;typeof u=="string"&&(p=e.parseSourceMapInput(u));var f=e.getArg(p,"version"),h=e.getArg(p,"sources"),d=e.getArg(p,"names",[]),g=e.getArg(p,"sourceRoot",null),v=e.getArg(p,"sourcesContent",null),S=e.getArg(p,"mappings"),_=e.getArg(p,"file",null);if(f!=this._version)throw new Error("Unsupported version: "+f);g&&(g=e.normalize(g)),h=h.map(String).map(e.normalize).map(function(b){return g&&e.isAbsolute(g)&&e.isAbsolute(b)?e.relative(g,b):b}),this._names=n.fromArray(d.map(String),!0),this._sources=n.fromArray(h,!0),this._absoluteSources=this._sources.toArray().map(function(b){return e.computeSourceURL(g,b,c)}),this.sourceRoot=g,this.sourcesContent=v,this._mappings=S,this._sourceMapURL=c,this.file=_}s.prototype=Object.create(o.prototype),s.prototype.consumer=o,s.prototype._findSourceIndex=function(u){var c=u;if(this.sourceRoot!=null&&(c=e.relative(this.sourceRoot,c)),this._sources.has(c))return this._sources.indexOf(c);var p;for(p=0;p<this._absoluteSources.length;++p)if(this._absoluteSources[p]==u)return p;return-1},s.fromSourceMap=function(c,p){var f=Object.create(s.prototype),h=f._names=n.fromArray(c._names.toArray(),!0),d=f._sources=n.fromArray(c._sources.toArray(),!0);f.sourceRoot=c._sourceRoot,f.sourcesContent=c._generateSourcesContent(f._sources.toArray(),f.sourceRoot),f.file=c._file,f._sourceMapURL=p,f._absoluteSources=f._sources.toArray().map(function(P){return e.computeSourceURL(f.sourceRoot,P,p)});for(var g=c._mappings.toArray().slice(),v=f.__generatedMappings=[],S=f.__originalMappings=[],_=0,b=g.length;_<b;_++){var m=g[_],T=new l;T.generatedLine=m.generatedLine,T.generatedColumn=m.generatedColumn,m.source&&(T.source=d.indexOf(m.source),T.originalLine=m.originalLine,T.originalColumn=m.originalColumn,m.name&&(T.name=h.indexOf(m.name)),S.push(T)),v.push(T)}return i(f.__originalMappings,e.compareByOriginalPositions),f},s.prototype._version=3,Object.defineProperty(s.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function l(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}s.prototype._parseMappings=function(c,p){for(var f=1,h=0,d=0,g=0,v=0,S=0,_=c.length,b=0,m={},T={},P=[],A=[],U,K,G,H,ke;b<_;)if(c.charAt(b)===";")f++,b++,h=0;else if(c.charAt(b)===",")b++;else{for(U=new l,U.generatedLine=f,H=b;H<_&&!this._charIsMappingSeparator(c,H);H++);if(K=c.slice(b,H),G=m[K],G)b+=K.length;else{for(G=[];b<H;)r.decode(c,b,T),ke=T.value,b=T.rest,G.push(ke);if(G.length===2)throw new Error("Found a source, but no line and column");if(G.length===3)throw new Error("Found a source and line, but no column");m[K]=G}U.generatedColumn=h+G[0],h=U.generatedColumn,G.length>1&&(U.source=v+G[1],v+=G[1],U.originalLine=d+G[2],d=U.originalLine,U.originalLine+=1,U.originalColumn=g+G[3],g=U.originalColumn,G.length>4&&(U.name=S+G[4],S+=G[4])),A.push(U),typeof U.originalLine=="number"&&P.push(U)}i(A,e.compareByGeneratedPositionsDeflated),this.__generatedMappings=A,i(P,e.compareByOriginalPositions),this.__originalMappings=P},s.prototype._findMapping=function(c,p,f,h,d,g){if(c[f]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+c[f]);if(c[h]<0)throw new TypeError("Column must be greater than or equal to 0, got "+c[h]);return t.search(c,p,d,g)},s.prototype.computeColumnSpans=function(){for(var c=0;c<this._generatedMappings.length;++c){var p=this._generatedMappings[c];if(c+1<this._generatedMappings.length){var f=this._generatedMappings[c+1];if(p.generatedLine===f.generatedLine){p.lastGeneratedColumn=f.generatedColumn-1;continue}}p.lastGeneratedColumn=1/0}},s.prototype.originalPositionFor=function(c){var p={generatedLine:e.getArg(c,"line"),generatedColumn:e.getArg(c,"column")},f=this._findMapping(p,this._generatedMappings,"generatedLine","generatedColumn",e.compareByGeneratedPositionsDeflated,e.getArg(c,"bias",o.GREATEST_LOWER_BOUND));if(f>=0){var h=this._generatedMappings[f];if(h.generatedLine===p.generatedLine){var d=e.getArg(h,"source",null);d!==null&&(d=this._sources.at(d),d=e.computeSourceURL(this.sourceRoot,d,this._sourceMapURL));var g=e.getArg(h,"name",null);return g!==null&&(g=this._names.at(g)),{source:d,line:e.getArg(h,"originalLine",null),column:e.getArg(h,"originalColumn",null),name:g}}}return{source:null,line:null,column:null,name:null}},s.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(c){return c==null}):!1},s.prototype.sourceContentFor=function(c,p){if(!this.sourcesContent)return null;var f=this._findSourceIndex(c);if(f>=0)return this.sourcesContent[f];var h=c;this.sourceRoot!=null&&(h=e.relative(this.sourceRoot,h));var d;if(this.sourceRoot!=null&&(d=e.urlParse(this.sourceRoot))){var g=h.replace(/^file:\/\//,"");if(d.scheme=="file"&&this._sources.has(g))return this.sourcesContent[this._sources.indexOf(g)];if((!d.path||d.path=="/")&&this._sources.has("/"+h))return this.sourcesContent[this._sources.indexOf("/"+h)]}if(p)return null;throw new Error('"'+h+'" is not in the SourceMap.')},s.prototype.generatedPositionFor=function(c){var p=e.getArg(c,"source");if(p=this._findSourceIndex(p),p<0)return{line:null,column:null,lastColumn:null};var f={source:p,originalLine:e.getArg(c,"line"),originalColumn:e.getArg(c,"column")},h=this._findMapping(f,this._originalMappings,"originalLine","originalColumn",e.compareByOriginalPositions,e.getArg(c,"bias",o.GREATEST_LOWER_BOUND));if(h>=0){var d=this._originalMappings[h];if(d.source===f.source)return{line:e.getArg(d,"generatedLine",null),column:e.getArg(d,"generatedColumn",null),lastColumn:e.getArg(d,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},Jt.BasicSourceMapConsumer=s;function a(u,c){var p=u;typeof u=="string"&&(p=e.parseSourceMapInput(u));var f=e.getArg(p,"version"),h=e.getArg(p,"sections");if(f!=this._version)throw new Error("Unsupported version: "+f);this._sources=new n,this._names=new n;var d={line:-1,column:0};this._sections=h.map(function(g){if(g.url)throw new Error("Support for url field in sections not implemented.");var v=e.getArg(g,"offset"),S=e.getArg(v,"line"),_=e.getArg(v,"column");if(S<d.line||S===d.line&&_<d.column)throw new Error("Section offsets must be ordered and non-overlapping.");return d=v,{generatedOffset:{generatedLine:S+1,generatedColumn:_+1},consumer:new o(e.getArg(g,"map"),c)}})}return a.prototype=Object.create(o.prototype),a.prototype.constructor=o,a.prototype._version=3,Object.defineProperty(a.prototype,"sources",{get:function(){for(var u=[],c=0;c<this._sections.length;c++)for(var p=0;p<this._sections[c].consumer.sources.length;p++)u.push(this._sections[c].consumer.sources[p]);return u}}),a.prototype.originalPositionFor=function(c){var p={generatedLine:e.getArg(c,"line"),generatedColumn:e.getArg(c,"column")},f=t.search(p,this._sections,function(d,g){var v=d.generatedLine-g.generatedOffset.generatedLine;return v||d.generatedColumn-g.generatedOffset.generatedColumn}),h=this._sections[f];return h?h.consumer.originalPositionFor({line:p.generatedLine-(h.generatedOffset.generatedLine-1),column:p.generatedColumn-(h.generatedOffset.generatedLine===p.generatedLine?h.generatedOffset.generatedColumn-1:0),bias:c.bias}):{source:null,line:null,column:null,name:null}},a.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(c){return c.consumer.hasContentsOfAllSources()})},a.prototype.sourceContentFor=function(c,p){for(var f=0;f<this._sections.length;f++){var h=this._sections[f],d=h.consumer.sourceContentFor(c,!0);if(d)return d}if(p)return null;throw new Error('"'+c+'" is not in the SourceMap.')},a.prototype.generatedPositionFor=function(c){for(var p=0;p<this._sections.length;p++){var f=this._sections[p];if(f.consumer._findSourceIndex(e.getArg(c,"source"))!==-1){var h=f.consumer.generatedPositionFor(c);if(h){var d={line:h.line+(f.generatedOffset.generatedLine-1),column:h.column+(f.generatedOffset.generatedLine===h.line?f.generatedOffset.generatedColumn-1:0)};return d}}}return{line:null,column:null}},a.prototype._parseMappings=function(c,p){this.__generatedMappings=[],this.__originalMappings=[];for(var f=0;f<this._sections.length;f++)for(var h=this._sections[f],d=h.consumer._generatedMappings,g=0;g<d.length;g++){var v=d[g],S=h.consumer._sources.at(v.source);S=e.computeSourceURL(h.consumer.sourceRoot,S,this._sourceMapURL),this._sources.add(S),S=this._sources.indexOf(S);var _=null;v.name&&(_=h.consumer._names.at(v.name),this._names.add(_),_=this._names.indexOf(_));var b={source:S,generatedLine:v.generatedLine+(h.generatedOffset.generatedLine-1),generatedColumn:v.generatedColumn+(h.generatedOffset.generatedLine===v.generatedLine?h.generatedOffset.generatedColumn-1:0),originalLine:v.originalLine,originalColumn:v.originalColumn,name:_};this.__generatedMappings.push(b),typeof b.originalLine=="number"&&this.__originalMappings.push(b)}i(this.__generatedMappings,e.compareByGeneratedPositionsDeflated),i(this.__originalMappings,e.compareByOriginalPositions)},Jt.IndexedSourceMapConsumer=a,Jt}var ni={},pa;function zf(){if(pa)return ni;pa=1;var e=ca().SourceMapGenerator,t=Qt(),n=/(\r?\n)/,r=10,i="$$$isSourceNode$$$";function o(s,l,a,u,c){this.children=[],this.sourceContents={},this.line=s==null?null:s,this.column=l==null?null:l,this.source=a==null?null:a,this.name=c==null?null:c,this[i]=!0,u!=null&&this.add(u)}return o.fromStringWithSourceMap=function(l,a,u){var c=new o,p=l.split(n),f=0,h=function(){var _=m(),b=m()||"";return _+b;function m(){return f<p.length?p[f++]:void 0}},d=1,g=0,v=null;return a.eachMapping(function(_){if(v!==null)if(d<_.generatedLine)S(v,h()),d++,g=0;else{var b=p[f]||"",m=b.substr(0,_.generatedColumn-g);p[f]=b.substr(_.generatedColumn-g),g=_.generatedColumn,S(v,m),v=_;return}for(;d<_.generatedLine;)c.add(h()),d++;if(g<_.generatedColumn){var b=p[f]||"";c.add(b.substr(0,_.generatedColumn)),p[f]=b.substr(_.generatedColumn),g=_.generatedColumn}v=_},this),f<p.length&&(v&&S(v,h()),c.add(p.splice(f).join(""))),a.sources.forEach(function(_){var b=a.sourceContentFor(_);b!=null&&(u!=null&&(_=t.join(u,_)),c.setSourceContent(_,b))}),c;function S(_,b){if(_===null||_.source===void 0)c.add(b);else{var m=u?t.join(u,_.source):_.source;c.add(new o(_.originalLine,_.originalColumn,m,b,_.name))}}},o.prototype.add=function(l){if(Array.isArray(l))l.forEach(function(a){this.add(a)},this);else if(l[i]||typeof l=="string")l&&this.children.push(l);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+l);return this},o.prototype.prepend=function(l){if(Array.isArray(l))for(var a=l.length-1;a>=0;a--)this.prepend(l[a]);else if(l[i]||typeof l=="string")this.children.unshift(l);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+l);return this},o.prototype.walk=function(l){for(var a,u=0,c=this.children.length;u<c;u++)a=this.children[u],a[i]?a.walk(l):a!==""&&l(a,{source:this.source,line:this.line,column:this.column,name:this.name})},o.prototype.join=function(l){var a,u,c=this.children.length;if(c>0){for(a=[],u=0;u<c-1;u++)a.push(this.children[u]),a.push(l);a.push(this.children[u]),this.children=a}return this},o.prototype.replaceRight=function(l,a){var u=this.children[this.children.length-1];return u[i]?u.replaceRight(l,a):typeof u=="string"?this.children[this.children.length-1]=u.replace(l,a):this.children.push("".replace(l,a)),this},o.prototype.setSourceContent=function(l,a){this.sourceContents[t.toSetString(l)]=a},o.prototype.walkSourceContents=function(l){for(var a=0,u=this.children.length;a<u;a++)this.children[a][i]&&this.children[a].walkSourceContents(l);for(var c=Object.keys(this.sourceContents),a=0,u=c.length;a<u;a++)l(t.fromSetString(c[a]),this.sourceContents[c[a]])},o.prototype.toString=function(){var l="";return this.walk(function(a){l+=a}),l},o.prototype.toStringWithSourceMap=function(l){var a={code:"",line:1,column:0},u=new e(l),c=!1,p=null,f=null,h=null,d=null;return this.walk(function(g,v){a.code+=g,v.source!==null&&v.line!==null&&v.column!==null?((p!==v.source||f!==v.line||h!==v.column||d!==v.name)&&u.addMapping({source:v.source,original:{line:v.line,column:v.column},generated:{line:a.line,column:a.column},name:v.name}),p=v.source,f=v.line,h=v.column,d=v.name,c=!0):c&&(u.addMapping({generated:{line:a.line,column:a.column}}),p=null,c=!1);for(var S=0,_=g.length;S<_;S++)g.charCodeAt(S)===r?(a.line++,a.column=0,S+1===_?(p=null,c=!1):c&&u.addMapping({source:v.source,original:{line:v.line,column:v.column},generated:{line:a.line,column:a.column},name:v.name})):a.column++}),this.walkSourceContents(function(g,v){u.setSourceContent(g,v)}),{code:a.code,map:u}},ni.SourceNode=o,ni}var ga;function Vf(){return ga||(ga=1,Xt.SourceMapGenerator=ca().SourceMapGenerator,Xt.SourceMapConsumer=Ff().SourceMapConsumer,Xt.SourceNode=zf().SourceNode),Xt}(function(e,t){t.__esModule=!0;var n=Y,r=void 0;try{var i=Vf();r=i.SourceNode}catch(l){}r||(r=function(l,a,u,c){this.src="",c&&this.add(c)},r.prototype={add:function(a){n.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){n.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function o(l,a,u){if(n.isArray(l)){for(var c=[],p=0,f=l.length;p<f;p++)c.push(a.wrap(l[p],u));return c}else if(typeof l=="boolean"||typeof l=="number")return l+"";return l}function s(l){this.srcFile=l,this.source=[]}s.prototype={isEmpty:function(){return!this.source.length},prepend:function(a,u){this.source.unshift(this.wrap(a,u))},push:function(a,u){this.source.push(this.wrap(a,u))},merge:function(){var a=this.empty();return this.each(function(u){a.add(["  ",u,`
`])}),a},each:function(a){for(var u=0,c=this.source.length;u<c;u++)a(this.source[u])},empty:function(){var a=this.currentLocation||{start:{}};return new r(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var u=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return a instanceof r?a:(a=o(a,this,u),new r(u.start.line,u.start.column,this.srcFile,a))},functionCall:function(a,u,c){return c=this.generateList(c),this.wrap([a,u?"."+u+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var u=this,c=[];Object.keys(a).forEach(function(f){var h=o(a[f],u);h!=="undefined"&&c.push([u.quotedString(f),":",h])});var p=this.generateList(c);return p.prepend("{"),p.add("}"),p},generateList:function(a){for(var u=this.empty(),c=0,p=a.length;c<p;c++)c&&u.add(","),u.add(o(a[c],this));return u},generateArray:function(a){var u=this.generateList(a);return u.prepend("["),u.add("]"),u}},t.default=s,e.exports=t.default})(Kr,Kr.exports);var Hf=Kr.exports;(function(e,t){t.__esModule=!0;function n(f){return f&&f.__esModule?f:{default:f}}var r=we,i=Ne,o=n(i),s=Y,l=Hf,a=n(l);function u(f){this.value=f}function c(){}c.prototype={nameLookup:function(h,d){return this.internalNameLookup(h,d)},depthedLookup:function(h){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(h),")"]},compilerInfo:function(){var h=r.COMPILER_REVISION,d=r.REVISION_CHANGES[h];return[h,d]},appendToBuffer:function(h,d,g){return s.isArray(h)||(h=[h]),h=this.source.wrap(h,d),this.environment.isSimple?["return ",h,";"]:g?["buffer += ",h,";"]:(h.appendToBuffer=!0,h)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(h,d){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",h,",",JSON.stringify(d),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(h,d,g,v){this.environment=h,this.options=d,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!v,this.name=this.environment.name,this.isChild=!!g,this.context=g||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(h,d),this.useDepths=this.useDepths||h.useDepths||h.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||h.useBlockParams;var S=h.opcodes,_=void 0,b=void 0,m=void 0,T=void 0;for(m=0,T=S.length;m<T;m++)_=S[m],this.source.currentLocation=_.loc,b=b||_.loc,this[_.opcode].apply(this,_.args);if(this.source.currentLocation=b,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new o.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),v?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var P=this.createFunctionContext(v);if(this.isChild)return P;var A={compiler:this.compilerInfo(),main:P};this.decorators&&(A.main_d=this.decorators,A.useDecorators=!0);var U=this.context,K=U.programs,G=U.decorators;for(m=0,T=K.length;m<T;m++)K[m]&&(A[m]=K[m],G[m]&&(A[m+"_d"]=G[m],A.useDecorators=!0));return this.environment.usePartial&&(A.usePartial=!0),this.options.data&&(A.useData=!0),this.useDepths&&(A.useDepths=!0),this.useBlockParams&&(A.useBlockParams=!0),this.options.compat&&(A.compat=!0),v?A.compilerOptions=this.options:(A.compiler=JSON.stringify(A.compiler),this.source.currentLocation={start:{line:1,column:0}},A=this.objectLiteral(A),d.srcName?(A=A.toStringWithSourceMap({file:d.destName}),A.map=A.map&&A.map.toString()):A=A.toString()),A},preamble:function(){this.lastContext=0,this.source=new a.default(this.options.srcName),this.decorators=new a.default(this.options.srcName)},createFunctionContext:function(h){var d=this,g="",v=this.stackVars.concat(this.registers.list);v.length>0&&(g+=", "+v.join(", "));var S=0;Object.keys(this.aliases).forEach(function(m){var T=d.aliases[m];T.children&&T.referenceCount>1&&(g+=", alias"+ ++S+"="+m,T.children[0]="alias"+S)}),this.lookupPropertyFunctionIsUsed&&(g+=", "+this.lookupPropertyFunctionVarDeclaration());var _=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&_.push("blockParams"),this.useDepths&&_.push("depths");var b=this.mergeSource(g);return h?(_.push(b),Function.apply(this,_)):this.source.wrap(["function(",_.join(","),`) {
  `,b,"}"])},mergeSource:function(h){var d=this.environment.isSimple,g=!this.forceBuffer,v=void 0,S=void 0,_=void 0,b=void 0;return this.source.each(function(m){m.appendToBuffer?(_?m.prepend("  + "):_=m,b=m):(_&&(S?_.prepend("buffer += "):v=!0,b.add(";"),_=b=void 0),S=!0,d||(g=!1))}),g?_?(_.prepend("return "),b.add(";")):S||this.source.push('return "";'):(h+=", buffer = "+(v?"":this.initializeBuffer()),_?(_.prepend("return buffer + "),b.add(";")):this.source.push("return buffer;")),h&&this.source.prepend("var "+h.substring(2)+(v?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(h){var d=this.aliasable("container.hooks.blockHelperMissing"),g=[this.contextName(0)];this.setupHelperArgs(h,0,g);var v=this.popStack();g.splice(1,0,v),this.push(this.source.functionCall(d,"call",g))},ambiguousBlockValue:function(){var h=this.aliasable("container.hooks.blockHelperMissing"),d=[this.contextName(0)];this.setupHelperArgs("",0,d,!0),this.flushInline();var g=this.topStack();d.splice(1,0,g),this.pushSource(["if (!",this.lastHelper,") { ",g," = ",this.source.functionCall(h,"call",d),"}"])},appendContent:function(h){this.pendingContent?h=this.pendingContent+h:this.pendingLocation=this.source.currentLocation,this.pendingContent=h},append:function(){if(this.isInline())this.replaceStack(function(d){return[" != null ? ",d,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var h=this.popStack();this.pushSource(["if (",h," != null) { ",this.appendToBuffer(h,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(h){this.lastContext=h},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(h,d,g,v){var S=0;!v&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(h[S++])):this.pushContext(),this.resolvePath("context",h,S,d,g)},lookupBlockParam:function(h,d){this.useBlockParams=!0,this.push(["blockParams[",h[0],"][",h[1],"]"]),this.resolvePath("context",d,1)},lookupData:function(h,d,g){h?this.pushStackLiteral("container.data(data, "+h+")"):this.pushStackLiteral("data"),this.resolvePath("data",d,0,!0,g)},resolvePath:function(h,d,g,v,S){var _=this;if(this.options.strict||this.options.assumeObjects){this.push(p(this.options.strict&&S,this,d,g,h));return}for(var b=d.length;g<b;g++)this.replaceStack(function(m){var T=_.nameLookup(m,d[g],h);return v?[" && ",T]:[" != null ? ",T," : ",m]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(h,d){this.pushContext(),this.pushString(d),d!=="SubExpression"&&(typeof h=="string"?this.pushString(h):this.pushStackLiteral(h))},emptyHash:function(h){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(h?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var h=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(h.ids)),this.stringParams&&(this.push(this.objectLiteral(h.contexts)),this.push(this.objectLiteral(h.types))),this.push(this.objectLiteral(h.values))},pushString:function(h){this.pushStackLiteral(this.quotedString(h))},pushLiteral:function(h){this.pushStackLiteral(h)},pushProgram:function(h){h!=null?this.pushStackLiteral(this.programExpression(h)):this.pushStackLiteral(null)},registerDecorator:function(h,d){var g=this.nameLookup("decorators",d,"decorator"),v=this.setupHelperArgs(d,h);this.decorators.push(["fn = ",this.decorators.functionCall(g,"",["fn","props","container",v])," || fn;"])},invokeHelper:function(h,d,g){var v=this.popStack(),S=this.setupHelper(h,d),_=[];g&&_.push(S.name),_.push(v),this.options.strict||_.push(this.aliasable("container.hooks.helperMissing"));var b=["(",this.itemsSeparatedBy(_,"||"),")"],m=this.source.functionCall(b,"call",S.callParams);this.push(m)},itemsSeparatedBy:function(h,d){var g=[];g.push(h[0]);for(var v=1;v<h.length;v++)g.push(d,h[v]);return g},invokeKnownHelper:function(h,d){var g=this.setupHelper(h,d);this.push(this.source.functionCall(g.name,"call",g.callParams))},invokeAmbiguous:function(h,d){this.useRegister("helper");var g=this.popStack();this.emptyHash();var v=this.setupHelper(0,h,d),S=this.lastHelper=this.nameLookup("helpers",h,"helper"),_=["(","(helper = ",S," || ",g,")"];this.options.strict||(_[0]="(helper = ",_.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",_,v.paramsInit?["),(",v.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",v.callParams)," : helper))"])},invokePartial:function(h,d,g){var v=[],S=this.setupParams(d,1,v);h&&(d=this.popStack(),delete S.name),g&&(S.indent=JSON.stringify(g)),S.helpers="helpers",S.partials="partials",S.decorators="container.decorators",h?v.unshift(d):v.unshift(this.nameLookup("partials",d,"partial")),this.options.compat&&(S.depths="depths"),S=this.objectLiteral(S),v.push(S),this.push(this.source.functionCall("container.invokePartial","",v))},assignToHash:function(h){var d=this.popStack(),g=void 0,v=void 0,S=void 0;this.trackIds&&(S=this.popStack()),this.stringParams&&(v=this.popStack(),g=this.popStack());var _=this.hash;g&&(_.contexts[h]=g),v&&(_.types[h]=v),S&&(_.ids[h]=S),_.values[h]=d},pushId:function(h,d,g){h==="BlockParam"?this.pushStackLiteral("blockParams["+d[0]+"].path["+d[1]+"]"+(g?" + "+JSON.stringify("."+g):"")):h==="PathExpression"?this.pushString(d):h==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:c,compileChildren:function(h,d){for(var g=h.children,v=void 0,S=void 0,_=0,b=g.length;_<b;_++){v=g[_],S=new this.compiler;var m=this.matchExistingProgram(v);if(m==null){this.context.programs.push("");var T=this.context.programs.length;v.index=T,v.name="program"+T,this.context.programs[T]=S.compile(v,d,this.context,!this.precompile),this.context.decorators[T]=S.decorators,this.context.environments[T]=v,this.useDepths=this.useDepths||S.useDepths,this.useBlockParams=this.useBlockParams||S.useBlockParams,v.useDepths=this.useDepths,v.useBlockParams=this.useBlockParams}else v.index=m.index,v.name="program"+m.index,this.useDepths=this.useDepths||m.useDepths,this.useBlockParams=this.useBlockParams||m.useBlockParams}},matchExistingProgram:function(h){for(var d=0,g=this.context.environments.length;d<g;d++){var v=this.context.environments[d];if(v&&v.equals(h))return v}},programExpression:function(h){var d=this.environment.children[h],g=[d.index,"data",d.blockParams];return(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths"),"container.program("+g.join(", ")+")"},useRegister:function(h){this.registers[h]||(this.registers[h]=!0,this.registers.list.push(h))},push:function(h){return h instanceof u||(h=this.source.wrap(h)),this.inlineStack.push(h),h},pushStackLiteral:function(h){this.push(new u(h))},pushSource:function(h){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),h&&this.source.push(h)},replaceStack:function(h){var d=["("],g=void 0,v=void 0,S=void 0;if(!this.isInline())throw new o.default("replaceStack on non-inline");var _=this.popStack(!0);if(_ instanceof u)g=[_.value],d=["(",g],S=!0;else{v=!0;var b=this.incrStack();d=["((",this.push(b)," = ",_,")"],g=this.topStack()}var m=h.call(this,g);S||this.popStack(),v&&this.stackSlot--,this.push(d.concat(m,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var h=this.inlineStack;this.inlineStack=[];for(var d=0,g=h.length;d<g;d++){var v=h[d];if(v instanceof u)this.compileStack.push(v);else{var S=this.incrStack();this.pushSource([S," = ",v,";"]),this.compileStack.push(S)}}},isInline:function(){return this.inlineStack.length},popStack:function(h){var d=this.isInline(),g=(d?this.inlineStack:this.compileStack).pop();if(!h&&g instanceof u)return g.value;if(!d){if(!this.stackSlot)throw new o.default("Invalid stack pop");this.stackSlot--}return g},topStack:function(){var h=this.isInline()?this.inlineStack:this.compileStack,d=h[h.length-1];return d instanceof u?d.value:d},contextName:function(h){return this.useDepths&&h?"depths["+h+"]":"depth"+h},quotedString:function(h){return this.source.quotedString(h)},objectLiteral:function(h){return this.source.objectLiteral(h)},aliasable:function(h){var d=this.aliases[h];return d?(d.referenceCount++,d):(d=this.aliases[h]=this.source.wrap(h),d.aliasable=!0,d.referenceCount=1,d)},setupHelper:function(h,d,g){var v=[],S=this.setupHelperArgs(d,h,v,g),_=this.nameLookup("helpers",d,"helper"),b=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:v,paramsInit:S,name:_,callParams:[b].concat(v)}},setupParams:function(h,d,g){var v={},S=[],_=[],b=[],m=!g,T=void 0;m&&(g=[]),v.name=this.quotedString(h),v.hash=this.popStack(),this.trackIds&&(v.hashIds=this.popStack()),this.stringParams&&(v.hashTypes=this.popStack(),v.hashContexts=this.popStack());var P=this.popStack(),A=this.popStack();(A||P)&&(v.fn=A||"container.noop",v.inverse=P||"container.noop");for(var U=d;U--;)T=this.popStack(),g[U]=T,this.trackIds&&(b[U]=this.popStack()),this.stringParams&&(_[U]=this.popStack(),S[U]=this.popStack());return m&&(v.args=this.source.generateArray(g)),this.trackIds&&(v.ids=this.source.generateArray(b)),this.stringParams&&(v.types=this.source.generateArray(_),v.contexts=this.source.generateArray(S)),this.options.data&&(v.data="data"),this.useBlockParams&&(v.blockParams="blockParams"),v},setupHelperArgs:function(h,d,g,v){var S=this.setupParams(h,d,g);return S.loc=JSON.stringify(this.source.currentLocation),S=this.objectLiteral(S),v?(this.useRegister("options"),g.push("options"),["options=",S]):g?(g.push(S),""):S}},function(){for(var f="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),h=c.RESERVED_WORDS={},d=0,g=f.length;d<g;d++)h[f[d]]=!0}(),c.isValidJavaScriptVariableName=function(f){return!c.RESERVED_WORDS[f]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(f)};function p(f,h,d,g,v){var S=h.popStack(),_=d.length;for(f&&_--;g<_;g++)S=h.nameLookup(S,d[g],v);return f?[h.aliasable("container.strict"),"(",S,", ",h.quotedString(d[g]),", ",JSON.stringify(h.source.currentLocation)," )"]:S}t.default=c,e.exports=t.default})(Yr,Yr.exports);var Bf=Yr.exports;(function(e,t){t.__esModule=!0;function n(_){return _&&_.__esModule?_:{default:_}}var r=af,i=n(r),o=Ko,s=n(o),l=jt,a=qt,u=Bf,c=n(u),p=Zo,f=n(p),h=Yo,d=n(h),g=i.default.create;function v(){var _=g();return _.compile=function(b,m){return a.compile(b,m,_)},_.precompile=function(b,m){return a.precompile(b,m,_)},_.AST=s.default,_.Compiler=a.Compiler,_.JavaScriptCompiler=c.default,_.Parser=l.parser,_.parse=l.parse,_.parseWithoutProcessing=l.parseWithoutProcessing,_}var S=v();S.create=v,d.default(S),S.Visitor=f.default,S.default=S,t.default=S,e.exports=t.default})(Er,Er.exports);var Gf=Er.exports,ot=Hu(Gf),$f=Object.defineProperty,ma=Object.getOwnPropertySymbols,Wf=Object.prototype.hasOwnProperty,jf=Object.prototype.propertyIsEnumerable,va=(e,t,n)=>t in e?$f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ea=(e,t)=>{for(var n in t||(t={}))Wf.call(t,n)&&va(e,n,t[n]);if(ma)for(var n of ma(t))jf.call(t,n)&&va(e,n,t[n]);return e};class qf extends fr{constructor(){super(),ot.registerHelper("subVar",ed),ot.registerHelper("each",nd)}validateTransformerDetails(t){if(!this.isHandlebarsTransformerDetails(t))throw new X(J.InvalidTransformerTypeDetails,"Transformer Type Details is not the correct type.",{context:{expectedType:"HandlebarsTransformerDetails"}});this.validateHandlebarsTransformerDetails(t)}isHandlebarsTransformerDetails(t){return(t==null?void 0:t.html)!==void 0}validateHandlebarsTransformerDetails(t){if(!N(t))throw new X(J.InvalidTransformerTypeDetailsType,"Transformer Type Details is not a valid object.");if(!w(t.html))throw new X(J.MissingTransformerTypeDetailsHtml,"Transformer Type Details html is required for the specific Transformer Type Details.",{context:{type:"HandlebarsTransformerDetails"}});if(t.css!==void 0&&!w(t.css))throw new X(J.MissingTransformerTypeDetailsCss,"Transformer Type Details css must be a string when defined for the specific Transformer Type Details.",{context:{type:"HandlebarsTransformerDetails"}})}validateMethod(t){if(t===void 0)throw new D(M.MissingTransformationConfigMethod,"Transformation Config method is required for specific transformer type.",{context:{transformerType:Ce.Handlebars}})}setCSS(t){if(this.isHandlebarsTransformerDetails(t.transformerTypeDetails)){const n=t.transformerTypeDetails.css;if(w(n))try{const r=document.createElement("style");r.textContent=n;const i=fn();w(i)&&(y.log.debug("Adding nonce to inline style",r),r.nonce=i),document.head.appendChild(r)}catch(r){y.log.error(`could not apply styles ${n} for "${t.name}"`,r)}}}compileTransformerDetails(t,n,r,i){const o=document.createElement("script");i.update(new k("Precompiling template"));const s=ot.precompile(t);if(!w(s))throw new Error("Error while compiling handlebars template, precompilation did not result in a string");o.textContent="window.SalesforceInteractions.Personalization.precompiledTemplate = "+s;const l=fn();w(l)&&(y.log.debug("Adding nonce to inline script for handlebars precompile"),o.nonce=l),document.head.appendChild(o);const a=window.SalesforceInteractions.Personalization.precompiledTemplate;let u;try{if(!N(a))throw new Error("Error while compiling handlebars template, compiled template is undefined. This is likely due to a Content Security Policy (CSP) violation.");i.update(new k("Forming template")),u=ot.template(a)}finally{delete window.SalesforceInteractions.Personalization.precompiledTemplate,document.head.removeChild(o)}const c=fr.sanitizer.sanitizeObject(n);return i.update(new k("Using template")),u(c,r)}transform(t,n,r,i,o){const s=`personalization ${i.personalizationId}, transformation ${n.transformerName}`,l=this,a=function(){var u,c,p;const f=t.transformerTypeDetails.html,h=Ea({},(u=n.substitutionValues)!=null?u:{}),d=(c=t.substitutionDefinitions)!=null?c:{},g=gr(i.personalizationId);xi("DEBUG")&&y.log.debug(`For ${s}, rendering of template: \r
	${f} \r
SubstitutionValues: \r
	${JSON.stringify(h)} \r
Preview: ${String(g)}`),Object.entries(d).forEach(([A,U])=>{(!(A in h)||A in h&&(R(h[A])||h[A]===""))&&(h[A]=U.defaultValue)});const v=xe(),S=fo(o.pec.transformationConfig.engagementDestination,t.name,t.transformerType,v),_=Oo(),b=!((p=t.transformerTypeDetails.disableAutoInjectionOfEngagementAttributes)!=null&&p),m={data:{_sf_personalization:{subVar:h,destinationName:S,engagementConfig:v,ecSupportsAutoInjection:_,transformerSupportsAutoInjection:b,transformerInstance:l}}};let T=l.compileTransformerDetails(f,i,m,o.status);_&&b?T=Kf(l,T,i.personalizationId,S):(y.log.trace(`${_?"Transformer":"Engagement Config"} does not support auto-injection of default engagement attributes`),o.status.update(new k("No auto-injection of default engagement attributes")));const P=fn();return w(P)&&(T=Yf(T,P)),y.log.trace(`Rendered Content: ${T}`),o.status.update(new k("Rendered Content")),String(T)};return this.setCSS(t),this.setContent(r,a,n,o,i.personalizationId,o.pec.transformationConfig.method)}}function Yf(e,t){return ri(e,n=>{for(const r of n)r instanceof HTMLStyleElement&&(y.log.debug("Adding nonce to inline style",r),r.nonce=t)})}function Kf(e,t,n,r){return ri(t,i=>{for(let o=0;o<i.length;o++)e.autoInjectDefaultRootAttributes(i[o],n,r,!0)})}function On(e,t,n,r){if(!N(e))return;let i;for(const o of Object.values(e)){if(i!==void 0)break;if(F(o))if(n!==void 0)o[n]===r?i=t!=null?t:e:i=On(o[n],e,n,r);else for(const s of o){if(i!==void 0)break;if(s===r)return t!=null?t:e;i=On(s,e,void 0,r)}else N(o)&&(i=On(o,e,n,r))}return i}function Zf(e,t,n,r){var i,o,s,l;if(((i=r==null?void 0:r.data)==null?void 0:i.root)===void 0)return[e,!1];let a=Ea({},e),u=!1;if(t.startsWith("@root"))a=(o=r==null?void 0:r.data)==null?void 0:o.root,u=!0;else if(n.depth===1){const c=On((s=r==null?void 0:r.data)==null?void 0:s.root,void 0,(l=r==null?void 0:r.data)==null?void 0:l.index,e);c!==void 0&&(a=c)}return[a,u]}function Xf(e,t,n){let r=!1,i=!1;return n.parts.forEach(o=>{if(!i&&!(t&&o==="root")){const s=parseInt(o);!isNaN(s)&&F(e)?(e=e[s],r=!0):o in e?(e=e[o],r=!0):(i=!0,r=!1,e=void 0)}}),[e,r]}function Qf(e){let t;return w(e,!0)?t=e:R(e)?(y.log.debug("Null/undefined substitution value provided to handlebars"),t=""):(y.log.debug("Coercing ${} substitution value provided to handlebars"),t=String(e)),t}function Jf(e,t,n){const r=Qf(t);try{const i=ot.parseWithoutProcessing(`{{${r}}}`);if((i==null?void 0:i.body)===void 0||i.body.length===0||i.body[0].type!=="MustacheStatement")return y.log.warn(`Could not parse the substitution value path ${r} via handlebars`),null;const o=i.body[0];if(o.path===void 0)return y.log.warn(`Could not parse the substitution value path ${r} via handlebars treating it as a Mustache Statement`),null;const s=o.path;if(s.type!=="PathExpression")return y.log.warn(`Could not parse the substitution value path ${r} via handlebars expecting it to be a Path Expression`),null;const l=s,[a,u]=Zf(e,r,l,n),[c,p]=Xf(a,u,l);if(p)return c}catch(i){y.log.warn(`Could not parse the substitution value path ${r} due to an error`,i)}return null}function ed(e,t){var n,r;if(!w(e)||((r=(n=t==null?void 0:t.data)==null?void 0:n._sf_personalization)==null?void 0:r.subVar)===void 0||!(e in t.data._sf_personalization.subVar))return null;const i=t.data._sf_personalization.subVar[e];return Jf(this,i,t)}function td(e,t,n){let r=n;if(e._sf_personalization.ecSupportsAutoInjection&&e._sf_personalization.transformerSupportsAutoInjection){const i=e._sf_personalization.transformerInstance.buildModifiersIfItemRelated(t,e._sf_personalization.destinationName,e._sf_personalization.engagementConfig);!R(i)&&w(n)&&(r=ri(n,o=>{for(let s=0,l=o.length;s<l;s++){const a=o[s],u=s===0;e._sf_personalization.transformerInstance.autoInjectDefaultItemAttributes(a,void 0,i,u)}}))}else y.log.trace(`${e._sf_personalization.ecSupportsAutoInjection?"Transformer":"Engagement Config"} does not support auto-injection of default item engagement attributes`);return r}function ri(e,t){try{const n=document.createElement("div");return n.innerHTML=e,t(n.children),n.innerHTML}catch(n){return y.log.debug(`Could not parse/modify string as html (and might not be), so returning as-is: "${e}"`),e}}function nd(e,t){if(!N(t))throw new Error("Must pass iterator to #each");const n=t.fn,r=t.inverse;let i=0,o="",s;ot.Utils.isFunction(e)&&(e=e.call(this)),N(t.data)&&(s=ot.Utils.createFrame(t.data));const l=(a,u,c,p)=>{s!==void 0&&(s.key=a,s.index=c,s.first=c===0,s.last=!!p);const f=n(u,{data:s,blockParams:[e[a],a]}),h=td(s,u,f);o=o+h};if(!R(e)&&typeof e=="object"){const a=e;if(F(e,!0))for(let u=e.length;i<u;i++)i in e&&l(i,e[i],i,i===e.length-1);else if(Js(e,!0)){const u=e.size;for(const[c,p]of e)l(c,p,i++,i===u)}else if(el(e,!0)){const u=e.size;for(const c of e)l(i,c,i++,i===u)}else if(typeof Symbol=="function"&&a[Symbol.iterator.toString()]!==void 0){const u=[],c=a[Symbol.iterator.toString()]();for(let p=c.next();p.done===!1;p=c.next())u.push(p.value);e=u;for(let p=e.length;i<p;i++)l(i,e[i],i,i===e.length-1)}else{let u;Object.keys(a).forEach(c=>{u!==void 0&&l(u,a[u],i-1,!1),u=c,i++}),u!==void 0&&l(u,a[u],i-1,!0)}}return i===0&&(o=r(this)),o}function _a(e){switch(e){case Ce.HtmlElementModifier:return new Vu;case Ce.Handlebars:return new qf;default:return}}function ya(e){const t=_a(e);if(t===void 0)throw new X(J.MissingImplementation,"Transformer does not have an implementation",{context:{transformerType:e}});return t}let at=Object.assign([],dl);function Pn(){return at!=null?at:[]}function Ta(e,t=!1){function n(r){if(Ye()){if(!F(r,!0)){y.log.error("A list of transformers is required when adding to Transformers.");return}at===void 0&&(at=[]);let i=r;if(t){const o=at.map(s=>s.name);i=[],r.forEach(s=>{!w(s.name)||!o.includes(s.name)?i.push(s):y.log.debug(`Not adding Transformer "${s.name}" because it already exists`)})}i.forEach(o=>{try{if(ad(o),at.find(s=>o.name===s.name)!==void 0)throw new X(J.DuplicateTransformer,"Transformer already exists.",{context:{transformerName:o.name}});y.log.info("Adding the following Transformer: ",o),at.push(o)}catch(s){y.log.error(`Transformers could not be added due to: ${Q(s).message}`,o)}})}else y.log.error("The list of Transformers can only be modified before SalesforceInteractions.init is called.")}if(w(e))try{const r=JSON.parse(e,Ri);n(r)}catch(r){y.log.error("JSON Transformers list could not be added due to: ",r)}else n(e)}function Sa(e){Ta(e)}function rd(e){Ta(e,!0)}function wa(e=hn.SchemaPath){switch(e){case hn.SchemaPath:return dn.String;default:throw new X(J.InvalidSubstitutionConfigType,"Substitution Definition config type is not supported.",{context:{configType:e}})}}function ba(e=dn.String,t){switch(e){case dn.String:if(!w(t))throw new X(J.InvalidSubstitutionDefinitionValue,"Substitution Definition value is incorrect type.",{context:{expectedType:e,value:t}});break;default:throw new X(J.InvalidSubstitutionDefinitionConfigDataType,"",{context:{configDataType:e}})}}function id(e){var t;if(!N(e))throw new X(J.MissingTransformerSubstitutionDefinition,"Transformer substitution definition object is required.");if(e.label!==void 0&&!w(e.label))throw new X(J.InvalidSubstitutionDefinitionLabel,"Transformer substitution definition label is required to be a string if provided.");if(e.description!==void 0&&!w(e.description))throw new X(J.InvalidSubstitutionDefinitionDescription,"Transformer substitution definition description is required to be a string if provided.");if(e.configType!==void 0&&!((t=Object.values(hn))!=null&&t.includes(e.configType)))throw new X(J.InvalidSubstitutionDefinitionConfigType,"Transformer substitution definition config type should be a valid Substitution Definition Config Type if provided.",{context:{configType:e.configType}});e.defaultValue!==void 0&&ba(wa(e.configType),e.defaultValue)}function od(e){if(!N(e))throw new X(J.InvalidSubstitutionDefinitions,"Transformer substitution definitions is not a record.");Object.entries(e).forEach(([t,n])=>{if(!w(t))throw new X(J.MissingTransformerSubstitutionDefinitionKey,"Transformer substitution definition key is required.");id(n)})}function ad(e){var t;if(!N(e))throw new X(J.MissingTransformer,"Transformer is required.");if(!w(e.name))throw new X(J.MissingTransformerName,"Transformer name is required.");if(!((t=Object.values(Ce))!=null&&t.includes(e.transformerType)))throw new X(J.InvalidTransformerType,"Transformer type is not a valid Transformer Type.",{context:{transformerType:e.transformerType}});if(e.substitutionDefinitions!==void 0&&od(e.substitutionDefinitions),!N(e.transformerTypeDetails))throw new X(J.MissingTransformerTypeDetails,"Transformer transformer type details are required.");if(e.publishedDate!==void 0)try{e.publishedDate=Mt("publishedDate",e.publishedDate)}catch(n){throw new X(J.InvalidPublishedDate,"Transformer published date should be a number or date if provided.")}if(e.lastModifiedDate!==void 0)try{e.lastModifiedDate=Mt("lastModifiedDate",e.lastModifiedDate)}catch(n){throw new X(J.InvalidLastModifiedDate,"Transformer last modified date should be a number or date if provided.")}ya(e.transformerType).validateTransformerDetails(e.transformerTypeDetails)}var ye=(e=>(e.PageType="PageType",e.PageUrlMatcher="PageUrlMatcher",e))(ye||{});const Ia=/\*\s*\*/;function sd(e){var t;if(!N(e))throw new D(M.InvalidSourceMatchers,"Source Matchers is not a valid array.");if(!((t=Object.values(ye))!=null&&t.includes(e.type)))throw new D(M.InvalidSourceMatcherType,"Source Matcher type is not a valid Source Matcher Type.",{context:{sourceMatcherType:e.type}});if(!w(e.value))throw new D(M.MissingSourceMatcherValue,"Source Matcher value is required.");if(e.value!==e.value.trim())throw new D(M.PaddedSourceMatcherValue,"Source Matcher value has leading or trailing spaces.",{context:{sourceMatcherValue:e.value}});if(e.type===ye.PageUrlMatcher){if(e.value==="*")throw new D(M.InvalidSourceMatcherValueOnlyStar,"Source Matcher value cannot be only * char.");if(e.value.includes("**"))throw new D(M.InvalidSourceMatcherValueRepeatedStars,"Source Matcher value cannot have repeated * chars.");if(Ia.lastIndex=0,Ia.test(e.value))throw new D(M.InvalidSourceMatcherValueSpaceWithStars,"Source Matcher value cannot have * followed by a space followed by a *.")}}function ld(e){if(!F(e))throw new D(M.MissingSourceMatchers,"Source Matchers are required.");e.forEach(t=>sd(t))}function Aa(e,t,n){switch(e.type){case ye.PageType:return dd(e,t);case ye.PageUrlMatcher:return fd(e,n);default:return y.log.warn(`Support missing for SourceMatcherType: ${e.type}`),!1}}function ud(e){if(e.type!==ye.PageUrlMatcher){y.log.warn("Ignoring SourceMatcher, since type is not PageUrlMatcher");return}let t=encodeURIComponent(e.value.trim());return t=t.replace(/[.()!']/g,"\\$&"),t=t.replace(/\*/g,".*"),new RegExp(t,"i")}function cd(e){if(w(e))return encodeURIComponent(e)}function fd(e,t){const n=cd(t);if(!w(n))return y.log.debug("Ignoring match, url is not a non-empty string"),!1;const r=ud(e);return R(r)?!1:r.test(n)}function dd(e,t){return w(t)?t===e.value.trim():(y.log.debug("Ignoring match, pageType is not a non-empty string"),!1)}function hd(e){var t;return(t=e==null?void 0:e.contentZones)!=null?t:[]}function Ca(e,t=!0){return hd(e).reduce((n,r)=>{const[i,o]=pd(r,t);return w(i==null?void 0:i.name)&&o&&n.push(r),n},[])}function pd(e,t=!0){const n=N(e)?e:{name:"",selector:""},r=w(n==null?void 0:n.selector);w(n==null?void 0:n.name)&&!r&&y.log.debug(`Content Zone ${n.name} has no Selector configured`);const i=r&&(!t||gd(n==null?void 0:n.selector));return[e,i]}const gd=e=>y.cashDom(e).length>0;function Oa(e){if(!w(e))return null;const t=y.getSitemapResult().matchedConfig;if(t.contentZones!==void 0){const n=t.contentZones;if(!F(n))return null;const r=n.find(i=>i.name===e);return w(r==null?void 0:r.selector)?r.selector:null}return null}function ii(e,t=!0){return Ca(e,t).map(n=>n.name)}function md(e,t=!0){return oi([e],void 0,void 0,!0,t)}function vd(e,t=!0){return oi(e,void 0,void 0,!0,t)}function Ed(e){return N(e)?oi(e.pageTypes,e.global,e.pageTypeDefault,!0,!1):[]}function oi(e,t,n,r=!0,i=!0){const o=[];if(N(t)&&o.push(...ii(t,i)),F(e)&&e.forEach(s=>{o.push(...ii(s,i))}),N(n)&&o.push(...ii(n,i)),r){const s=_d(o);if(s.length>0)return y.log.warn(`The following content zones are duplicated which are not supported by personalization: ${yd(s).join(", ")}`),Td(o,s)}return o}function _d(e){return e.filter((t,n)=>e.indexOf(t)!==n)}function yd(e){return e.filter((t,n)=>e.indexOf(t)===n)}function Td(e,t){return e.filter(n=>!t.includes(n))}var Sd=Object.defineProperty,wd=Object.defineProperties,bd=Object.getOwnPropertyDescriptors,Pa=Object.getOwnPropertySymbols,Id=Object.prototype.hasOwnProperty,Ad=Object.prototype.propertyIsEnumerable,Na=(e,t,n)=>t in e?Sd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Da=(e,t)=>{for(var n in t||(t={}))Id.call(t,n)&&Na(e,n,t[n]);if(Pa)for(var n of Pa(t))Ad.call(t,n)&&Na(e,n,t[n]);return e},Ma=(e,t)=>wd(e,bd(t)),ai=(e=>(e.DataCloudModuleConfig="DATA_CLOUD_MODULE_CONFIG",e.Other="OTHER",e))(ai||{});let en=[];const Nn={DATA_CLOUD_MODULE_CONFIG:null,OTHER:[]};function Ie(){return en!=null?en:[]}function Cd(e){en=[...e]}function Od(e,t){const n=F(t,!0)?t:Ie();if(!(!F(n)||!w(e)))return n.find(r=>jn(r.name,e))}function La(e,t){return w(e)?(F(t,!0)?t:Ie()).filter(n=>n.sourceMatchers.some(r=>r.type===ye.PageUrlMatcher&&Aa(r,"",e))):[]}function Ra(e,t){return w(e)?(F(t,!0)?t:Ie()).filter(n=>n.sourceMatchers.some(r=>r.type===ye.PageType&&Aa(r,e,""))):[]}function Pd(e,t){return Object.values(ye).includes(e)?(F(t,!0)?t:Ie()).filter(n=>n.sourceMatchers.some(r=>r.type===e)):[]}function Nd(e){var t,n,r;if(!N(e))throw new D(M.MissingDataProvider,"DataProvider is required.");if(e.type!==void 0&&!((t=Object.values(Jn))!=null&&t.includes(e.type)))throw new D(M.InvalidDataProviderType,"Data Provider type should be a valid Data Provider Type if provided.",{context:{type:e.type}});if(e.referenceType!==void 0&&!((n=Object.values(er))!=null&&n.includes(e.referenceType)))throw new D(M.InvalidDataProviderReferenceType,"Data Provider reference type should be a valid Reference Type if provided.",{context:{referenceType:e.referenceType}});if(!w(e.value))throw new D(M.MissingDataProviderValue,"Data Provider value is required.");if(e.dataSpaceReferenceType!==void 0&&!((r=Object.values(er))!=null&&r.includes(e.dataSpaceReferenceType)))throw new D(M.InvalidDataProviderDataSpaceReferenceType,"Data Provider data space reference type should be a valid Reference Type if provided.",{context:{referenceType:e.dataSpaceReferenceType}});if(!w(e.dataSpaceValue)&&e.dataSpaceReferenceType!==void 0)throw new D(M.MissingDataSpaceValue,"Data Provider data space value is required if Data Provider data space reference type is set.");if(w(e.dataSpaceValue)&&e.dataSpaceReferenceType===void 0)throw new D(M.MissingDataSpaceReferenceType,"Data Provider data space reference type is required if Data Provider data space value is set.")}function Dd(e){if(ae(e,"name"))throw new D(M.TransformationNameNotSupported,"Transformation Name is not supported for method type.",{context:{methodType:q.AddOverlay}});if(ae(e,"tag"))throw new D(M.TransformationTagNotSupported,"Transformation Tag is not supported for method type.",{context:{methodType:q.AddOverlay}});if(ae(e,"path"))throw new D(M.TransformationPathNotSupported,"Transformation Path is not supported for method type.",{context:{methodType:q.AddOverlay}})}function Md(e){if(!w(e.name))throw new D(M.MissingTransformationName,"Transformation Name is required.",{context:{transformationType:"ContentZone"}})}function Ld(e){if(!w(e.tag))throw new D(M.MissingTransformationTag,"Transformation Tag is required.",{context:{transformationType:"Element"}});if(!w(e.path))throw new D(M.MissingTransformationPath,"Transformation Path is required.",{context:{transformationType:"Element"}})}function Rd(e){if(!w(e))throw new D(M.MissingTransformerName,"Transformer Name is required.");const t=Pn();if(t.length===0)throw new D(M.TransformersNotAvailable,"There are no transformers available.");const n=t.find(r=>r.name===e);if(n===void 0)throw new D(M.InvalidTransformerName,"Transformation Transformer Name is not a valid transformer.",{context:{transformerName:e}});return n}function xa(e,t,n){Object.entries(t).forEach(([r,i])=>{if(!(r in e)){if(i.defaultValue===void 0)throw new D(M.MissingSubstitutionDefinitionDefaultValue,"Substitution Definition default value is required.",{context:{key:r}});y.log.debug(`using default value for Substitution Definition of ${r} for Transformer ${n}`)}})}function xd(e,t){var n;if(e===void 0){t.substitutionDefinitions!==void 0&&xa({},t.substitutionDefinitions,t.name);return}if(!N(e))throw new D(M.InvalidTransformationSubstitutionValues,"Substitution Values is not a valid object.");if(t.substitutionDefinitions!==void 0){const r=(n=t.substitutionDefinitions)!=null?n:{};Object.entries(e).forEach(([i,o])=>{if(i in r){const s=r[i];ba(wa(s.configType),o)}else throw new D(M.SubstitutionDefinitionKeyNotSupported,"Transformer does not support Substitution Definition Key.",{context:{key:i}})}),xa(e,t.substitutionDefinitions,t.name)}else if(t.transformerType!==Ce.HtmlElementModifier)if(Object.entries(e).length===0)y.log.warn(`transformer "${t.name}" does not accept substitutionValues`);else throw new D(M.TransformerDoesNotSupportSubstitutionValues,"Substitution Values are provided when transformer does not support Substitution Definitions.")}function ka(e,t){const n=Rd(e.transformerName);xd(e.substitutionValues,n);const r=ya(n.transformerType);r.validateMethod(t),r.validateSubstitutionValues(e.substitutionValues)}function kd(e,t){if(!N(e))throw new D(M.MissingTransformation,"Transformation is required.");if(pt(t))Dd(e);else if(Je(e))Md(e);else if(Ke(e))Ld(e);else throw new D(M.InvalidTransformationType,"Transformation is not one of the supported types.");Ye()||ka(e,t)}function Ud(e,t){if(!F(e))throw new D(M.InvalidTransformations,"Transformations is required to be an array.");if(e.forEach(n=>kd(n,t)),t!==void 0&&t!==q.AddOverlay){if(t===q.ReplaceContentZoneContent&&!e.every(n=>Je(n)))throw new D(M.MethodRequiresSpecificTransformations,"Method requires specific transformation type(s).",{context:{transformationType:"ContentZone",methods:[q.ReplaceContentZoneContent]}});if(t!==q.ReplaceContentZoneContent&&!e.every(n=>Ke(n)))throw new D(M.MethodRequiresSpecificTransformations,"Method requires specific transformation type(s).",{context:{transformationType:"Element",methods:[q.ReplaceElementContent,q.AddAfterElement,q.AddBeforeElement]}})}}function Fd(e){var t,n;if(!N(e))throw new D(M.MissingTransformationConfig,"Transformation Config is required.");if(e.renderIfEmpty!==void 0&&!an(e.renderIfEmpty))throw new D(M.InvalidRenderIfEmpty,"Transformation Config Render If Empty should be a boolean if provided.");if(!((t=Object.values(Oe))!=null&&t.includes(e.when)))throw new D(M.InvalidTransformationConfigWhen,"Transformation Config has an invalid Transformation Config When Type.",{context:{whenType:e.when}});if(e.method!==void 0&&!((n=Object.values(q))!=null&&n.includes(e.method)))throw new D(M.InvalidTransformationConfigMethod,"Transformation Config has an invalid Target Method Type.",{context:{methodType:e.method}});switch(e.when){case Oe.Immediately:if(e.whenValues!==void 0)throw new D(M.WhenValuesNotSupported,"Transformation Config does not support when values for the specific Transformation Config When Type.",{context:{whenType:e.when}});break;case Oe.ExitIntent:if(!pt(e.method))throw new D(M.WhenTypeRequiresSpecificMethodType,"Transformation Config when type requires specific method type.",{context:{whenType:e.when,methodType:q.AddOverlay}});if(!Wi(e.whenValues))throw new D(M.InvalidTransformationConfigWhenTypes,"Transformation Config when values is invalid for the specific Transformation Config When Type.",{context:{whenType:e.when}});if(!Dt(e.whenValues.delay)||e.whenValues.delay<0)throw new D(M.InvalidWhenValueDelay,"Transformation Config requires a numeric when values delay of 0 or greater for the specific Transformation Config When Type.",{context:{whenType:e.when}});break;case Oe.ElementClick:if(!pt(e.method))throw new D(M.WhenTypeRequiresSpecificMethodType,"Transformation Config when type requires specific method type.",{context:{whenType:e.when,methodType:q.AddOverlay}});if(!Gi(e.whenValues))throw new D(M.InvalidTransformationConfigWhenTypes,"Transformation Config when values is invalid for the specific Transformation Config When Type.",{context:{whenType:e.when}});if(!w(e.whenValues.path))throw new D(M.InvalidWhenValuePath,"Transformation Config requires a string when values path for the specific Transformation Config When Type.",{context:{whenType:e.when}});if(e.whenValues.tag!==void 0&&!w(e.whenValues.tag))throw new D(M.InvalidWhenValueTag,"Transformation Config requires a string when values tag, if provided, for the specific Transformation Config When Type.",{context:{whenType:e.when}});break;case Oe.ScrollPercent:if(!pt(e.method))throw new D(M.WhenTypeRequiresSpecificMethodType,"Transformation Config when type requires specific method type.",{context:{whenType:e.when,methodType:q.AddOverlay}});if(!$i(e.whenValues))throw new D(M.InvalidTransformationConfigWhenTypes,"Transformation Config when values is invalid for the specific Transformation Config When Type.",{context:{whenType:e.when}});if(!Dt(e.whenValues.percent)||e.whenValues.percent<0||e.whenValues.percent>1)throw new D(M.InvalidWhenValuePercent,"Transformation Config requires a numeric when values percent between 0 and 1 for the specific Transformation Config When Type.",{context:{whenType:e.when}});break;default:throw new D(M.WhenValuesValidationLogicNotImplemented,"Transformation Config when values validation logic has not been implemented for the specific Transformation Config When Type.",{context:{whenType:e.when}})}if(e.engagementDestination!==void 0&&!w(e.engagementDestination))throw new D(M.InvalidTransformationConfigEngagementDestination,"Transformation Config engagement destination should be a valid string if provided.");Ud(e.transformations,e.method)}function si(e,t,n,r){if(!N(e))throw new D(M.MissingConfig,"Config is required.");if(!w(e.name))throw new D(M.MissingName,"Name is required.");if(Nd(e.dataProvider),ld(e.sourceMatchers),Fd(e.transformationConfig),e.publishedDate!==void 0&&!sn(e.publishedDate))try{e.publishedDate=Mt("publishedDate",e.publishedDate)}catch(i){throw new D(M.InvalidPublishedDate,"Published date should be a number or date if provided.")}if(e.lastModifiedDate!==void 0&&!sn(e.lastModifiedDate))try{e.lastModifiedDate=Mt("lastModifiedDate",e.lastModifiedDate)}catch(i){throw new D(M.InvalidLastModifiedDate,"Last modified date should be a number or date if provided.")}if(t!=null&&t&&n!==void 0){const i=[];if(za(e,n,[],i),i.length>0)throw i[0]}if(r!=null&&r){const i=[];if(Va(e,[],i),i.length>0)throw i[0]}}function li(e){var t,n;if(((t=e==null?void 0:e.dataProvider)==null?void 0:t.type)!==void 0&&((n=e==null?void 0:e.dataProvider)==null?void 0:n.type)!==Jn.PersonalizationPoint)throw new un(Kn.OnlySupportPersonalizationPoint,"Personalization Experience Config has Data Provider Type that is not Personalization Point, which is not currently supported.",{context:{configName:e.name}});Ye()||Ua(e)}function Ua(e){var t,n,r;const i=R((t=e==null?void 0:e.dataProvider)==null?void 0:t.dataSpaceValue)?"":(n=e==null?void 0:e.dataProvider)==null?void 0:n.dataSpaceValue;if(xt()!==i)throw new un(Kn.OnlySupportConfiguredDataSpace,"Personalization Experience Config has Data Provider Data Space Value that does not match Sitemap value, which is not currently supported.",{context:{configName:e.name,configDataSpace:(r=e==null?void 0:e.dataProvider)==null?void 0:r.dataSpaceValue,configuredDataSpace:xt()}})}function ui(e,t="OTHER"){function n(r){if(Ye()){if(!F(r,!0)){y.log.error("A list of personalization experience configs is required.");return}t==="OTHER"&&Nn.OTHER.push(...r);const i=[];r.forEach(o=>{!w(o.name)||en.findIndex(s=>jn(s.name,o.name))<0&&i.findIndex(s=>jn(s.name,o.name))<0?i.push(o):y.log.error(`Not adding Personalization Experience Config "${o.name}" because it already exists`)}),i.forEach(o=>{try{si(o),li(o),y.log.info("Adding the following Personalization Experience Config: ",o),en.push(o)}catch(s){y.log.error(`Personalization Experience Configs could not be added due to: ${Q(s).message}`,o)}})}else y.log.error("The list of Personalization Experience Configs can only be modified before SalesforceInteractions.init is called.")}if(w(e))try{const r=JSON.parse(e,Ri);n(r)}catch(r){y.log.error(`JSON Personalization Experience Config list could not be initialized due to: ${Q(r).message}`,r)}else n(e)}function zd(e){ui(e)}function Vd(){document.addEventListener(y.CustomEvents.OnInit,()=>{qd(),$d(),Kd()}),document.addEventListener(y.CustomEvents.OnInitSitemap,e=>{Bd(e.detail.sitemapConfig)})}function Fa(e){if(!F(e))return y.log.debug("Ignoring non/empty array of personalizationExperienceConfigs"),{};const t={};return e.forEach(n=>{if(!hl(n.dataProvider.type))y.log.warn(`Ignoring config: ${n.name} with unsupported dataProvider.type: ${String(n.dataProvider.type)}`);else{const r=n.dataProvider.value;let i=t[r];R(i)&&(i={point:{name:r},pecNames:[]},t[r]=i),i.pecNames.includes(n.name)||i.pecNames.push(n.name)}}),t}function Dn(e){const t=e.filter(n=>w(n.getConfigName()));if(t.length>0){t.forEach(r=>{const i=r.getConfigName(),o=Ie().find(s=>s.name===i);o===void 0?y.log.error(`Could not find Personalization Experience Config with name ${i}`):y.log.error(`Personalization Experience Config with name ${i} is invalid due to: ${r.getMessageWithContext()} Config: `,o)});const n=t.map(r=>r.getConfigName());Cd(Ie().filter(r=>!n.includes(r.name)))}}function za(e,t,n,r){e.transformationConfig.transformations.forEach(i=>{Je(i)&&(n.length===0&&Ed(t).forEach(o=>n.push(o)),n.length===0?r.push(new D(M.ContentZonesNotAvailable,"There are no content zones configured in the sitemap or content zone is defined more than once.",{context:{configName:e.name}})):n.find(o=>o===i.name)===void 0&&r.push(new D(M.InvalidTransformationContentZone,"Content zone is not defined in the sitemap or content zone is defined more than once.",{context:{configName:e.name,contentZone:i.name}})))})}function Hd(e){const t=[],n=[];return Ie().forEach(r=>{za(r,e,t,n)}),n}function Bd(e){const t=Hd(e);Dn(t)}function Va(e,t,n){w(e.transformationConfig.engagementDestination)&&(t.length===0&&No().forEach(r=>t.push(r)),t.length===0?n.push(new D(M.EngagementDestinationsNotAvailable,"There are no engagement destinations configured.",{context:{configName:e.name}})):t.find(r=>r===e.transformationConfig.engagementDestination)===void 0&&n.push(new D(M.InvalidTransformationConfigEngagementDestinationName,"Engagement destination is not defined.",{context:{configName:e.name,engagementDestination:e.transformationConfig.engagementDestination}})))}function Gd(){const e=[],t=[];return Ie().forEach(n=>{Va(n,e,t)}),t}function $d(){const e=Gd();Dn(e)}function Ha(){return Nn}function Wd(e,t){e==="DATA_CLOUD_MODULE_CONFIG"&&"list"in t&&F(t.list,!0)?Nn.DATA_CLOUD_MODULE_CONFIG=t:e==="OTHER"&&F(t,!0)&&(Nn.OTHER=t)}function jd(){const e=[];return Ie().forEach(t=>{var n;try{const r=t.transformationConfig.method;t.transformationConfig.transformations.forEach(i=>{ka(i,r)})}catch(r){if(r instanceof Error)if(r instanceof D||r instanceof X){const i={context:Ma(Da({},r.context),{configName:t.name}),cause:(n=r.cause)!=null?n:r},o=r instanceof D?new D(r.name,r.message,i):new X(r.name,r.message,i);e.push(o)}else e.push(new D(M.UnexpectedError,r.message,{context:{configName:t.name}}))}}),e}function qd(){const e=jd();Dn(e)}function Yd(){const e=[];return Ie().forEach(t=>{var n;try{Ua(t)}catch(r){if(r instanceof Error)if(r instanceof un){const i=new un(r.name,r.message,{context:Ma(Da({},r.context),{configName:t.name}),cause:(n=r.cause)!=null?n:r});e.push(i)}else e.push(new D(M.UnexpectedError,r.message,{context:{configName:t.name}}))}}),e}function Kd(){const e=Yd();Dn(e)}var V=(e=>(e.SingleElementHtmlTransformer="SingleElementHtmlTransformer",e.MultiElementModifier="MultiElementModifier",e.WhenElementClick="WhenElementClick",e))(V||{}),Mn=(e=>(e.Test="test",e.Prod="prod",e))(Mn||{});const Zd={configOptions:{SingleElementHtmlTransformer:{allowedElements:{div:{},p:{},header:{},footer:{},section:{},article:{},nav:{},table:{}}},MultiElementModifier:{allowedElements:{h1:{allowedProperties:["innerText"]},h2:{allowedProperties:["innerText"]},h3:{allowedProperties:["innerText"]},h4:{allowedProperties:["innerText"]},h5:{allowedProperties:["innerText"]},h6:{allowedProperties:["innerText"]},p:{allowedProperties:["innerText"]},div:{allowedProperties:["innerText","style.backgroundImage"]},a:{allowedProperties:["innerText","attributes.href"]},img:{allowedProperties:["attributes.src"]}}},WhenElementClick:{allowedElements:{input:{},button:{},img:{}}}}};var Ba=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});const ee={pageUrl:{},pageType:{}};function Ga(){return Ba(this,null,function*(){return R(ee.pageUrl.matchedPromise)?yield Promise.reject(new Error("getPromiseUrlMatch called too soon")):yield ee.pageUrl.matchedPromise})}function $a(){return Ba(this,null,function*(){return R(ee.pageType.matchedPromise)?yield Promise.reject(new Error("getPromisePageMatch called too soon")):yield ee.pageType.matchedPromise})}const Ln="sf_personalization_wpm";function Xd(){fi(!1);const e=Qs(Ln);window.history.replaceState({},document==null?void 0:document.title,e.toString()),window.location.reload()}function ci(){try{return window.localStorage.getItem(Ln)==="true"}catch(e){return!1}}function fi(e){try{window.localStorage.setItem(Ln,e?"true":"false")}catch(t){throw y.log.error("Error trying to save client side editor mode.",t),t}}const Wa="sf_personalization_wpm_env",ja="2",Qd=`https://cdn.c360a.salesforce.com/npm/@salesforce/interactions-website-personalization-manager/${ja}/build/dist/index.min.js`,Jd=`https://cdn.pc-rnd.c360a.salesforce.com/npm/@salesforce/interactions-website-personalization-manager/${ja}/build/dist/index.min.js`,qa={configOptions:{}};let Rn=Zd;function Ya(){return Rn!=null?Rn:qa}function eh(e){e===void 0?Rn=qa:Rn=e}function th(){Mi(Ln)&&fi(!0),document.addEventListener(y.CustomEvents.OnInit,Xa)}function Ka(){if(Mi(Wa)){const e=Zs(Wa);if(e!==null){const t=e.toLowerCase();if(Object.values(Mn).includes(t))return t}}return Mn.Prod}function nh(){const e=Ka()===Mn.Test?Jd:Qd;return y.log.debug(`WPM (client side editor) CDN Script is set to ${e}`),e}function rh(e,t){return yn(e,t,xe())}function ih(){const e=Pn();if(e.length>0){const t=e.find(n=>n.transformerType===Ce.HtmlElementModifier);if(t!==void 0)return yn(t.name,t.transformerType,xe())}return yn("",Ce.HtmlElementModifier,xe())}function Za(){var e;const t={closeEditorMode:Xd,determineEditorOption:Ja,getConfig:Ya,getAppSourceId:ll,getPspConfig:ul,isInEditorMode:ci,isPECSupported:gh,checkPECSupport:ts,getPromiseUrlMatch:Ga,getPromisePageMatch:$a,findContentZoneNamesForPageConfig:md,findContentZoneNamesForPageConfigs:vd,getEngagementDestinationNames:No,determineHtmlElementModifierTransformerEngagementDestination:ih,determineTransformerEngagementDestination:rh,findPersonalizationExperienceConfigsMatchingPageType:Ra,findPersonalizationExperienceConfigsMatchingPageUrl:La,getContentZoneSelectorByName:Oa,getPersonalizationExperienceConfigsByInitializationSource:Ha,matchesDataCloudHostname:mh,determineWpmEnvironment:Ka};(e=window.SalesforceInteractions.Wpm)==null||e.initialize(t)}function Xa(){var e;if(ci())if(((e=window.SalesforceInteractions.Wpm)==null?void 0:e.initialize)!==void 0)Za();else{const t=document.createElement("script");t.src=nh(),t.type="text/javascript",t.onload=Za,t.onerror=n=>{y.log.error("Error trying to initialize WPM (client side editor)",n)},document.head.appendChild(t)}}function oh(){fi(!0),Xa()}function ah(e){if(!N(e))throw new ve(ce.InvalidConfig,"Config is invalid.",{context:{configType:V.SingleElementHtmlTransformer}});if((e==null?void 0:e.allowedElements)!==void 0){const t=e==null?void 0:e.allowedElements;if(!N(t))throw new ve(ce.InvalidAllowedElements,"Allowed Elements is invalid.",{context:{configType:V.SingleElementHtmlTransformer}});Object.entries(t).forEach(([n])=>{if(!N(t[n]))throw new ve(ce.InvalidAllowedElementKey,"Allowed Elements key is invalid.",{context:{configType:V.SingleElementHtmlTransformer,key:n}})})}if((e==null?void 0:e.allowedTargetMethodTypes)!==void 0){if(!F(e==null?void 0:e.allowedTargetMethodTypes,!0))throw new ve(ce.InvalidAllowedTargetMethodTypes,"Allowed Target Method Types is invalid.",{context:{configType:V.SingleElementHtmlTransformer}});e==null||e.allowedTargetMethodTypes.forEach(t=>{var n;if(!((n=Object.values(q))!=null&&n.includes(t)))throw new ve(ce.InvalidAllowedTargetMethodTypeMethod,"Allowed Target Method Types method is not a valid Target Method Type.",{context:{configType:V.SingleElementHtmlTransformer,method:t}})})}if((e==null?void 0:e.allowedTransformers)!==void 0&&!F(e==null?void 0:e.allowedTransformers,!0))throw new ve(ce.InvalidAllowedTransformers,"Allowed Transformers is invalid.",{context:{configType:V.SingleElementHtmlTransformer}})}function sh(e){if(!N(e))throw new ve(ce.InvalidConfig,"Config is invalid.",{context:{configType:V.MultiElementModifier}});if((e==null?void 0:e.allowedElements)!==void 0){const t=e==null?void 0:e.allowedElements;if(!N(t))throw new ve(ce.InvalidAllowedElements,"Allowed Elements is invalid.",{context:{configType:V.MultiElementModifier}});Object.entries(t).forEach(([n])=>{var r,i;if(!N(t[n]))throw new ve(ce.InvalidAllowedElementKey,"Allowed Elements key is invalid.",{context:{configType:V.MultiElementModifier,key:n}});if(((r=t[n])==null?void 0:r.allowedProperties)!==void 0&&!F((i=t[n])==null?void 0:i.allowedProperties,!0))throw new ve(ce.InvalidAllowedProperties,"Allowed Elements allowed properties is invalid.",{context:{configType:V.MultiElementModifier,key:n}})})}}function lh(e){if(!N(e))throw new ve(ce.InvalidConfig,"Config is invalid.",{context:{configType:V.WhenElementClick}});if((e==null?void 0:e.allowedElements)!==void 0){const t=e==null?void 0:e.allowedElements;if(!N(t))throw new ve(ce.InvalidAllowedElements,"Allowed Elements is invalid.",{context:{configType:V.WhenElementClick}});Object.entries(t).forEach(([n])=>{if(!N(t[n]))throw new ve(ce.InvalidAllowedElementKey,"Allowed Elements key is invalid.",{context:{configType:V.WhenElementClick,key:n}})})}}function Qa(e){if(!N(e))throw new dt(Qe.WpmConfigIsRequired,"Wpm Config is required.");if(!N(e.configOptions))throw new ve(ce.InvalidConfigOptions,"Config Options are required.");V.SingleElementHtmlTransformer in e.configOptions?ah(e.configOptions[V.SingleElementHtmlTransformer]):y.log.info("WPM Config does not contain any restrictions for SingleElementHtmlTransformer"),V.MultiElementModifier in e.configOptions?sh(e.configOptions[V.MultiElementModifier]):y.log.info("WPM Config does not contain any restrictions for MultiElementModifier"),V.WhenElementClick in e.configOptions?lh(e.configOptions[V.WhenElementClick]):y.log.info("WPM Config does not contain any restrictions for WhenElementClick")}function Ja(e,t){if(!N(e))throw new dt(Qe.ConfigIsRequired,"Config is required.");if(!F(t))throw new dt(Qe.TransformersAreRequired,"Transformers are required.");const n=t.filter(r=>r.transformerType===Ce.HtmlElementModifier).map(r=>r.name);return n.length>0&&e.transformationConfig.transformations.length>0&&(e.transformationConfig.method===void 0||e.transformationConfig.method===q.ReplaceElementContent)&&e.transformationConfig.transformations.every(r=>n.includes(r.transformerName))?V.MultiElementModifier:V.SingleElementHtmlTransformer}function es(e,t,n){if(e===void 0)return;const r=t.filter(i=>Ke(i)).map(i=>i.tag).filter(i=>!Object.keys(e).includes(i.toLowerCase()));if(r.length>0)throw new Ae(Te.TagsNotAllowed,"Tags are not allowed.",{context:{configType:n,disallowedTags:JSON.stringify(r)}})}function uh(e,t,n){e!==void 0&&t.filter(r=>Ke(r)).map(r=>r).forEach(r=>{const i=e[r.tag.toLowerCase()].allowedProperties;i!==void 0&&(r.substitutionValues!==void 0?Object.keys(r.substitutionValues):[]).forEach(o=>{if(!i.includes(o))throw new Ae(Te.PropertyNotAllowed,"Property is not allowed.",{context:{configType:n,property:`${r.tag}.${o}`}})})})}function ch(e,t,n){if(e!==void 0&&t.method!==void 0&&!e.includes(t.method))throw new Ae(Te.MethodNotAllowed,"Method is not allowed.",{context:{configType:n,method:t.method}})}function fh(e,t,n){if(e!==void 0)if(e.length===0){const r=t.map(i=>i.transformerName);throw new Ae(Te.TransformersAreDisabled,"Transformers are disabled.",{context:{configType:n,transformers:JSON.stringify(r)}})}else{const r=t.filter(i=>!e.includes(i.transformerName)).map(i=>i.transformerName);if(r.length>0)throw new Ae(Te.TransformersAreDisabled,"Transformers are disabled.",{context:{configType:n,transformers:JSON.stringify(r)}})}}function dh(e,t){t!==void 0&&(es(t.allowedElements,e.transformationConfig.transformations,"SingleElementHtmlTransformer"),ch(t.allowedTargetMethodTypes,e.transformationConfig,"SingleElementHtmlTransformer"),fh(t.allowedTransformers,e.transformationConfig.transformations,"SingleElementHtmlTransformer"))}function hh(e,t){t!==void 0&&(es(t.allowedElements,e.transformationConfig.transformations,"MultiElementModifier"),uh(t.allowedElements,e.transformationConfig.transformations,"MultiElementModifier"))}function ph(e,t){var n,r;if(t!==void 0&&t.allowedElements!==void 0){const i=(r=(n=e.transformationConfig.whenValues)==null?void 0:n.tag)!=null?r:"";if(!Object.keys(t.allowedElements).includes(i))throw new Ae(Te.TagsNotAllowed,"Tags are not allowed.",{context:{configType:V.WhenElementClick,disallowedTags:i}})}}function ts(e,t,n){if(!N(e))throw new dt(Qe.ConfigIsRequired,"Config is required.");if(!N(t))throw new dt(Qe.WpmConfigIsRequired,"Wpm Config is required.");if(!F(n))throw new dt(Qe.TransformersAreRequired,"Transformers are required.");if(e.sourceMatchers.length>1)throw new Ae(Te.OneSourceMatcherSupported,"Only one source matcher is allowed.");switch(Ja(e,n)){case V.SingleElementHtmlTransformer:if(e.transformationConfig.transformations.length>1)throw new Ae(Te.OneTransformerSupported,"Only one transformation is allowed.",{context:{configType:V.SingleElementHtmlTransformer}});if(e.transformationConfig.method===void 0)throw new Ae(Te.MethodIsRequired,"Method is required.",{context:{configType:V.SingleElementHtmlTransformer}});if(N(e.transformationConfig.transformations[0].substitutionValues,!1))throw new Ae(Te.SubstitutionValuesNotAllowed,"Substitution Values not allowed.",{context:{configType:V.SingleElementHtmlTransformer}});V.SingleElementHtmlTransformer in t.configOptions&&dh(e,t.configOptions[V.SingleElementHtmlTransformer]);break;case V.MultiElementModifier:if(e.transformationConfig.transformations.some(r=>Je(r)))throw new Ae(Te.OnlyElementsSupported,"Can only target elements.",{context:{configType:V.MultiElementModifier}});V.MultiElementModifier in t.configOptions&&hh(e,t.configOptions[V.MultiElementModifier]);break}V.WhenElementClick in t.configOptions&&e.transformationConfig.when===Oe.ElementClick&&ph(e,t.configOptions[V.WhenElementClick])}function gh(e,t,n){try{return ts(e,t,n),!0}catch(r){return!1}}function ns(e){function t(n){if(Ye()){if(!N(n,!1)){y.log.error("A config is required when setting WPM Config.");return}try{Qa(n),eh(n),y.log.info("Set WPMConfig to the following: ",n)}catch(r){y.log.error(`WPMConfig could not be set due to: ${Q(r).message}`,r)}}else y.log.error("WPMConfig can only be set before SalesforceInteractions.init is called.")}if(w(e))try{const n=JSON.parse(e);t(n)}catch(n){y.log.error("JSON WPM Config list could not be initialized due to: ",n)}else t(e)}function mh(e){const t=Qn();if(w(t)){const n=new URL(e),r=new URL(t);return n.hostname===r.hostname}return!0}var rs=(e=>(e.Cart="cart",e.CartItem="cartItem",e.Catalog="catalog",e.Consent="consentLog",e.Order="order",e.OrderItem="orderItem",e))(rs||{}),is=(e=>(e.Engagement="Engagement",e.Profile="Profile",e))(is||{}),di=(e=>(e.Category="category",e.DateTime="dateTime",e.DeviceId="deviceId",e.EventId="eventId",e.EventType="eventType",e.SessionId="sessionId",e))(di||{}),os=(e=>(e.OnBeforeEventSend="dataCloud:onBeforeEventSend",e))(os||{}),st=(e=>(e.Id="personalizationId",e.ContentId="personalizationContentId",e))(st||{});function vh(){document.addEventListener(os.OnBeforeEventSend,e=>{const t=e.detail.actionEvent;if(!Eh(t))return;const n=t.personalization;if(N(n)){if((n==null?void 0:n.isTesting)===!0)as(e,ss,"Cancelling event since we are in test mode and all events are engagement events","Not sending engagement event since we are in test mode");else if((w(n.id)||w(n.contentId))&&!as(e,_h,"Cancelling event since Personalization fields are already present in events with different values","Not sending event since Personalization fields are already present in event with different values")){const r=e.detail.events;yh(n,r)}}})}function Eh(e){return"personalization"in e}function as(e,t,n,r){let i=e.detail.events;const o=t(i,e.detail.actionEvent.personalization);if(o.length>0){if(o.length===i.length)return O.log.warn(n,JSON.stringify(i)),e.detail.events=[],e.preventDefault(),!0;o.forEach(s=>O.log.warn(r,JSON.stringify(s))),i=i.filter(s=>!o.includes(s)),e.detail.events=i}return!1}function ss(e,t){return e.filter(n=>n[di.Category]===is.Engagement.toString()&&n[di.EventType]!==rs.Consent)}function _h(e,t){return e.filter(n=>ae(n,st.Id)&&n[st.Id]!==t.id||ae(n,st.ContentId)&&n[st.ContentId]!==t.contentId)}function yh(e,t){ss(t).forEach(n=>{w(e.id)&&(n[st.Id]=e.id),w(e.contentId)&&(n[st.ContentId]=e.contentId)})}function Th(){document.addEventListener(O.CustomEvents.OnInit,()=>{const e=xe();if(e===void 0||e.attributes===void 0){O.log.warn("Engagement Configuration does not have any Config for Attributes");return}const t=e.attributes.engagements;Object.keys(t).forEach(n=>{t[n].qualify()})}),document.addEventListener(O.CustomEvents.OnShutDown,()=>{Du()})}const Sh={redisplayTimeoutMilliseconds:2e3,renderPersonalizationAfterTimeoutElapsed:!1};var wh=Object.defineProperty,ls=Object.getOwnPropertySymbols,bh=Object.prototype.hasOwnProperty,Ih=Object.prototype.propertyIsEnumerable,us=(e,t,n)=>t in e?wh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cs=(e,t)=>{for(var n in t||(t={}))bh.call(t,n)&&us(e,n,t[n]);if(ls)for(var n of ls(t))Ih.call(t,n)&&us(e,n,t[n]);return e},hi=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});let bt=Sh,pi=!1;const Ah="head > style.personalizationFlickerDefense",lt={PageUrlMatcher:[],PageType:[]};function fs(){return bt!=null?bt:{}}function Ch(e){bt=cs(cs({},bt),e)}function Oh(e){if(!N(e))throw new Zn("flicker defense config is required");if(ae(e,"redisplayTimeoutMilliseconds")&&(!Dt(e.redisplayTimeoutMilliseconds)||e.redisplayTimeoutMilliseconds<0))throw new Zn("redisplayTimeoutMilliseconds must be a number greater than or equal to 0");if(ae(e,"renderPersonalizationAfterTimeoutElapsed")&&!an(e.renderPersonalizationAfterTimeoutElapsed))throw new Zn("renderPersonalizationAfterTimeoutElapsed must be a boolean")}function Ph(){return pi}function Nh(e){try{return document.querySelector(e),!0}catch(t){return O.log.warn(`Invalid path ${e} detected while trying to prevent flicker.`),!1}}function Dh(){const e=Mh();return Object.values(lt).flat().map(t=>{var n;if(Je(t)){const r=(n=e.find(i=>t.name===i.name))==null?void 0:n.selector;if(w(r))return r}else if(Ke(t))return t.path;return""}).filter(Nh).join(",")}function Mh(){const{pageTypes:e,global:t,pageTypeDefault:n}=O.getSitemapConfig();return[...e,...N(t)?[t]:[],...N(n)?[n]:[]].flatMap(r=>Ca(r,!1))}function Lh(){return hi(this,null,function*(){return[...yield $a()]})}function Rh(){return hi(this,null,function*(){return[...yield Ga()]})}function xh(e){return e.transformationConfig.transformations.filter(Ke).length>0}function kh(e){const t=e.transformationConfig.method;return t===q.ReplaceContentZoneContent||t===q.ReplaceElementContent||R(t)&&xh(e)}function ds(e){return e.filter(kh).flatMap(t=>t.transformationConfig.transformations)}function Uh(){const e=O.cashDom("<style></style>"),t=fn();return w(t)&&e.attr("nonce",t),e.attr({type:"text/css",class:"personalizationFlickerDefense"}).appendTo(document.head)}function gi(){const e=()=>{let t=O.cashDom(Ah);t.length===0&&(t=Uh());const n=Dh();w(n)?(O.log.debug(`flicker defense style tag updated to ${n}`),t.text(`${n} { visibility: hidden !important; }`)):(O.log.debug("flicker defense style tag removed"),t.remove())};window.requestAnimationFrame(e)}function mi(e,t){const n=Pd(e,t);lt[e]=ds(n),O.log.debug(`flicker defense currently hiding the following transformations for source matcher type ${e}: ${JSON.stringify(Object.values(lt[e]))}`),gi()}function Fh(){return hi(this,null,function*(){yield new Promise(e=>{pi=!1,setTimeout(()=>{O.log.debug(`flicker defense redisplay timeout of ${bt.redisplayTimeoutMilliseconds}ms elapsed`),pi=!0,zh(),e()},bt.redisplayTimeoutMilliseconds)})})}function zh(){lt.PageUrlMatcher=[],lt.PageType=[],gi()}function vi(e){const t=ds(e);for(const n of t)xn(n)}function xn(e){for(const t of Object.values(ye))lt[t]=lt[t].filter(n=>(n===e&&O.log.debug(`flicker defense reshowing hidden transformation with source matcher type of ${t}: ${JSON.stringify(e)}`),n!==e));gi()}function Vh(){document.addEventListener(O.CustomEvents.OnInitSitemap,()=>{const e=Ie();for(const n of Object.values(ye))mi(n,e);const t=Fh();Promise.race([Rh(),t]).then(n=>{n=n!=null?n:[],mi(ye.PageUrlMatcher,n)}).catch(n=>{O.log.error("Unexpected error updating paths for flicker defense while evaluating Personalization Experience Config URL matches.",n)}),Promise.race([Lh(),t]).then(n=>{n=n!=null?n:[],mi(ye.PageType,n)}).catch(n=>{O.log.error("Unexpected error updating paths for flicker defense while evaluating Personalization Experience Config page type matches.",n)})})}function hs(e){if(Ye()){if(!N(e,!1)){O.log.error("A config is required when setting Flicker Defense Config.");return}try{Oh(e),Ch(e),O.log.info("Set Flicker Defense Config to the following: ",e)}catch(t){O.log.error(`Flicker Defense Config could not be set due to: ${Q(t).message}`)}}else O.log.error("Flicker Defense Config can only be set before SalesforceInteractions.init is called.")}var De=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});function Hh(e){const t=Pn().find(r=>r.name===e.transformerName);if(t===void 0){y.log.error(`transformer with name ${e.transformerName} could not be found`);return}const n=_a(t.transformerType);if(n===void 0){y.log.error(`transformer ${t.transformerType} does not have an implementation`);return}return[n,t]}function Bh(e){return!gr(e.personalizationId)&&!fs().renderPersonalizationAfterTimeoutElapsed&&Ph()}function Gh(e,t,n){const r=e.pec.name,i=`PEC ${r}`,o=t.then(s=>{const l=s.personalizations.filter(p=>e.pec.dataProvider.value===p.personalizationPointName);if(F(l)){if(l.length>1){const p=`Received multiple responses for [${i}] when only one is expected. Using the first response.`;y.log.warn(p),e.status.update(new k(p))}}else{const p=new ue(_e.MissingPersonalization,`Did not receive a personalization response for ${i}`);throw y.log.warn(p.message),p}const a=l[0];if(!Io(a)){const p=new ue(_e.MissingPersonalizationDataAttributes,'Personalization invalid. Expected to include either "data" or "attributes".',{context:{configName:r,personalization:a}});throw y.log.warn(p.message),p}const u=a.personalizationId;e.status.update(new k(`Found response personalizationId ${u} ${i}`));const c=Xh(e.pec);if(!F(c)){const p=new ue(_e.MissingPersonalization,`Could not find any elements, ${i}, personalization ${u}`);throw y.log.warn(p.message),n||bo(u),p}return{personalizationId:u,transformResponses:c.map((p,f)=>{const h=i+`, transformer ${p.transformation.transformerName}, personalization ${u}, element index ${f}`,d=Hh(p.transformation);if(R(d)){const b=new Error(`Cannot transform, handler not found for ${h}`);return y.log.error(b.message),e.status.update(new k(b)),xn(p.transformation),null}const[g,v]=d;if(Bh(a)){y.log.warn(`Blocking transform and render of following transformation for config ${r} due to flicker defense: ${JSON.stringify(p.transformation)}`);const b=`Blocking transform and render due to flicker defense, ${h}`;return e.status.update(new k(b)),xn(p.transformation),null}const S=`Providing transformer with element promise etc, ${h}`;y.log.trace(S),e.status.update(new k(S));const _=g.transform(v,p.transformation,p.pageElementReady,a,e);return _.promise=_.promise.then(()=>{const b=`Finished transformation for ${h}`;y.log.trace(b),e.status.update(new k(b))}).catch(b=>{const m=new Error(`Issue handling transformation for ${h}`+Q(b).message);throw y.log.error(m.message),e.status.update(new k(m)),b}).finally(()=>xn(p.transformation)),_}).filter(p=>!R(p))}});e.status.update(new k(`Awaiting response and processing for ${i}`),o.then(s=>De(this,null,function*(){yield Promise.allSettled(s.transformResponses.map(l=>De(this,null,function*(){return yield l.promise}))).then(l=>{const a=l.filter(u=>u.status==="rejected").map(u=>Q(u.reason).message);if(a.length>0)throw new Error(`Issue(s) with transformation(s) for ${i}: ${JSON.stringify(a)}`)})}))),e.initiateRevert=()=>{const s=new Yn(o.then(l=>De(this,null,function*(){yield Promise.allSettled(l.transformResponses.map(a=>De(this,null,function*(){yield a.revert(s)}))).then(a=>{const u=a.filter(c=>c.status==="rejected").map(c=>Q(c.reason).message);if(u.length>0)throw new Error(`Issue(s) with revert (see 'statuses' for more detail): ${JSON.stringify(u)}`);s.update(new k("Revert (as applicable) finished")),n||bo(l.personalizationId)})}),l=>{if(l instanceof ue)s.update(new k("Nothing to revert, no transformation attempt"));else throw l}));return s}}function $h(e,t,n){if(!F(e)){y.log.warn("ignoring empty personalization experience configs");return}if(R(t)){const i="null/undefined personalization response promise";y.log.warn(`ignoring ${i}`);const o=new Error(i);ln.updateForAll(e,new k(o),Promise.reject(o)),vi(e.map(s=>s.pec));return}const r=t.then(i=>{if(!N(i)){const o=R(i)?new Error("null/undefined presonalization response"):new Error("unexpected personalization response type");throw y.log.error(o.message),vi(e.map(s=>s.pec)),o}return xi("DEBUG")&&y.log.debug(`handling personalization response: ${JSON.stringify(i)}`),i},i=>{y.log.error("error handling personalization response",i);const o=new Error("Personalization response promise rejection: "+Q(i).message);throw vi(e.map(s=>s.pec)),o});e.forEach(i=>{var o,s;const l=((s=(o=n==null?void 0:n[i.pec.dataProvider.value])==null?void 0:o.pecNames)!=null?s:[]).length>1;Gh(i,r,l)})}function Wh(e){var t;const n=e.name;return(t=Oa(n))!=null?t:""}function jh(e){return e.path}function ps(e,t){if(Je(e))return Wh(e);if(Ke(e))return jh(e);if(pt(t))return"body"}function gs(e){return De(this,null,function*(){return yield new Promise((t,n)=>{const r=qn("findElementOnPage:"+e);document.addEventListener(y.CustomEvents.OnShutDown,()=>{y.DisplayUtils.unbind(r),n(new Ve(Me.NotWaitingForElementPath,"No longer waiting for element at path.",{context:{path:e}}))}),y.DisplayUtils.bind(r).pageElementLoaded(e).then(i=>{t(i)}).catch(i=>{y.log.warn("error with DisplayUtils",i),n(i)})})})}function kn(e){const t=[];for(const n of e.transformations){const r=ps(n,e.method),i=r!==void 0?t.find(o=>ps(o.transformation,e.method)===r):void 0;i!==void 0?t.push({transformation:n,pageElementReady:i.pageElementReady}):r!==void 0?t.push({transformation:n,pageElementReady:gs(r)}):y.log.warn(`could not get the element path for transformerConfig: ${JSON.stringify(e)}`)}return t}function qh(e){return kn(e.transformationConfig)}function Yh(e){var t;const n=e.transformationConfig,r=$i(n.whenValues)&&(t=n.whenValues.percent)!=null?t:0,i=new Promise((s,l)=>{const a=qn("pageElementsReadyOnPageScroll:"+e.name);document.addEventListener(y.CustomEvents.OnShutDown,()=>{y.DisplayUtils.unbind(a),l(new Ve(Me.NotWaitingForPageScroll,"No longer waiting for page scroll.",{context:{config:e.name}}))});const u=window.scrollY/(document.documentElement.scrollHeight-window.innerHeight);try{u>=r?s():y.DisplayUtils.bind(a).pageScroll(r).then(s).catch(c=>{l(new Ve(Me.DisplayUtilsPageScrollError,"Error with DisplayUtils pageScroll method.",{cause:c}))})}catch(c){l(new Ve(Me.DisplayUtilsPageScrollError,"Error with DisplayUtils pageScroll method.",{cause:c}))}}),o=s=>De(this,null,function*(){const[l]=yield Promise.all([s,i]);return l});return kn(n).map(s=>(s.pageElementReady=o(s.pageElementReady),s))}function Kh(e){var t;const n=e.transformationConfig,r=Wi(n.whenValues)&&(t=n.whenValues.delay)!=null?t:0,i=new Promise((s,l)=>{const a=qn("pageElementsReadyOnExitIntent:"+e.name);document.addEventListener(y.CustomEvents.OnShutDown,()=>{y.DisplayUtils.unbind(a),l(new Ve(Me.NotWaitingForPageExit,"No longer waiting for page exit.",{context:{config:e.name}}))});try{y.DisplayUtils.bind(a).pageExit(r).then(s).catch(u=>{l(new Ve(Me.DisplayUtilsPageExitError,"Error with DisplayUtils pageExit method.",{cause:u}))})}catch(u){l(new Ve(Me.DisplayUtilsPageExitError,"Error with DisplayUtils pageExit method.",{cause:u}))}}),o=s=>De(this,null,function*(){const[l]=yield Promise.all([s,i]);return l});return kn(n).map(s=>(s.pageElementReady=o(s.pageElementReady),s))}function Zh(e){const t=e.transformationConfig,n=Gi(t.whenValues)?t.whenValues.path:"";if(!w(n))return[];function r(s){return De(this,null,function*(){return yield new Promise((l,a)=>{const u=()=>{y.log.debug(`Add Overlay Personalization Element '${s.id}' was clicked`),l(s)};document.addEventListener(y.CustomEvents.OnShutDown,()=>{s.removeEventListener("click",u),a(new Ve(Me.NotWaitingForElementClick,"No longer waiting for element click.",{context:{element:s.id}}))});try{s.addEventListener("click",u)}catch(c){a(new Ve(Me.AddingClickListenerError,"Error with adding click listener",{cause:c}))}})})}function i(){return De(this,null,function*(){yield gs(n).then(s=>De(this,null,function*(){return yield r(s)}))})}const o=s=>De(this,null,function*(){const[l]=yield Promise.all([s,i()]);return l});return kn(t).map(s=>(s.pageElementReady=o(s.pageElementReady),s))}function Xh(e){const t=e.transformationConfig.when;return t===Oe.Immediately?qh(e):t===Oe.ScrollPercent?Yh(e):t===Oe.ExitIntent?Kh(e):t===Oe.ElementClick?Zh(e):(y.log.warn(`whenType [${t}] not explicitly handled`),[])}var Un=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});function Qh(){document.addEventListener(y.CustomEvents.OnShutDown,ms),ms()}function ms(){Jh(),ep(),rp(),ip()}function Jh(){const e=ee.pageUrl.listener,t=ee.pageUrl.reject,n=ee.pageUrl={};R(e)||document.removeEventListener(y.CustomEvents.OnInitSitemap,e),R(t)||t(new Error("shutdown/reinit")),n.matchedPromise=new Promise((r,i)=>{n.reject=i,n.listener=()=>{const o=tp();n.matchedPECs=o,r(o)},document.addEventListener(y.CustomEvents.OnInitSitemap,n.listener)}),n.matchedPromise.catch(r=>{y.log.error(`Issue matching page URLs: ${Q(r).message}`,r)})}function ep(){const e=ee.pageType.listener,t=ee.pageType.reject,n=ee.pageType={};R(e)||document.removeEventListener(y.CustomEvents.OnSettledSitemap,e),R(t)||t(new Error("shutdown/reinit")),n.matchedPromise=new Promise((r,i)=>{n.reject=i,n.listener=o=>{const s=np(o.detail.result);n.matchedPECs=s,r(s)},document.addEventListener(y.CustomEvents.OnSettledSitemap,n.listener)}),n.matchedPromise.catch(r=>{y.log.error(`Issue matching page types: ${Q(r).message}`,r)})}function tp(){var e;const t=(e=window==null?void 0:window.location)==null?void 0:e.href;return y.log.debug(`current page url: ${t}`),La(t)}function np(e){var t,n;const r=(t=e==null?void 0:e.matchedConfig)==null?void 0:t.name,i=(n=window==null?void 0:window.location)==null?void 0:n.href;return y.log.debug(`sitemap result pageType: ${r} url: ${i}`),Ra(r)}function rp(){if(ee.pageUrl.processedPromise=void 0,R(ee.pageUrl.matchedPromise)){y.log.error("Unable to process page URL matches. Missing Promise.");return}ee.pageUrl.processedPromise=ee.pageUrl.matchedPromise.then(e=>Un(this,null,function*(){yield vs(e)})),ee.pageUrl.processedPromise.catch(e=>{y.log.error(`Issue processing page URL matches: ${Q(e).message}`,e)})}function ip(){if(ee.pageType.processedPromise=void 0,R(ee.pageUrl.matchedPromise)||R(ee.pageType.matchedPromise)){y.log.error("Unable to process page type matches. Missing Promise(s).");return}ee.pageType.processedPromise=Promise.all([ee.pageUrl.matchedPromise,ee.pageType.matchedPromise]).then(e=>Un(this,null,function*(){if(e.length!==2)throw new Error(`Unable to process page type matches. Expected results for 2 promises (url matches, page-type matches), but found: ${e==null?void 0:e.length}`);const t=[],n=[];e[1].forEach(r=>{e[0].some(i=>i.name===r.name)?n.push(r.name):t.push(r)}),n.length>0&&y.log.debug(`Avoiding processing, already url-matched: ${JSON.stringify(n)}`),yield vs(t)})),ee.pageType.processedPromise.catch(e=>{y.log.error(`Issue processing page type matches: ${Q(e).message}`,e)})}function op(e){if(!R(e)){if(!R(e.individualId)&&!w(e.individualId))throw new me(le.IndividualIdNotValid,"Individual Id must be a valid string if provided.",{context:{value:e.individualId}});if(R(e.endpoint)||Bi(e.endpoint),!R(e.perPersonalizationPoint)){if(!N(e.perPersonalizationPoint))throw new Rt(ft.PointOptionsNotValid,"perPersonalizationPoint must be an object if provided.",{context:{value:e.perPersonalizationPoint}});Object.entries(e.perPersonalizationPoint).forEach(([t,n])=>{if(!w(t))throw new Rt(ft.PointOptionKeyInvalid,"perPersonalizationPoint key must be a valid string.",{context:{value:t}});if(!N(n))throw new Rt(ft.PointOptionsNotValid,"PreviewPersonalizationPointOptions must be an object.",{context:{value:n}});if(!R(n.decisionId)&&!w(n.decisionId))throw new me(le.DecisionIdNotValid,"PreviewPersonalizationPointOptions decisionId must be a valid string if provided.",{context:{value:n.decisionId}})})}}}function ap(e,t){if(!F(e))throw new Rt(ft.MissingPersonalizationExperienceConfig,"Valid PersonalizationExperienceConfig(s) expected to Preview.");sp(e),y.log.debug(`Previewing personalization experience config(s): ${JSON.stringify(e.map(l=>l==null?void 0:l.name))}`),e.forEach(l=>{si(l),li(l)}),op(t);const n=Fa(e),r=e.map(l=>new ln(l));Object.values(n).forEach(l=>{var a,u;const c=(u=(a=t==null?void 0:t.perPersonalizationPoint)==null?void 0:a[l.point.name])==null?void 0:u.decisionId;w(c)&&(l.point.decisionId=c)});const i={individualId:t==null?void 0:t.individualId,dataspaceApiName:xt(),isPreview:!0,endpoint:t==null?void 0:t.endpoint};Es(r,n,i);const o=r.reduce((l,a)=>(l[a.pec.name]=a.status,l),{}),s=()=>{const l=r.reduce((a,u)=>(a[u.pec.name]=u.revert(),a),{});return new uu(l)};return new lu(o,s)}function sp(e){e.map(n=>n.name);const t=lp();if(t.length>0)throw new Rt(ft.DuplicatePersonalizationExperienceConfigs,"",{context:{value:t}})}function lp(e){const t=new Set,n=new Array;return t.forEach(r=>{const i=r.toLowerCase();t.has(i)?n.push(r):t.add(i)}),n}function up(e){const t=new Set,n=new Set;return e.forEach(r=>{r.isEnabled===void 0||r.isEnabled?t.add(r):n.add(r.name)}),y.log.debug(`skipping matched disabled personalization experience config names: ${JSON.stringify(n)}`),[...t]}function vs(e){return Un(this,null,function*(){e=up(e);const t=e.map(i=>i.name);if(y.log.debug(`matched enabled personalization experience config names: ${JSON.stringify(t)}`),e.length<=0)return;if(ci()){y.log.info(`WPM (client side editor) active, suppressing live/non-preview fetch for PECs: ${JSON.stringify(t)}`);return}const n=Fa(e),r=e.map(i=>new ln(i));Es(r,n,{dataspaceApiName:xt()}),yield Promise.allSettled(r.map(i=>Un(this,null,function*(){return yield i.status.finished}))).then(i=>{const o=i.filter(s=>s.status==="rejected").map(s=>Q(s.reason));if(o.length>0)throw new Error(`Issues processing matched PECs: ${JSON.stringify(t)} : ${JSON.stringify(o.map(s=>s.message))}`)})})}function Es(e,t,n){var r;const i=(r=n==null?void 0:n.dataspaceApiName)!=null?r:"";if(y.log.debug(`fetching for dataspace ["${i}]" points: ${JSON.stringify(t)}`),Object.keys(t).length<1){const a=JSON.stringify(e.map(c=>c.pec.name)),u=new Error(`No personalization points across PECs ${a} using dataspace [${i}]`);ln.updateForAll(e,new k(u),Promise.reject(u));return}const o={};w(n==null?void 0:n.dataspaceApiName)&&(o.dataspace=n.dataspaceApiName),w(n==null?void 0:n.individualId)&&(o.individualId=n.individualId);const s=So(Object.values(t).map(a=>a.point),o,n==null?void 0:n.isPreview),l=To(s,{endpoint:n==null?void 0:n.endpoint});$h(e,l,t)}function cp(e){if(!Ye()){y.log.error("The config can only be modified before SalesforceInteractions.init is called.");return}if(!N(e)){y.log.error("A config is required.");return}if(e.customEngagementConfig!==void 0&&Uo(e.customEngagementConfig),e.customWpmConfig!==void 0&&ns(e.customWpmConfig),e.customFlickerDefenseConfig!==void 0&&hs(e.customFlickerDefenseConfig),e.additionalTransformers!==void 0&&(ae(e.additionalTransformers,"list")&&F(e.additionalTransformers.list,!0)?Sa(e.additionalTransformers.list):F(e.additionalTransformers,!0)?Sa(e.additionalTransformers):y.log.error("A list of transformers is required when adding to Transformers.")),e.personalizationExperienceConfigs!==void 0)if(ae(e.personalizationExperienceConfigs,"list")&&F(e.personalizationExperienceConfigs.list,!0)){const t=Ha().DATA_CLOUD_MODULE_CONFIG;if(N(t)){y.log.error("Initializing personalization experience configs using this format can only be used once.");return}Wd(ai.DataCloudModuleConfig,e.personalizationExperienceConfigs),ui(e.personalizationExperienceConfigs.list,ai.DataCloudModuleConfig)}else F(e.personalizationExperienceConfigs,!0)?ui(e.personalizationExperienceConfigs):y.log.error("A list of personalization experience configs is required.")}var fp=(e,t,n)=>new Promise((r,i)=>{var o=a=>{try{l(n.next(a))}catch(u){i(u)}},s=a=>{try{l(n.throw(a))}catch(u){i(u)}},l=a=>a.done?r(a.value):Promise.resolve(a.value).then(o,s);l((n=n.apply(e,t)).next())});function dp(e,t){return fp(this,null,function*(){try{if(!F(e))throw new me(le.PersonalizationPointsIsNotAnArray,"The Personalization Points parameter must be an array of length >= 1.",{context:{value:e}});const n=e.map(i=>({name:i})),r=So(n,t);return yield To(r)}catch(n){return y.log.error(n),yield Promise.reject(n)}})}cl(),fl(),vh(),Th(),Qh(),fu(),Vd(),th(),Vh(),window.SalesforceInteractions.Personalization={fetch:dp,Config:{initialize:cp,PersonalizationExperience:{findByName:Od,getAll:Ie,addNew:zd,isSupported:li,validate:si,preview:ap},Transformer:{getAll:Pn,addNew:rd},Engagement:{initializeCustom:Uo,get:xe,validate:ko},Wpm:{initializeCustom:ns,get:Ya,validate:Qa},FlickerDefense:{initializeCustom:hs,get:fs}},launchWpm:oh}})(window.SalesforceInteractions);

        
      } catch (e) {
        console.error("[Salesforce personalization] Error initializing module: personalization", e);
      }
      })();

// SITEMAP AND INIT
try {
  (function () {
    SalesforceInteractions.init({
  cookieDomain: "babyfresh.co",
  consents: [
    {
      provider: "Example Provider",
      purpose: "Tracking",
      status: "Opt In",
    },
  ],
}).then(() => {
  console.log("DC version: 2");

  const sitemapConfig = {
    global: {
      onActionEvent: (actionEvent) => {
        console.log("DC event:", actionEvent);
        let emailAddress = sessionStorage.getItem("email");
        let name = sessionStorage.getItem("first_name");
        let lastname = sessionStorage.getItem("last_name")
        if(emailAddress) {
              actionEvent.user = actionEvent.user || {};
              actionEvent.user.attributes = actionEvent.user.attributes || {};
              actionEvent.user.attributes.email = emailAddress;
              actionEvent.user.attributes.nameLogin = name;
              actionEvent.user.attributes.lastnameLogin = lastname;
              actionEvent.user.attributes.eventType = 'contactPointEmail';
        }
        return actionEvent;
      },
      listeners: [        
      ],
    },
    pageTypeDefault: {
      name: "default",
    },
    pageTypes: [
      // Homepage
      {
        name: "bf_web_Homepage",
        isMatch: () => window.location.pathname === "/",

        interaction: {
          name: "bfWebVistaHomepage",
        },
      },
      //Search
      {
        name: "bf_search",
        isMatch: () => /\/search/.test(window.location.href),
        interaction: {
          name: "bfWebSearch",
        },
        onActionEvent: (actionEvent) => {
          if(actionEvent.interaction.name === "bfWebSearch"){
            console.log("DC - bfWebSearch");

            let searchProduct = document.querySelector("h1.hdt-collection-heading").innerText.split(": ")[1].replace(/["]/g, '')
               
            SalesforceInteractions.sendEvent({
                interaction: {
                    name: "bfWebViewSearch",
                    attributes: {
                      productSearched: searchProduct
                    },
                }
            });
          }
          return actionEvent;
        }
      }, 
      // Category Page
      {
        name: "Category",
        isMatch: () =>
          (window.location.href.includes("/pages/") ||
            window.location.href.includes("/collections/")) &&
          !window.location.href.includes("products"),
          interaction: {
            name: "bfViewCategoryPage",
          },
          onActionEvent: (actionEvent) => {
            if(actionEvent.interaction.name === "bfViewCategoryPage"){
              console.log("DC - entered to category global");

              let atrObj = {};

              // Conectores para eliminar
              const conectores = ["de","con","para","en","a","y","o","sin","por"];
              let urlPath = window.location.href.split("/")[4]?.split("?")[0] || "";
  
              let palabrasFiltradas = urlPath.split("-").filter((palabra) => !conectores.includes(palabra.toLowerCase()));
  
              let resultadoFinal = [];
              for (let i = 0; i < palabrasFiltradas.length; i++) {
                if (palabrasFiltradas[i] === "dona" && palabrasFiltradas[i + 1] === "tu" && palabrasFiltradas[i + 2] === "ropa") {
                    resultadoFinal.push("dona tu ropa");
                    i += 2; // Salta las siguientes dos palabras "tu" y "ropa"
                } else {
                    resultadoFinal.push(palabrasFiltradas[i]);
                }
              }            
              resultadoFinal.forEach((ele, i) => {
                atrObj[`category${i + 1}`] = ele;
              });
              console.log("Attributes:", atrObj);                 
              SalesforceInteractions.sendEvent({
                  interaction: {
                      name: "ViewCatalogObject",
                      catalogObject: {
                        type: "Category",
                        id: window.location.href.split("/")[4]?.split("?")[0].split("-").filter(word => word !== "para").join("|"),
                        attributes: {
                          category1: atrObj.category1 || "",
                          category2: atrObj.category2 || "",
                          category3: atrObj.category3 || ""
                        }
                      },
                  }
              });
            }
            return actionEvent;
          }
      },
      // Product Detail Page
      {
        name: "product_view",
        isMatch: () => window.location.href.includes("products"),
        interaction: {
          name: "bfWebViewProductDetail",
          catalogObject: {
            type: "Product",
            id: () => window.location.pathname.split("/")[2].trim(),
            attributes: {
              sku: {
                id: SalesforceInteractions.cashDom(".custom-sku").text().trim(),                
                name: SalesforceInteractions.cashDom(".hdt-product__title h1").text().trim(),
                description: [...document.querySelectorAll(".hdt-product-accordion__content li")].map(li => li.textContent.trim()).join(". "),
              },
              url: SalesforceInteractions.resolvers.fromHref(),      
              price: () => { 
                let priceText = SalesforceInteractions.cashDom(".hdt-money").text()
                if (priceText) {
                  let price = priceText.replace("$", "").trim();
                  price = price.split(".").join(""); 
                  let decimalIndex = price.indexOf(",");
                  if (decimalIndex !== -1) {
                    price = price.slice(0, decimalIndex);
                  }
                return parseInt(price, 10);
                }
              }, 
            },
            relatedCatalogObjects: {
              Category: () => {
                const path =  window.location.href.split("/")[2].split("-").filter(word => word !== "para").join("|");
                return [path];
              },
            },
          },
        },          
        listeners: [
          //Add to Cart
          SalesforceInteractions.listener("click", ".hdt-product-form__submit", () => {
            let item = {
              catalogObjectType: "cartItem",
              catalogObjectId: SalesforceInteractions.cashDom(".custom-sku").text().trim(),
              quantity: parseInt(document.querySelector('input.hdt-quantity__input').value.trim()),              
              attributes: { 
                idProd: SalesforceInteractions.cashDom(".hdt-product__title > span").text().trim(),                
                nameProd: SalesforceInteractions.cashDom("div.hdt-product-info__item.hdt-product__title > h1").text().trim(),
                size: document.querySelector('input[type="radio"][name="Talla"]:checked').value,                
              }
            }            
            SalesforceInteractions.sendEvent({
              interaction: {
                name: SalesforceInteractions.CartInteractionName.AddToCart,
                lineItem:  item
              },
            });
          }),        
        ],
      },
      //Cart
      {
        name: "cart",
        isMatch: () => window.location.href.includes("cart"),
        interaction: {
          name: SalesforceInteractions.CartInteractionName.ReplaceCart,
          lineItems: SalesforceInteractions.DisplayUtils.pageElementLoaded(
            ".hdt-main-cart__button-checkout",
            "html"
          ).then(() => {
            let cartLineItems = [];
            SalesforceInteractions.cashDom(".hdt-page-cart__item").each((index, ele) => {
              let name = SalesforceInteractions.cashDom(ele).find(".hdt-page-cart__title").text().trim();
              let size = SalesforceInteractions.cashDom(ele).find(".hdt-page-cart__meta-variant").text().trim();
              let itemQuantity = parseInt(SalesforceInteractions.cashDom(ele).find(".hdt-quantity-input").val())                               
              
              let lineItem = {
                catalogObjectType: "viewCart",
                catalogObjectId: SalesforceInteractions.cashDom(ele).find(".hdt-page-cart__title").attr("href").split("variant=")[1],                
                quantity: itemQuantity,
                attributes: {
                  nameProds: name,
                  sizeProds: size                 
                }

              };
              cartLineItems.push(lineItem);
            });
            return cartLineItems;
          }),

        },
      },            
    ],
  };

  const handleSPA = () => {
    let url = window.location.href;
    let timer = setInterval(() => {
      if (window.location.href !== url) {
        console.log("MCP page changed");
        url = window.location.href;
        SalesforceInteractions.reinit();
      }
    }, 1000);
  };

  SalesforceInteractions.initSitemap(sitemapConfig);
});
  })()
} catch (e) {
  console.error("[Salesforce Data Cloud] Error loading sitemap:", e);
}
